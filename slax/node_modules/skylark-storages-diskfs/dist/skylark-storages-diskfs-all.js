/**
 * skylark-storages-diskfs - The filer features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(r,n){var t=n.define,e=n.require,o="function"==typeof t&&t.amd,i=!o&&"undefined"!=typeof exports;if(!o&&!t){var a={};t=n.define=function(r,n,t){"function"==typeof t?(a[r]={factory:t,deps:n.map(function(n){return function(r,n){if("."!==r[0])return r;var t=n.split("/"),e=r.split("/");t.pop();for(var o=0;o<e.length;o++)"."!=e[o]&&(".."==e[o]?t.pop():t.push(e[o]));return t.join("/")}(n,r)}),resolved:!1,exports:null},e(r)):a[r]={factory:null,resolved:!0,exports:t}},e=n.require=function(r){if(!a.hasOwnProperty(r))throw new Error("Module "+r+" has not been defined");var t=a[r];if(!t.resolved){var o=[];t.deps.forEach(function(r){o.push(e(r))}),t.exports=t.factory.apply(n,o)||null,t.resolved=!0}return t.exports}}if(!t)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(r,n){r("skylark-langx-ns/_attach",[],function(){return function(r,n,t){"string"==typeof n&&(n=n.split("."));for(var e=n.length,o=r,i=0,a=n[i++];i<e;)o=o[a]=o[a]||{},a=n[i++];return o[a]=t}}),r("skylark-langx-ns/ns",["./_attach"],function(r){var n={attach:function(t,e){return r(n,t,e)}};return n}),r("skylark-langx-ns/main",["./ns"],function(r){return r}),r("skylark-langx-ns",["skylark-langx-ns/main"],function(r){return r}),r("skylark-langx/skylark",["skylark-langx-ns"],function(r){return r}),r("skylark-storages-diskfs/diskfs",["skylark-langx/skylark"],function(r){var n=function(){return n};return r.attach("storages.diskfs",n)}),r("skylark-storages-diskfs/download",["./diskfs"],function(r){return r.downlad=function(r,n){if(window.navigator.msSaveBlob)types.isString(r)&&(r=dataURItoBlob(r)),window.navigator.msSaveBlob(r,n);else{var t=document.createElement("a");r instanceof Blob&&(r=URL.createObjectURL(r)),t.href=r,t.setAttribute("download",n||"noname"),t.dispatchEvent(new CustomEvent("click"))}}}),r("skylark-langx-types/types",["skylark-langx-ns"],function(r){var n,t={}.toString,e=(n={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(r){n["[object "+r+"]"]=r.toLowerCase()}),function(r){return null==r?String(r):n[t.call(r)]||"object"});function o(r){var n;for(n in r)if(null!==r[n])return!1;return!0}function i(r){return"function"==e(r)}function a(r){return r&&r.nodeType}function u(r){return"number"==typeof r}function s(r){return"object"==e(r)}function l(r){return"string"==typeof r}function c(r){return r&&r==r.window}return r.attach("langx.types",{isArray:function(r){return r&&r.constructor===Array},isArrayLike:function(r){return!l(r)&&!a(r)&&"number"==typeof r.length&&!i(r)},isBoolean:function(r){return"boolean"==typeof r},isDefined:function(r){return void 0!==r},isDocument:function(r){return null!=r&&r.nodeType==r.DOCUMENT_NODE},isEmpty:o,isEmptyObject:o,isFunction:i,isHtmlNode:a,isNull:function(r){return"null"===e(r)},isNumber:u,isNumeric:u,isObject:s,isPlainObject:function(r){return s(r)&&!c(r)&&Object.getPrototypeOf(r)==Object.prototype},isString:l,isSameOrigin:function(r){if(r){var n=location.protocol+"//"+location.hostname;return location.port&&(n+=":"+location.port),r.startsWith(n)}},isSymbol:function(r){return"symbol"==typeof r||isObjectLike(r)&&objectToString.call(r)==symbolTag},isUndefined:function(r){return void 0===r},isWindow:c,type:e})}),r("skylark-langx-types/main",["./types"],function(r){return r}),r("skylark-langx-types",["skylark-langx-types/main"],function(r){return r}),r("skylark-langx-numbers/numbers",["skylark-langx-ns","skylark-langx-types"],function(r,n){var t=n.isObject,e=n.isSymbol,o=1/0,i=1.7976931348623157e308,a=NaN,u=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;function p(r){if(!r)return 0===r?r:0;if((r=y(r))===o||r===-o){var n=r<0?-1:1;return n*i}return r==r?r:0}function y(r){if("number"==typeof r)return r;if(e(r))return a;if(t(r)){var n="function"==typeof r.valueOf?r.valueOf():r;r=t(n)?n+"":n}if("string"!=typeof r)return 0===r?r:+r;r=r.replace(u,"");var o=l.test(r);return o||c.test(r)?f(r.slice(2),o?2:8):s.test(r)?a:+r}return r.attach("langx.numbers",{toFinite:p,toNumber:y,toInteger:function(r){var n=p(r),t=n%1;return n==n?t?n-t:n:0}})}),r("skylark-langx-numbers/main",["./numbers"],function(r){return r}),r("skylark-langx-numbers",["skylark-langx-numbers/main"],function(r){return r}),r("skylark-langx-objects/objects",["skylark-langx-ns/ns","skylark-langx-ns/_attach","skylark-langx-types","skylark-langx-numbers"],function(r,n,t,e){var o,i,a=Object.prototype.hasOwnProperty,u=Array.prototype.slice,s=t.isBoolean,l=t.isFunction,c=t.isObject,f=t.isPlainObject,p=t.isArray,y=t.isArrayLike,h=t.isString,k=e.toInteger;var v,g,d="undefined"!=typeof Symbol?Symbol.prototype:null;function m(r){if(!c(r))return[];var n=[];for(var t in r)n.push(t);return n}function b(r,n){if(!p(n))return null!=r&&a.call(r,n);for(var t=n.length,e=0;e<t;e++){var o=n[e];if(null==r||!a.call(r,o))return!1;r=r[o]}return!!t}function x(r,n,t,e){for(var o in n)e&&void 0!==r[o]||(t&&(f(n[o])||p(n[o]))?(f(n[o])&&!f(r[o])&&(r[o]={}),p(n[o])&&!p(r[o])&&(r[o]=[]),x(r[o],n[o],t,e)):void 0!==n[o]&&(r[o]=n[o]));return r}function j(r){var n=u.call(arguments,0),t=n.shift(),e=!1;return s(n[n.length-1])&&(e=n.pop()),{target:t,sources:n,deep:e}}function _(){var r=j.apply(this,arguments);return r.sources.forEach(function(n){x(r.target,n,r.deep,!1)}),r.target}function w(r){for(var n=m(r),t=n.length,e=Array(t),o=0;o<t;o++)e[o]=r[n[o]];return e}return o=function(r,n,t,e){if(r===n)return 0!==r||1/r==1/n;if(null==r||null==n)return!1;if(r!=r)return n!=n;var o=typeof r;return("function"===o||"object"===o||"object"==typeof n)&&i(r,n,t,e)},i=function(r,n,t,e){var i=toString.call(r);if(i!==toString.call(n))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+r==""+n;case"[object Number]":return+r!=+r?+n!=+n:0==+r?1/+r==1/n:+r==+n;case"[object Date]":case"[object Boolean]":return+r==+n;case"[object Symbol]":return d.valueOf.call(r)===d.valueOf.call(n)}var a="[object Array]"===i;if(!a){if("object"!=typeof r||"object"!=typeof n)return!1;var u=r.constructor,s=n.constructor;if(u!==s&&!(l(u)&&u instanceof u&&l(s)&&s instanceof s)&&"constructor"in r&&"constructor"in n)return!1}t=t||[],e=e||[];for(var c=t.length;c--;)if(t[c]===r)return e[c]===n;if(t.push(r),e.push(n),a){if((c=r.length)!==n.length)return!1;for(;c--;)if(!o(r[c],n[c],t,e))return!1}else{var f,p=Object.keys(r);if(c=p.length,Object.keys(n).length!==c)return!1;for(;c--;)if(f=p[c],void 0===n[f]||!o(r[f],n[f],t,e))return!1}return t.pop(),e.pop(),!0},r.attach("langx.objects",{allKeys:m,attach:n,clone:function r(n,t){var e;if(void 0===n||null===n)e=n;else if(t&&n.clone)e=n.clone();else if(p(n)){e=[];for(var o=0;o<n.length;o++)e.push(r(n[o]))}else if(f(n))for(var i in e={},n)e[i]=r(n[i]);else e=n;return e},defaults:(v=m,g=!0,function(r){var n=arguments.length;if(g&&(r=Object(r)),n<2||null==r)return r;for(var t=1;t<n;t++)for(var e=arguments[t],o=v(e),i=o.length,a=0;a<i;a++){var u=o[a];g&&void 0!==r[u]||(r[u]=e[u])}return r}),each:function(r,n){var t,e,o,i;if(r)if(void 0===(t=r.length)){for(e in r)if(r.hasOwnProperty(e)&&(i=r[e],!1===n.call(i,e,i)))break}else for(o=0;o<t&&(i=r[o],!1!==n.call(i,o,i));o++);return this},extend:function(r){var n,t=u.call(arguments,1);"boolean"==typeof r&&(n=r,r=t.shift());0==t.length&&(t=[r],r=this);return t.forEach(function(t){_(r,t,n)}),r},has:b,isEqual:function(r,n){return o(r,n)},includes:function(r,n,t,e){r=y(r)?r:w(r),t=t&&!e?k(t):0;var o=r.length;t<0&&(t=nativeMax(o+t,0));return h(r)?t<=o&&r.indexOf(n,t)>-1:!!o&&baseIndexOf(r,n,t)>-1},isMatch:function(r,n){var t=t(n),e=t.length;if(null==r)return!e;for(var o=Object(r),i=0;i<e;i++){var a=t[i];if(n[a]!==o[a]||!(a in o))return!1}return!0},keys:function(r){if(c(r))return[];var n=[];for(var t in r)b(r,t)&&n.push(t);return n},mixin:_,omit:function(r,n,t){if(!r)return null;for(var e=_({},r),o=1;o<arguments.length;o++){var i=arguments[o];i in r&&delete e[i]}return e},pick:function(r,n,t){if(!r)return null;for(var e={},o=1;o<arguments.length;o++){var i=arguments[o];i in r&&(e[i]=r[i])}return e},removeItem:function(r,n){if(p(r)){var t=r.indexOf(n);-1!=t&&r.splice(t,1)}else if(f(r))for(var e in r)if(r[e]==n){delete r[e];break}return this},result:function(r,n,t){p(n)||(n=n.split("."));var e=n.length;if(!e)return l(t)?t.call(r):t;for(var o=0;o<e;o++){var i=null==r?void 0:r[n[o]];void 0===i&&(i=t,o=e),r=l(i)?i.call(r):i}return r},safeMixin:function(){var r=j.apply(this,arguments);return r.sources.forEach(function(n){x(r.target,n,r.deep,!0)}),r.target},values:w})}),r("skylark-langx-objects/main",["./objects"],function(r){return r}),r("skylark-langx-objects",["skylark-langx-objects/main"],function(r){return r}),r("skylark-langx-arrays/arrays",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(r,n,t){var e=Array.prototype.filter,o=n.isArrayLike;function i(r,n,t,e){for(var o=r.length,i=t+(e?1:-1);e?i--:++i<o;)if(n(r[i],i,r))return i;return-1}function a(r){return r!=r}function u(r){if(o(r)){for(var n=[],t=0;t<r.length;t++){var e=r[t];if(o(e))for(var i=0;i<e.length;i++)n.push(e[i]);else n.push(e)}return n}return r}return r.attach("langx.arrays",{baseFindIndex:i,baseIndexOf:function(r,n,t){if(n!=n)return i(r,a,t);var e=t-1,o=r.length;for(;++e<o;)if(r[e]===n)return e;return-1},compact:function(r){return e.call(r,function(r){return null!=r})},first:function(r,n){return n?r.slice(0,n):r[0]},filter:function(r,n){return e.call(r,n)},flatten:u,grep:function(r,n){var e=[];return t.each(r,function(r,t){n(t,r)&&e.push(t)}),e},inArray:function(r,n){if(!n)return-1;var t;if(n.indexOf)return n.indexOf(r);t=n.length;for(;t--;)if(n[t]===r)return t;return-1},makeArray:function(r,n,t){if(o(r))return(t||[]).concat(Array.prototype.slice.call(r,n||0));return[r]},merge:function(r,n){var t=n.length,e=r.length,o=0;if("number"==typeof t)for(;o<t;o++)r[e++]=n[o];else for(;void 0!==n[o];)r[e++]=n[o++];return r.length=e,r},forEach:function(r,n){if(r.forEach)return r.forEach(n);for(var t=0;t<r.length;t++)n(r[t],t)},map:function(r,n){var t,e,i,a=[];if(o(r))for(e=0;e<r.length;e++)null!=(t=n.call(r[e],r[e],e))&&a.push(t);else for(i in r)null!=(t=n.call(r[i],r[i],i))&&a.push(t);return u(a)},reduce:function(r,n,t){return Array.prototype.reduce.call(r,n,t)},uniq:function(r){return e.call(r,function(n,t){return r.indexOf(n)==t})}})}),r("skylark-langx-arrays/main",["./arrays"],function(r){return r}),r("skylark-langx-arrays",["skylark-langx-arrays/main"],function(r){return r}),r("skylark-langx-funcs/funcs",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(r,n,t){var e=t.mixin,o=Array.prototype.slice,i=n.isFunction,a=n.isString;var u=function(){function r(){}return function(n,t){r.prototype=n;var o=new r;return r.prototype=null,t&&e(o,t),o}}(),s={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};return r.attach("langx.funcs",{debounce:function(r,n){var t;return function(){var e=this,o=arguments;t&&clearTimeout(t),t=setTimeout(function(){t=null,r.apply(e,o)},n)}},delegate:u,defer:function(r){requestAnimationFrame?requestAnimationFrame(r):setTimeoutout(r);return this},noop:function(){},proxy:function r(n,t){var e=2 in arguments&&o.call(arguments,2);if(i(n)){return function(){return n.apply(t,e?e.concat(o.call(arguments)):arguments)}}if(a(t))return e?(e.unshift(n[t],n),r.apply(null,e)):r(n[t],n);throw new TypeError("expected function")},returnTrue:function(){return!0},returnFalse:function(){return!1},templateSettings:s,template:function(r,n,e){!n&&e&&(n=e);n=t.defaults({},n,s);var o,i=RegExp([(n.escape||noMatch).source,(n.interpolate||noMatch).source,(n.evaluate||noMatch).source].join("|")+"|$","g"),a=0,u="__p+='";r.replace(i,function(n,t,e,o,i){return u+=r.slice(a,i).replace(escapeRegExp,escapeChar),a=i+n.length,t?u+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?u+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(u+="';\n"+o+"\n__p+='"),n}),u+="';\n",n.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{o=new Function(n.variable||"obj","_",u)}catch(r){throw r.source=u,r}var l=function(r){return o.call(this,r,_)},c=n.variable||"obj";return l.source="function("+c+"){\n"+u+"}",l}})}),r("skylark-langx-funcs/main",["./funcs"],function(r){return r}),r("skylark-langx-funcs",["skylark-langx-funcs/main"],function(r){return r}),r("skylark-langx-async/Deferred",["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(r,n,t){"use strict";var e=Symbol?Symbol():"__pglisteners",o=Symbol?Symbol():"__pgnotifies",i=Array.prototype.slice,a=n.proxy,u=r.makeArray,s=t.result,l=t.mixin;l(Promise.prototype,{always:function(r){return this.then(r,r),this},done:function(){for(var r=0;r<arguments.length;r++)this.then(arguments[r]);return this},fail:function(r){return this.catch(r),this}});var c=function(){var r=this,n=this.promise=new Promise(function(n,t){r._resolve=n,r._reject=t});f(n,r),this[e]=[],this[o]=[]};function f(r,n){var t={state:function(){return n.isResolved()?"resolved":n.isRejected()?"rejected":"pending"},then:function(r,n,t){return t&&this.progress(t),f(Promise.prototype.then.call(this,r&&function(n){return n&&void 0!==n.__ctx__?r.apply(n.__ctx__,n):r(n)},n&&function(r){return r&&void 0!==r.__ctx__?n.apply(r.__ctx__,r):n(r)}))},progress:function(r){return n[o].forEach(function(n){r(n)}),n[e].push(r),this}};return t.pipe=t.then,l(r,t)}return c.prototype.resolve=function(r){var n=i.call(arguments);return this.resolveWith(null,n)},c.prototype.resolveWith=function(r,n){return(n=n?u(n):[]).__ctx__=r,this._resolve(n),this._resolved=!0,this},c.prototype.notify=function(r){try{return this[o].push(r),this[e].forEach(function(n){return n(r)})}catch(r){this.reject(r)}return this},c.prototype.reject=function(r){var n=i.call(arguments);return this.rejectWith(null,n)},c.prototype.rejectWith=function(r,n){return(n=n?u(n):[]).__ctx__=r,this._reject(n),this._rejected=!0,this},c.prototype.isResolved=function(){return!!this._resolved},c.prototype.isRejected=function(){return!!this._rejected},c.prototype.then=function(r,n,t){var e=s(this,"promise");return e.then(r,n,t)},c.prototype.progress=function(r){var n=s(this,"promise");return n.progress(r)},c.prototype.catch=function(r){var n=s(this,"promise");return n.catch(r)},c.prototype.done=function(){var r=s(this,"promise");return r.done.apply(r,arguments)},c.prototype.fail=function(r){var n=s(this,"promise");return n.fail(r)},c.all=function(r){var n=new c;return Promise.all(r).then(n.resolve.bind(n),n.reject.bind(n)),s(n,"promise")},c.first=function(r){return f(Promise.race(r))},c.when=function(r,n,t,e){var o=r&&"function"==typeof r.then,i=o&&r instanceof Promise;if(!o)return arguments.length>1?n?n(r):r:(new c).resolve(r);if(!i){var u=new c(r.cancel);r.then(a(u.resolve,u),a(u.reject,u),u.notify),r=u.promise}return n||t||e?r.then(n,t,e):r},c.reject=function(r){var n=new c;return n.reject(r),n.promise},c.immediate=c.resolve=function(r){var n=new c;return n.resolve.apply(n,arguments),n.promise},c}),r("skylark-langx/Deferred",["skylark-langx-async/Deferred"],function(r){return r}),r("skylark-storages-diskfs/read",["skylark-langx/Deferred","./diskfs"],function(r,n){return n.read=n.readFile=function(n,t){t=t||{};var e=new r,o=new FileReader;o.onload=function(r){e.resolve(r.target.result)},o.onerror=function(r){var n=r.target.error.code;2===n?alert("please don't open this page using protocol fill:///"):alert("error code: "+n)},t.asArrayBuffer?o.readAsArrayBuffer(n):t.asDataUrl?o.readAsDataURL(n):t.asText?o.readAsText(n):o.readAsArrayBuffer(n);return e.promise}}),r("skylark-storages-diskfs/select",["./diskfs"],function(r){var n,t=1/0;return r.select=function(r){var e=(r=r||{}).directory||!1,o=r.multiple||!1,i=r.picked;if(!n){var a=n=document.createElement("input");function u(r){for(var n=r.length;n--;)r[n].size>t&&r.splice(n,1);i(r)}a.type="file",a.style.position="fixed",a.style.left=0,a.style.top=0,a.style.opacity=.001,document.body.appendChild(a),a.onchange=function(r){var n=r.target.webkitEntries||r.target.entries;n&&n.length?webentry.all(n).then(function(r){u(r)}):u(Array.prototype.slice.call(r.target.files)),a.value=""}}n.multiple=o,n.webkitdirectory=e,n.click()}}),r("skylark-langx/arrays",["skylark-langx-arrays"],function(r){return r}),r("skylark-storages-diskfs/webentry",["skylark-langx/arrays","skylark-langx/Deferred","./diskfs"],function(r,n,t){var e=Array.prototype.concat,o=function(){function t(r,t){var e=new n,i=function(r){e.reject(r)};if(t=t||"",r.isFile)r.file(function(r){r.relativePath=t,e.resolve(r)},i);else if(r.isDirectory){var a=r.createReader();a.readEntries(function(n){o(n,t+r.name+"/").then(function(r){e.resolve(r)}).catch(i)},i)}else e.resolve([]);return e.promise}function o(o,i){return n.all(r.map(o,function(r){return t(r,i)})).then(function(){return e.apply([],arguments)})}return{one:t,all:o}}();return t.webentry=o}),r("skylark-storages-diskfs/main",["./diskfs","./download","./read","./select","./webentry"],function(r){return r}),r("skylark-storages-diskfs",["skylark-storages-diskfs/main"],function(r){return r})}(t),!o){var u=e("skylark-langx/skylark");i?module.exports=u:n.skylarkjs=u}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-storages-diskfs-all.js.map
