/**
 * skylark-io-diskfs - The filer features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(e,r){var t=r.define,require=r.require,n="function"==typeof t&&t.amd,a=!n&&"undefined"!=typeof exports;if(!n&&!t){var o={};t=r.define=function(e,r,t){"function"==typeof t?(o[e]={factory:t,deps:r.map(function(r){return function(e,r){if("."!==e[0])return e;var t=r.split("/"),n=e.split("/");t.pop();for(var a=0;a<n.length;a++)"."!=n[a]&&(".."==n[a]?t.pop():t.push(n[a]));return t.join("/")}(r,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:t}},require=r.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var t=[];module.deps.forEach(function(e){t.push(require(e))}),module.exports=module.factory.apply(r,t)||null,module.resolved=!0}return module.exports}}if(!t)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-io-diskfs/diskfs",["skylark-langx/skylark"],function(e){var r=function(){return r};return e.attach("storages.diskfs",r)}),e("skylark-io-diskfs/download",["skylark-langx/types","./diskfs"],function(e,r){return r.downlad=function(r,t){if(window.navigator.msSaveBlob)e.isString(r)&&(r=dataURItoBlob(r)),window.navigator.msSaveBlob(r,t);else{var n=document.createElement("a");r instanceof Blob&&(r=URL.createObjectURL(r)),n.href=r,n.setAttribute("download",t||"noname"),n.dispatchEvent(new CustomEvent("click"))}}}),e("skylark-io-diskfs/read",["skylark-langx-async/Deferred","./diskfs"],function(e,r){return r.read=r.readFile=function(r,t){t=t||{};var n=new e,a=new FileReader;a.onload=function(e){n.resolve(e.target.result)},a.onerror=function(e){var r=e.target.error.code;2===r?alert("please don't open this page using protocol fill:///"):alert("error code: "+r)},t.asArrayBuffer?a.readAsArrayBuffer(r):t.asDataUrl?a.readAsDataURL(r):t.asText?a.readAsText(r):a.readAsArrayBuffer(r);return n.promise}}),e("skylark-io-diskfs/readImage",["skylark-langx/Deferred","./diskfs","./read"],function(e,r,t){return r.readImage=function(r){var n=new e,a=new Image;return a.onload=function(){n.resolve(a)},a.onerror=function(e){n.reject(e)},t(r,{asDataUrl:!0}).then(function(e){a.src=e}).catch(function(e){n.reject(e)}),n.promise}}),e("skylark-io-diskfs/select",["./diskfs"],function(e){var r,t=1/0;return e.select=function(e){var n=(e=e||{}).directory||!1,a=e.multiple||!1,o=e.accept||"",i=e.title||"",s=e.picked;if(!r){var l=r=document.createElement("input");function f(e){for(var r=e.length;r--;)e[r].size>t&&e.splice(r,1);s(e)}l.type="file",l.style.position="fixed",l.style.left=0,l.style.top=0,l.style.opacity=.001,document.body.appendChild(l),l.onchange=function(e){var r=e.target.webkitEntries||e.target.entries;r&&r.length?webentry.all(r).then(function(e){f(e)}):f(Array.prototype.slice.call(e.target.files)),l.value=""}}r.multiple=a,r.accept=o,r.title=i,r.webkitdirectory=n,r.click()}}),e("skylark-io-diskfs/webentry",["skylark-langx/arrays","skylark-langx/Deferred","./diskfs"],function(e,r,t){var n=Array.prototype.concat,a=function(){function t(e,t){var n=new r,o=function(e){n.reject(e)};if(t=t||"",e.isFile)e.file(function(e){e.relativePath=t,n.resolve(e)},o);else if(e.isDirectory){var i=e.createReader();i.readEntries(function(r){a(r,t+e.name+"/").then(function(e){n.resolve(e)}).catch(o)},o)}else n.resolve([]);return n.promise}function a(a,o){return r.all(e.map(a,function(e){return t(e,o)})).then(function(){return n.apply([],arguments)})}return{one:t,all:a}}();return t.webentry=a}),e("skylark-io-diskfs/main",["./diskfs","./download","./read","./readImage","./select","./webentry"],function(e){return e}),e("skylark-io-diskfs",["skylark-io-diskfs/main"],function(e){return e})}(t),!n){var i=require("skylark-langx-ns");a?module.exports=i:r.skylarkjs=i}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-io-diskfs.js.map
