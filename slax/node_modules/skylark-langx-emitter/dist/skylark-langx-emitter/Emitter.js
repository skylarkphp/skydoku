/**
 * skylark-langx-emitter - The skylark JavaScript language extension library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./Event"],function(n,t,i,e,s,r){var a=Array.prototype.slice,o=e.compact,h=t.isDefined,l=t.isPlainObject,u=t.isFunction,f=t.isString,c=t.isEmptyObject,v=i.mixin;i.safeMixin;function p(n){var t=(""+n).split(".");return{name:t[0],ns:t.slice(1).join(" ")}}var g=s({on:function(n,t,i,e,s,r){var a=this,o=this._hub||(this._hub={});return l(n)?(s=e,each(n,function(n,e){a.on(n,t,i,e,s,r)}),this):(f(t)||u(e)||(s=e,e=i,i=t,t=void 0),u(i)&&(s=e,e=i,i=null),f(n)&&(n=n.split(/\s/)),n.forEach(function(n){var a=p(n),h=a.name,l=a.ns;(o[h]||(o[h]=[])).push({fn:e,selector:t,data:i,ctx:s,ns:l,one:r})}),this)},one:function(n,t,i,e,s){return this.on(n,t,i,e,s,1)},emit:function(n){if(!this._hub)return this;var t=this;f(n)&&(n=new r(n)),Object.defineProperty(n,"target",{value:this});var i=a.call(arguments,1);return i=h(i)?[n].concat(i):[n],[n.type||n.name,"all"].forEach(function(e){var s=p(e),r=s.name,a=s.ns,h=t._hub[r];if(h){for(var l=h.length,u=!1,f=0;f<l;f++){if(n.isImmediatePropagationStopped&&n.isImmediatePropagationStopped())return this;var c=h[f];(!a||c.ns&&c.ns.startsWith(a))&&(n.data?c.data&&(n.data=v({},c.data,n.data)):n.data=c.data||null,c.fn.apply(c.ctx,i),c.one&&(h[f]=null,u=!0))}u&&(t._hub[e]=o(h))}}),this},listened:function(n){return((this._hub||(this._events={}))[n]||[]).length>0},listenTo:function(n,t,i,e){if(!n)return this;f(i)&&(i=this[i]),e?n.one(t,i,this):n.on(t,i,this);for(var s,r=this._listeningTo||(this._listeningTo=[]),a=0;a<r.length;a++)if(r[a].obj==n){s=r[a];break}s||r.push(s={obj:n,events:{}});var o=s.events,h=o[t]=o[t]||[];return-1==h.indexOf(i)&&h.push(i),this},listenToOnce:function(n,t,i){return this.listenTo(n,t,i,1)},off:function(n,t){var i=this._hub||(this._hub={});return f(n)&&(n=n.split(/\s/)),n.forEach(function(n){var e=p(n),s=e.name,r=e.ns,a=i[s];if(a){var o=[];if(t||r)for(var h=0,l=a.length;h<l;h++)t&&a[h].fn!==t&&a[h].fn._!==t?o.push(a[h]):!r||a[h].ns&&0==a[h].ns.indexOf(r)||o.push(a[h]);o.length?i[s]=o:delete i[s]}}),this},unlistenTo:function(n,t,i){var e=this._listeningTo;if(!e)return this;for(var s=0;s<e.length;s++){var r=e[s];if(!n||n==r.obj){var a=r.events;for(var h in a)if(!t||t==h){for(var l=a[h],u=0;u<l.length;u++)i&&i!=l[s]||(r.obj.off(h,l[s],this),l[s]=null);l=a[h]=o(l),c(l)&&(a[h]=null)}c(a)&&(e[s]=null)}}return e=this._listeningTo=o(e),c(e)&&(this._listeningTo=null),this},trigger:function(){return this.emit.apply(this,arguments)}});return g.createEvent=function(n,t){return new r(n,t)},g.Event=r,n.attach("langx.Emitter",g)});
//# sourceMappingURL=sourcemaps/Emitter.js.map
