{"version":3,"sources":["removing/buttons/HtmlButton.js"],"names":["define","$","Toolbar","Wordpad","Button","HtmlButton","inherit","prototype","name","icon","needFocus","_init","_this","call","this","editor","textarea","on","e","el","addClass","removeClass","setValue","val","_resizeTextarea","status","command","button","i","len","ref","blur","toggleClass","htmlMode","hasClass","hidePopover","beautifyHTML","toolbar","buttons","length","setActive","setDisabled","arguments","_textareaPadding","innerHeight","height","scrollHeight","addButton"],"mappings":";;;;;;;AAAAA,QACE,qBACA,aACA,aACA,aACA,SAASC,EAAEC,EAAQC,EAAQC,GAC1B,IAIIC,EAAaD,EAAOE,YAyEzB,OArEAD,EAAWE,UAAUC,KAAO,OAE5BH,EAAWE,UAAUE,KAAO,QAE5BJ,EAAWE,UAAUG,WAAY,EAEjCL,EAAWE,UAAUI,MAAQ,WAEM,IAAUC,EAW3C,OAZAR,EAAOG,UAAUI,MAAME,KAAKC,MAC5BA,KAAKC,OAAOC,SAASC,GAAG,SAAmBL,EAIxCE,KAHM,SAASI,GACd,OAAON,EAAMG,OAAOI,GAAGC,SAAS,SAASC,YAAY,YAGzDP,KAAKC,OAAOC,SAASC,GAAG,OAAQ,SAAUL,GACxC,OAAO,SAASM,GAEd,OADAN,EAAMG,OAAOI,GAAGE,YAAY,SACrBT,EAAMG,OAAOO,SAASV,EAAMG,OAAOC,SAASO,QAHvB,CAK7BT,OACIA,KAAKC,OAAOC,SAASC,GAAG,QAAS,SAAUL,GAChD,OAAO,SAASM,GACd,OAAON,EAAMY,mBAFuB,CAIrCV,QAGLT,EAAWE,UAAUkB,OAAS,aAE9BpB,EAAWE,UAAUmB,QAAU,WAC7B,IAAIC,EAAQC,EAAGC,EAAKC,EAYpB,IAXAhB,KAAKC,OAAOgB,OACZjB,KAAKC,OAAOI,GAAGa,YAAY,gBAC3BlB,KAAKC,OAAOkB,SAAWnB,KAAKC,OAAOI,GAAGe,SAAS,gBAC3CpB,KAAKC,OAAOkB,UACdnB,KAAKC,OAAOoB,cACZrB,KAAKC,OAAOC,SAASO,IAAIT,KAAKsB,aAAatB,KAAKC,OAAOC,SAASO,QAChET,KAAKU,mBAELV,KAAKC,OAAOO,SAASR,KAAKC,OAAOC,SAASO,OAGvCK,EAAI,EAAGC,GADZC,EAAMhB,KAAKC,OAAOsB,QAAQC,SACJC,OAAQX,EAAIC,EAAKD,IAEjB,UADpBD,EAASG,EAAIF,IACFpB,KACTmB,EAAOa,UAAU1B,KAAKC,OAAOkB,UAE7BN,EAAOc,YAAY3B,KAAKC,OAAOkB,UAGnC,OAAO,MAGT5B,EAAWE,UAAU6B,aAAe,WAClC,OAAOM,UAAU,IAUnBrC,EAAWE,UAAUiB,gBAAkB,WAErC,OADAV,KAAK6B,mBAAqB7B,KAAK6B,iBAAmB7B,KAAKC,OAAOC,SAAS4B,cAAgB9B,KAAKC,OAAOC,SAAS6B,UACrG/B,KAAKC,OAAOC,SAAS6B,OAAO/B,KAAKC,OAAOC,SAAS,GAAG8B,aAAehC,KAAK6B,mBAEjFxC,EAAQD,QAAQ6C,UAAU1C,GAEnBA","file":"../../../removing/buttons/HtmlButton.js","sourcesContent":["define([\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../Wordpad\",\r\n  \"../Button\"\r\n],function($,Toolbar,Wordpad,Button){ \r\n   var  hasProp = {}.hasOwnProperty,\r\n        slice = [].slice;\r\n  \r\n\r\n   var HtmlButton = Button.inherit({\r\n\r\n   });\r\n\r\n  HtmlButton.prototype.name = 'html';\r\n\r\n  HtmlButton.prototype.icon = 'html5';\r\n\r\n  HtmlButton.prototype.needFocus = false;\r\n\r\n  HtmlButton.prototype._init = function() {\r\n    Button.prototype._init.call(this);\r\n    this.editor.textarea.on('focus', (function(_this) {\r\n      return function(e) {\r\n        return _this.editor.el.addClass('focus').removeClass('error');\r\n      };\r\n    })(this));\r\n    this.editor.textarea.on('blur', (function(_this) {\r\n      return function(e) {\r\n        _this.editor.el.removeClass('focus');\r\n        return _this.editor.setValue(_this.editor.textarea.val());\r\n      };\r\n    })(this));\r\n    return this.editor.textarea.on('input', (function(_this) {\r\n      return function(e) {\r\n        return _this._resizeTextarea();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  HtmlButton.prototype.status = function() {};\r\n\r\n  HtmlButton.prototype.command = function() {\r\n    var button, i, len, ref;\r\n    this.editor.blur();\r\n    this.editor.el.toggleClass('wordpad-html');\r\n    this.editor.htmlMode = this.editor.el.hasClass('wordpad-html');\r\n    if (this.editor.htmlMode) {\r\n      this.editor.hidePopover();\r\n      this.editor.textarea.val(this.beautifyHTML(this.editor.textarea.val()));\r\n      this._resizeTextarea();\r\n    } else {\r\n      this.editor.setValue(this.editor.textarea.val());\r\n    }\r\n    ref = this.editor.toolbar.buttons;\r\n    for (i = 0, len = ref.length; i < len; i++) {\r\n      button = ref[i];\r\n      if (button.name === 'html') {\r\n        button.setActive(this.editor.htmlMode);\r\n      } else {\r\n        button.setDisabled(this.editor.htmlMode);\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  HtmlButton.prototype.beautifyHTML = function() {\r\n    return arguments[0];\r\n    var args;\r\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\r\n    if (beautify.html) {\r\n      return beautify.html.apply(beautify, args);\r\n    } else {\r\n      return beautify.apply(null, args);\r\n    }\r\n  };\r\n\r\n  HtmlButton.prototype._resizeTextarea = function() {\r\n    this._textareaPadding || (this._textareaPadding = this.editor.textarea.innerHeight() - this.editor.textarea.height());\r\n    return this.editor.textarea.height(this.editor.textarea[0].scrollHeight - this._textareaPadding);\r\n  };\r\n  Wordpad.Toolbar.addButton(HtmlButton);\r\n\r\n  return HtmlButton;\r\n\t\r\n});"]}