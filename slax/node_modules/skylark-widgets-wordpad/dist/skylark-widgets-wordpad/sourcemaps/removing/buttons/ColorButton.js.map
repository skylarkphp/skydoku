{"version":3,"sources":["removing/buttons/ColorButton.js"],"names":["define","$","Toolbar","Wordpad","Button","i18n","ColorButton","inherit","prototype","name","icon","disableTag","menu","render","args","arguments","length","Array","slice","call","apply","this","renderMenu","appendTo","menuWrapper","on","e","_this","$link","$p","hex","rgb","wrapper","removeClass","currentTarget","hasClass","editor","body","find","window","getComputedStyle","getPropertyValue","_convertRgbToHex","editable","fontColor","translate","match","exec","r","g","b","componentToHex","c","toString","rgbToHex","addButton"],"mappings":";;;;;;;AAAAA,QACE,qBACA,aACA,aACA,YACA,WACA,SAASC,EAAEC,EAAQC,EAAQC,EAAOC,GAGjC,IAAIC,EAAcF,EAAOG,YA0E1B,OArEAD,EAAYE,UAAUC,KAAO,QAE7BH,EAAYE,UAAUE,KAAO,OAE7BJ,EAAYE,UAAUG,WAAa,MAEnCL,EAAYE,UAAUI,MAAO,EAE7BN,EAAYE,UAAUK,OAAS,WAC7B,IAAIC,EAEJ,OADAA,EAAO,GAAKC,UAAUC,OAASC,MAAMT,UAAUU,MAAMC,KAAKJ,UAAW,MAC9DX,EAAOI,UAAUK,OAAOO,MAAMC,KAAMP,IAG7CR,EAAYE,UAAUc,WAAa,WAKjC,OAJArB,EAAE,wmBAAwmBsB,SAASF,KAAKG,aACxnBH,KAAKG,YAAYC,GAAG,YAAa,cAAe,SAASC,GACvD,OAAO,IAEFL,KAAKG,YAAYC,GAAG,QAAS,eAAyBE,EAsB1DN,KArBM,SAASK,GACd,IAAIE,EAAOC,EAAIC,EAAYC,EAG3B,GAFAJ,EAAMK,QAAQC,YAAY,YAC1BL,EAAQ3B,EAAEyB,EAAEQ,gBACFC,SAAS,sBAAuB,CAExC,MADAN,EAAKF,EAAMS,OAAOC,KAAKC,KAAK,UACnBtB,OAAS,GAChB,OAEFe,EAAMQ,OAAOC,iBAAiBX,EAAG,GAAI,MAAMY,iBAAiB,SAC5DX,EAAMH,EAAMe,iBAAiBX,QAE7BA,EAAMQ,OAAOC,iBAAiBZ,EAAM,GAAI,MAAMa,iBAAiB,oBAC/DX,EAAMH,EAAMe,iBAAiBX,GAE/B,GAAKD,EAIL,OAAOH,EAAMS,OAAOO,SAASC,UAAUd,EAAIF,EAAMO,SAAS,sBAAsB9B,EAAKwC,UAAU,mBApBhD,IAAUlB,GAyB/DrB,EAAYE,UAAUkC,iBAAmB,SAASX,GAChD,IAAIe,EAGJ,OADAA,EADK,kCACMC,KAAKhB,IAIL,SAASiB,EAAGC,EAAGC,GACxB,IAAIC,EAUJ,MAAO,KATPA,EAAiB,SAASC,GACxB,IAAItB,EAEJ,OAAmB,KADnBA,EAAMsB,EAAEC,SAAS,KACTrC,OACC,IAAMc,EAENA,IAGiBkB,GAAKG,EAAeF,GAAKE,EAAeD,GAE/DI,CAAoB,EAAXR,EAAM,GAAmB,EAAXA,EAAM,GAAmB,EAAXA,EAAM,IAfzC,IAkBX3C,EAAQD,QAAQqD,UAAUjD,GAEnBA","file":"../../../removing/buttons/ColorButton.js","sourcesContent":["define([\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../Wordpad\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,Wordpad,Button,i18n){ \r\n  \r\n\r\n   var ColorButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ColorButton.prototype.name = 'color';\r\n\r\n  ColorButton.prototype.icon = 'tint';\r\n\r\n  ColorButton.prototype.disableTag = 'pre';\r\n\r\n  ColorButton.prototype.menu = true;\r\n\r\n  ColorButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    return Button.prototype.render.apply(this, args);\r\n  };\r\n\r\n  ColorButton.prototype.renderMenu = function() {\r\n    $('<ul class=\"color-list\">\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-1\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-2\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-3\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-4\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-5\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-6\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-7\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-default\"></a></li>\\n</ul>').appendTo(this.menuWrapper);\r\n    this.menuWrapper.on('mousedown', '.color-list', function(e) {\r\n      return false;\r\n    });\r\n    return this.menuWrapper.on('click', '.font-color', (function(_this) {\r\n      return function(e) {\r\n        var $link, $p, hex, range, rgb, textNode;\r\n        _this.wrapper.removeClass('menu-on');\r\n        $link = $(e.currentTarget);\r\n        if ($link.hasClass('font-color-default')) {\r\n          $p = _this.editor.body.find('p, li');\r\n          if (!($p.length > 0)) {\r\n            return;\r\n          }\r\n          rgb = window.getComputedStyle($p[0], null).getPropertyValue('color');\r\n          hex = _this._convertRgbToHex(rgb);\r\n        } else {\r\n          rgb = window.getComputedStyle($link[0], null).getPropertyValue('background-color');\r\n          hex = _this._convertRgbToHex(rgb);\r\n        }\r\n        if (!hex) {\r\n          return;\r\n        }\r\n\r\n        return _this.editor.editable.fontColor(hex,$link.hasClass('font-color-default'),i18n.translate('coloredText'));\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ColorButton.prototype._convertRgbToHex = function(rgb) {\r\n    var match, re, rgbToHex;\r\n    re = /rgb\\((\\d+),\\s?(\\d+),\\s?(\\d+)\\)/g;\r\n    match = re.exec(rgb);\r\n    if (!match) {\r\n      return '';\r\n    }\r\n    rgbToHex = function(r, g, b) {\r\n      var componentToHex;\r\n      componentToHex = function(c) {\r\n        var hex;\r\n        hex = c.toString(16);\r\n        if (hex.length === 1) {\r\n          return '0' + hex;\r\n        } else {\r\n          return hex;\r\n        }\r\n      };\r\n      return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n    };\r\n    return rgbToHex(match[1] * 1, match[2] * 1, match[3] * 1);\r\n  };\r\n\r\n  Wordpad.Toolbar.addButton(ColorButton);\r\n\r\n  return ColorButton;\r\n\t\r\n});"]}