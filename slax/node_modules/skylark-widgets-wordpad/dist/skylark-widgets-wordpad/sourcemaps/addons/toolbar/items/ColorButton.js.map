{"version":3,"sources":["addons/toolbar/items/ColorButton.js"],"names":["define","$","ToolButton","i18n","addons","ColorButton","inherit","render","args","arguments","length","Array","prototype","slice","call","apply","this","renderMenu","appendTo","menuWrapper","on","e","_this","$link","$p","hex","rgb","wrapper","removeClass","currentTarget","hasClass","editor","body","find","window","getComputedStyle","getPropertyValue","_convertRgbToHex","editable","fontColor","translate","match","exec","r","g","b","componentToHex","c","toString","rgbToHex","toolbar","items","color"],"mappings":";;;;;;;AAAAA,QACE,qBACA,sBACA,gBACA,mBACA,SAASC,EAAEC,EAAWC,EAAKC,GAG1B,IAAIC,EAAcH,EAAWI,SAC5BC,OAAS,WACP,IAAIC,EAEJ,OADAA,EAAO,GAAKC,UAAUC,OAASC,MAAMC,UAAUC,MAAMC,KAAKL,UAAW,MAC9DP,EAAWU,UAAUL,OAAOQ,MAAMC,KAAMR,IAGjDS,WAAa,WAKX,OAJAhB,EAAE,wmBAAwmBiB,SAASF,KAAKG,aACxnBH,KAAKG,YAAYC,GAAG,YAAa,cAAe,SAASC,GACvD,OAAO,IAEFL,KAAKG,YAAYC,GAAG,QAAS,eAAyBE,EAsB1DN,KArBM,SAASK,GACd,IAAIE,EAAOC,EAAIC,EAAYC,EAG3B,GAFAJ,EAAMK,QAAQC,YAAY,YAC1BL,EAAQtB,EAAEoB,EAAEQ,gBACFC,SAAS,sBAAuB,CAExC,MADAN,EAAKF,EAAMS,OAAOC,KAAKC,KAAK,UACnBvB,OAAS,GAChB,OAEFgB,EAAMQ,OAAOC,iBAAiBX,EAAG,GAAI,MAAMY,iBAAiB,SAC5DX,EAAMH,EAAMe,iBAAiBX,QAE7BA,EAAMQ,OAAOC,iBAAiBZ,EAAM,GAAI,MAAMa,iBAAiB,oBAC/DX,EAAMH,EAAMe,iBAAiBX,GAE/B,GAAKD,EAIL,OAAOH,EAAMS,OAAOO,SAASC,UAAUd,EAAIF,EAAMO,SAAS,sBAAsB3B,EAAKqC,UAAU,mBApBhD,IAAUlB,GAyB/De,iBAAmB,SAASX,GAC1B,IAAIe,EAGJ,OADAA,EADK,kCACMC,KAAKhB,IAIL,SAASiB,EAAGC,EAAGC,GACxB,IAAIC,EAUJ,MAAO,KATPA,EAAiB,SAASC,GACxB,IAAItB,EAEJ,OAAmB,KADnBA,EAAMsB,EAAEC,SAAS,KACTtC,OACC,IAAMe,EAENA,IAGiBkB,GAAKG,EAAeF,GAAKE,EAAeD,GAE/DI,CAAoB,EAAXR,EAAM,GAAmB,EAAXA,EAAM,GAAmB,EAAXA,EAAM,IAfzC,MAwBZ,OAHArC,EAAO8C,QAAQC,MAAMC,MAAQ/C,EAGtBA","file":"../../../../addons/toolbar/items/ColorButton.js","sourcesContent":["define([\r\n  \"skylark-domx-query\",\r\n  \"../../../ToolButton\",\r\n  \"../../../i18n\",\r\n  \"../../../addons\"\r\n],function($,ToolButton,i18n,addons){ \r\n  \r\n\r\n   var ColorButton = ToolButton.inherit({\r\n    render : function() {\r\n      var args;\r\n      args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n      return ToolButton.prototype.render.apply(this, args);\r\n    },\r\n\r\n    renderMenu : function() {\r\n      $('<ul class=\"color-list\">\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-1\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-2\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-3\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-4\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-5\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-6\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-7\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-default\"></a></li>\\n</ul>').appendTo(this.menuWrapper);\r\n      this.menuWrapper.on('mousedown', '.color-list', function(e) {\r\n        return false;\r\n      });\r\n      return this.menuWrapper.on('click', '.font-color', (function(_this) {\r\n        return function(e) {\r\n          var $link, $p, hex, range, rgb, textNode;\r\n          _this.wrapper.removeClass('menu-on');\r\n          $link = $(e.currentTarget);\r\n          if ($link.hasClass('font-color-default')) {\r\n            $p = _this.editor.body.find('p, li');\r\n            if (!($p.length > 0)) {\r\n              return;\r\n            }\r\n            rgb = window.getComputedStyle($p[0], null).getPropertyValue('color');\r\n            hex = _this._convertRgbToHex(rgb);\r\n          } else {\r\n            rgb = window.getComputedStyle($link[0], null).getPropertyValue('background-color');\r\n            hex = _this._convertRgbToHex(rgb);\r\n          }\r\n          if (!hex) {\r\n            return;\r\n          }\r\n\r\n          return _this.editor.editable.fontColor(hex,$link.hasClass('font-color-default'),i18n.translate('coloredText'));\r\n        };\r\n      })(this));\r\n    },\r\n\r\n    _convertRgbToHex : function(rgb) {\r\n      var match, re, rgbToHex;\r\n      re = /rgb\\((\\d+),\\s?(\\d+),\\s?(\\d+)\\)/g;\r\n      match = re.exec(rgb);\r\n      if (!match) {\r\n        return '';\r\n      }\r\n      rgbToHex = function(r, g, b) {\r\n        var componentToHex;\r\n        componentToHex = function(c) {\r\n          var hex;\r\n          hex = c.toString(16);\r\n          if (hex.length === 1) {\r\n            return '0' + hex;\r\n          } else {\r\n            return hex;\r\n          }\r\n        };\r\n        return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n      };\r\n      return rgbToHex(match[1] * 1, match[2] * 1, match[3] * 1);\r\n    }\r\n\r\n   });\r\n\r\n   \r\n   addons.toolbar.items.color = ColorButton; \r\n\r\n\r\n   return ColorButton;\r\n\t\r\n});"]}