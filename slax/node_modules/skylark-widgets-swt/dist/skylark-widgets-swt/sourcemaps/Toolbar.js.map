{"version":3,"sources":["Toolbar.js"],"names":["define","langx","$","Widget","inherit","pluginName","options","toolbarFloat","toolbarHidden","toolbarFloatOffset","template","separator","_init","toolbarHeight","_this","this","opts","wrapper","_elm","list","find","on","e","removeClass","document","css","width","editor","editable","util","reflow","outerWidth","os","mobile","position","left","offset","outerHeight","placeholderEl","addToolItem","itemWidget","appendTo","addSeparator"],"mappings":";;;;;;;AAAAA,QACE,sBACA,qBACA,+BACA,SAASC,EAAMC,EAAEC,GAoHjB,OAhHcA,EAAOC,SACnBC,WAAa,eAEbC,SACEC,cAAc,EACdC,eAAe,EACfC,mBAAoB,EACpBC,SAAW,4CACXC,WACED,SAAY,6CAIhBE,MAAQ,WACN,IAAwCC,EAgBDC,EAZvCC,KAAKC,KAAOD,KAAKT,QAOjBS,KAAKE,QAAUf,EAAEa,KAAKG,MACtBH,KAAKI,KAAOJ,KAAKE,QAAQG,KAAK,MAC9BL,KAAKI,KAAKE,GAAG,QAAS,SAASC,GAC7B,OAAO,IAETP,KAAKE,QAAQI,GAAG,aAAuBP,EAIpCC,KAHM,SAASO,GACd,OAAOR,EAAMK,KAAKC,KAAK,YAAYG,YAAY,eAGnDrB,EAAEsB,UAAUH,GAAG,oBAAqB,SAAUP,GAC5C,OAAO,SAASQ,GACd,OAAOR,EAAMK,KAAKC,KAAK,YAAYG,YAAY,YAFf,CAIjCR,QACEA,KAAKC,KAAKR,eAAiBO,KAAKC,KAAKT,eACxCQ,KAAKE,QAAQQ,IAAI,MAAOV,KAAKC,KAAKP,oBAClCI,EAAgB,EACG,SAAUC,GAC3B,OAAO,WASL,OARAA,EAAMG,QAAQQ,IAAI,WAAY,UAC9BX,EAAMG,QAAQS,MAAM,QACpBZ,EAAMa,OAAOC,SAASC,KAAKC,OAAOhB,EAAMG,SACxCH,EAAMG,QAAQS,MAAMZ,EAAMG,QAAQc,cAClCjB,EAAMG,QAAQQ,IAAI,OAAQX,EAAMa,OAAOC,SAASC,KAAKG,GAAGC,OAASnB,EAAMG,QAAQiB,WAAWC,KAAOrB,EAAMG,QAAQmB,SAASD,MACxHrB,EAAMG,QAAQQ,IAAI,WAAY,IAC9BZ,EAAgBC,EAAMG,QAAQoB,cAC9BvB,EAAMa,OAAOW,cAAcb,IAAI,MAAOZ,IAC/B,GAVQ,CAYhBE,QA4CPwB,YAAc,SAASC,GAErB,OADAtC,EAAEsC,EAAWtB,MAAMuB,SAAS1B,KAAKI,MAC1BJ,MAGT2B,aAAe,WAEb,OADAxC,EAAEa,KAAKT,QAAQK,UAAUD,UAAU+B,SAAS1B,KAAKI,MAC1CJ","file":"../Toolbar.js","sourcesContent":["define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-widgets-base/Widget\"\r\n],function(langx,$,Widget){ \r\n\r\n\r\n\r\n  var Toolbar = Widget.inherit({\r\n    pluginName : \"lark.toolbar\",\r\n\r\n    options : {\r\n      toolbarFloat: true,\r\n      toolbarHidden: false,\r\n      toolbarFloatOffset: 0,\r\n      template : '<div class=\"lark-toolbar\"><ul></ul></div>',\r\n      separator : {\r\n        template :  '<li><span class=\"separator\"></span></li>'\r\n      }\r\n    },\r\n\r\n    _init : function() {\r\n      var floatInitialized, initToolbarFloat, toolbarHeight;\r\n      //this.editor = editor;\r\n\r\n      //this.opts = langx.extend({}, this.opts, opts);\r\n      this.opts = this.options;\r\n\r\n\r\n      //if (!langx.isArray(this.opts.toolbar)) {\r\n      //  this.opts.toolbar = ['bold', 'italic', 'underline', 'strikethrough', '|', 'ol', 'ul', 'blockquote', 'code', '|', 'link', 'image', '|', 'indent', 'outdent'];\r\n      //}\r\n\r\n      this.wrapper = $(this._elm);\r\n      this.list = this.wrapper.find('ul');\r\n      this.list.on('click', function(e) {\r\n        return false;\r\n      });\r\n      this.wrapper.on('mousedown', (function(_this) {\r\n        return function(e) {\r\n          return _this.list.find('.menu-on').removeClass('.menu-on');\r\n        };\r\n      })(this));\r\n      $(document).on('mousedown.toolbar', (function(_this) {\r\n        return function(e) {\r\n          return _this.list.find('.menu-on').removeClass('menu-on');\r\n        };\r\n      })(this));\r\n      if (!this.opts.toolbarHidden && this.opts.toolbarFloat) {\r\n        this.wrapper.css('top', this.opts.toolbarFloatOffset);\r\n        toolbarHeight = 0;\r\n        initToolbarFloat = (function(_this) {\r\n          return function() {\r\n            _this.wrapper.css('position', 'static');\r\n            _this.wrapper.width('auto');\r\n            _this.editor.editable.util.reflow(_this.wrapper);\r\n            _this.wrapper.width(_this.wrapper.outerWidth());\r\n            _this.wrapper.css('left', _this.editor.editable.util.os.mobile ? _this.wrapper.position().left : _this.wrapper.offset().left);\r\n            _this.wrapper.css('position', '');\r\n            toolbarHeight = _this.wrapper.outerHeight();\r\n            _this.editor.placeholderEl.css('top', toolbarHeight);\r\n            return true;\r\n          };\r\n        })(this);\r\n        floatInitialized = null;\r\n\r\n        /*\r\n        $(window).on('resize.richeditor-' + this.editor.id, function(e) {\r\n          return floatInitialized = initToolbarFloat();\r\n        });\r\n        $(window).on('scroll.richeditor-' + this.editor.id, (function(_this) {\r\n          return function(e) {\r\n            var bottomEdge, scrollTop, topEdge;\r\n            if (!_this.wrapper.is(':visible')) {\r\n              return;\r\n            }\r\n            topEdge = _this.editor.wrapper.offset().top;\r\n            bottomEdge = topEdge + _this.editor.wrapper.outerHeight() - 80;\r\n            scrollTop = $(document).scrollTop() + _this.opts.toolbarFloatOffset;\r\n            if (scrollTop <= topEdge || scrollTop >= bottomEdge) {\r\n              _this.editor.wrapper.removeClass('toolbar-floating').css('padding-top', '');\r\n              if (_this.editor.editable.util.os.mobile) {\r\n                return _this.wrapper.css('top', _this.opts.toolbarFloatOffset);\r\n              }\r\n            } else {\r\n              floatInitialized || (floatInitialized = initToolbarFloat());\r\n              _this.editor.wrapper.addClass('toolbar-floating').css('padding-top', toolbarHeight);\r\n              if (_this.editor.editable.util.os.mobile) {\r\n                return _this.wrapper.css('top', scrollTop - topEdge + _this.opts.toolbarFloatOffset);\r\n              }\r\n            }\r\n          };\r\n        })(this));\r\n        */\r\n      }\r\n\r\n      /*\r\n      this.editor.on('destroy', (function(_this) {\r\n        return function() {\r\n          return _this.buttons.length = 0;\r\n        };\r\n      })(this));\r\n      */\r\n\r\n      \r\n    },\r\n\r\n    addToolItem : function(itemWidget) {\r\n      $(itemWidget._elm).appendTo(this.list);\r\n      return this;\r\n    },\r\n\r\n    addSeparator : function() {\r\n      $(this.options.separator.template).appendTo(this.list);\r\n      return this;\r\n    }\r\n\r\n  });\r\n\r\n\r\n  return Toolbar;\r\n\r\n});"]}