{"version":3,"sources":["TabStrip.js"],"names":["define","langx","browser","eventer","noder","geom","$","swt","Widget","TabStrip","inherit","klassName","pluginName","options","selectors","header","tab","content","tabpane","droptabs","dropdown","dropdownMenu","dropdownTabs","dropdownCaret","visibleTabs","auto","pullDropdownRight","_init","this","$header","_velm","$tabs","find","$content","$tabpanes","self","each","idx","tabEl","target","arrange","dropdownTabsSelector","visibleTabsSelector","$container","dropdownLabel","clone","remove","addClass","$dropdownTabs","$visibleTabs","tempElem","hiddenElementWidth","availableSpace","outerWidth","visibleTabsWidth","index","parseInt","x","get","reverse","hasClass","prependTo","first","appendTo","css","is","detach","insertAfter","length","hide","show","add"],"mappings":"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","file":"../TabStrip.js","sourcesContent":["define([\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx-browser\",\r\n    \"skylark-domx-eventer\",\r\n    \"skylark-domx-noder\",\r\n    \"skylark-domx-geom\",\r\n    \"skylark-domx-query\",\r\n    \"./swt\",\r\n    \"./Widget\",\r\n    \"skylark-bootstrap3/tab\",\r\n    \"skylark-bootstrap3/dropdown\"\r\n], function(langx, browser, eventer, noder, geom,  $, swt, Widget) {\r\n\r\n    var TabStrip = Widget.inherit({\r\n        klassName : \"TabStrip\",\r\n        pluginName : \"lark.tabstrip\",\r\n\r\n        options : {\r\n          selectors : {\r\n            header : \".nav-tabs\",\r\n            tab : \"[data-toggle=\\\"tab\\\"]\",\r\n            content : \".tab-content\",\r\n            tabpane : \".tab-pane\"\r\n          },\r\n\r\n          droptabs : {\r\n            selectors : {\r\n              dropdown : \"li.droptabs\",\r\n              dropdownMenu    : \"ul.dropdown-menu\",\r\n              dropdownTabs    : \"li\",\r\n              dropdownCaret   : \"b.caret\",\r\n              visibleTabs     : \">li:not(.dropdown)\",\r\n            },\r\n            auto              : true,\r\n            pullDropdownRight : true,\r\n\r\n\r\n          }\r\n        },\r\n\r\n        _init : function() {\r\n          this.$header = this._velm.$(this.options.selectors.header); \r\n          this.$tabs = this.$header.find(this.options.selectors.tab);\r\n          this.$content = this._velm.$(this.options.selectors.content);\r\n          this.$tabpanes = this.$content.find(this.options.selectors.tabpane);\r\n\r\n          this.$header.find('[data-toggle=\"dropdown\"]').dropdown();\r\n\r\n          var self = this;\r\n          this.$tabs.each(function(idx,tabEl){\r\n            $(tabEl).tab({\r\n              target : self.$tabpanes[idx]\r\n            });\r\n          });\r\n\r\n        },\r\n\r\n        arrange : function () {\r\n\r\n          var dropdownTabsSelector = this.options.droptabs.selectors.dropdownTabs,\r\n              visibleTabsSelector = this.options.droptabs.selectors.visibleTabs;\r\n\r\n              $container = this.$header;\r\n          var dropdown = $container.find(this.options.droptabs.selectors.dropdown);\r\n          var dropdownMenu = dropdown.find(this.options.droptabs.selectors.dropdownMenu);\r\n          var dropdownLabel = $('>a', dropdown).clone();\r\n          var dropdownCaret = $(this.options.droptabs.selectors.dropdownCaret, dropdown);\r\n\r\n          // We only want the default label, strip the caret out\r\n          $(this.options.droptabs.selectors.dropdownCaret, dropdownLabel).remove();\r\n\r\n          if (this.options.droptabs.pullDropdownRight) {\r\n            $(dropdown).addClass('pull-right');\r\n          }\r\n\r\n          var $dropdownTabs = function () {\r\n            return $(dropdownTabsSelector, dropdownMenu);\r\n          }\r\n\r\n          var $visibleTabs = function () {\r\n            return $(visibleTabsSelector, $container);\r\n          }\r\n\r\n          function getFirstHiddenElementWidth() {\r\n            var tempElem=$dropdownTabs().first().clone().appendTo($container).css(\"position\",\"fixed\");\r\n            var hiddenElementWidth = $(tempElem).outerWidth();\r\n            $(tempElem).remove();\r\n            return hiddenElementWidth;\r\n          }\r\n\r\n          function getHiddenElementWidth(elem) {\r\n            var tempElem=$(elem).clone().appendTo($container).css(\"position\",\"fixed\");\r\n            var hiddenElementWidth = $(tempElem).outerWidth();\r\n            $(tempElem).remove();\r\n            return hiddenElementWidth;\r\n          }\r\n\r\n          function getDropdownLabel() {\r\n            var labelText = 'Dropdown';\r\n            if ($(dropdown).hasClass('active')) {\r\n              labelText = $('>li.active>a', dropdownMenu).html();\r\n            } else if (dropdownLabel.html().length > 0) {\r\n              labelText = dropdownLabel.html();\r\n            }\r\n\r\n            labelText = $.trim(labelText);\r\n\r\n            if (labelText.length > 10) {\r\n              labelText = labelText.substring(0, 10) + '...';\r\n            }\r\n\r\n            return labelText;\r\n          }\r\n\r\n          function renderDropdownLabel() {\r\n            $('>a', dropdown).html(getDropdownLabel() + ' ' + dropdownCaret.prop('outerHTML'));\r\n          }\r\n\r\n          function manageActive(elem) {\r\n            //fixes a bug where Bootstrap can't remove the 'active' class on elements after they've been hidden inside the dropdown\r\n            $('a', $(elem)).on('show.bs.tab', function (e) {\r\n              $(e.relatedTarget).parent().removeClass('active');\r\n            })\r\n            $('a', $(elem)).on('shown.bs.tab', function (e) {\r\n              renderDropdownLabel();\r\n            })\r\n\r\n          }\r\n\r\n          function checkDropdownSelection() {\r\n            if ($($dropdownTabs()).filter('.active').length > 0) {\r\n              $(dropdown).addClass('active');\r\n            } else {\r\n              $(dropdown).removeClass('active');\r\n            }\r\n\r\n            renderDropdownLabel();\r\n          }\r\n\r\n\r\n          var visibleTabsWidth = function () {\r\n            var visibleTabsWidth = 0;\r\n            $($visibleTabs()).each(function( index ) {\r\n              visibleTabsWidth += parseInt($(this).outerWidth(), 10);\r\n            });\r\n            visibleTabsWidth = visibleTabsWidth + parseInt($(dropdown).outerWidth(), 10);\r\n            return visibleTabsWidth;\r\n          }\r\n\r\n          var availableSpace = function () {\r\n            return $container.outerWidth()-visibleTabsWidth();\r\n          }\r\n\r\n          if (availableSpace()<0) {//we will hide tabs here\r\n            var x = availableSpace();\r\n            $($visibleTabs().get().reverse()).each(function( index ){\r\n              if (!($(this).hasClass('always-visible'))){\r\n                  $(this).prependTo(dropdownMenu);\r\n                  x=x+$(this).outerWidth();\r\n              }\r\n              if (x>=0) {return false;}\r\n            });\r\n          }\r\n\r\n          if (availableSpace()>getFirstHiddenElementWidth()) { //and here we bring the tabs out\r\n            var x = availableSpace();\r\n            $($dropdownTabs()).each(function( index ){\r\n              if (getHiddenElementWidth(this) < x && !($(this).hasClass('always-dropdown'))){\r\n                $(this).appendTo($container);\r\n                x = x-$(this).outerWidth();\r\n              } else {return false;}\r\n             });\r\n\r\n            if (!this.options.droptabs.pullDropdownRight && !$(dropdown).is(':last-child')) {\r\n              // If not pulling-right, keep the dropdown at the end of the container.\r\n              $(dropdown).detach().insertAfter($container.find('li:last-child'));\r\n            }\r\n          }\r\n\r\n          if ($dropdownTabs().length <= 0) {\r\n            dropdown.hide();\r\n          } else {\r\n            dropdown.show();\r\n          }\r\n        },\r\n\r\n        add : function() {\r\n          //TODO\r\n        },\r\n\r\n        remove : function(){\r\n          //TODO\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n    return swt.TabStrip = TabStrip;\r\n\r\n});"]}