{"version":3,"sources":["SearchBox.js"],"names":["define","langx","browser","eventer","noder","geom","$","swt","Widget","SearchBox","inherit","klassName","pluginName","options","clearOnEmpty","searchOnKeyPress","allowCancel","_init","this","$element","_elm","$repeater","closest","attr","$button","find","$input","$icon","on","proxy","buttonclicked","keypress","length","clearPending","activeSearch","destroy","remove","each","val","outerHTML","search","searchText","hasClass","removeClass","addClass","trigger","clear","action","e","preventDefault","currentTarget","is","which","disable","enable","removeAttr"],"mappings":";;;;;;;AAAAA,QACE,sBACA,uBACA,uBACA,qBACA,oBACA,qBACA,QACA,WACA,+BACA,SAASC,EAAMC,EAAQC,EAAQC,EAAMC,EAAKC,EAAEC,EAAIC,GAKjD,IAAIC,EAAYD,EAAOE,SACtBC,UAAW,YAEXC,WAAY,iBAEZC,SACCC,cAAc,EACdC,kBAAkB,EAClBC,aAAa,GAGdC,MAAQ,WACPC,KAAKC,SAAWb,EAAEY,KAAKE,MACvBF,KAAKG,UAAYH,KAAKC,SAASG,QAAQ,aAEa,SAAhDJ,KAAKC,SAASI,KAAK,2BACtBL,KAAKL,QAAQE,kBAAmB,GAGjCG,KAAKM,QAAUN,KAAKC,SAASM,KAAK,UAClCP,KAAKQ,OAASR,KAAKC,SAASM,KAAK,SACjCP,KAAKS,MAAQT,KAAKC,SAASM,KAAK,4BAEhCP,KAAKM,QAAQI,GAAG,kBAAmB3B,EAAM4B,MAAMX,KAAKY,cAAeZ,OACnEA,KAAKQ,OAAOE,GAAG,kBAAmB3B,EAAM4B,MAAMX,KAAKa,SAAUb,OAEzDA,KAAKG,UAAUW,OAAS,GAC3Bd,KAAKG,UAAUO,GAAG,uBAAwB3B,EAAM4B,MAAMX,KAAKe,aAAcf,OAG1EA,KAAKgB,aAAe,IAErBC,QAAS,WAWR,OAVAjB,KAAKC,SAASiB,SAIdlB,KAAKC,SAASM,KAAK,SAASY,KAAK,WAChC/B,EAAEY,MAAMK,KAAK,QAASjB,EAAEY,MAAMoB,SAKxBpB,KAAKC,SAAS,GAAGoB,WAGzBC,OAAQ,SAAUC,GACbvB,KAAKS,MAAMe,SAAS,cACvBxB,KAAKS,MAAMgB,YAAY,oBAAoBC,SAAS,oBAEjD1B,KAAKS,MAAMe,SAAS,gBACvBxB,KAAKS,MAAMgB,YAAY,sBAAsBC,SAAS,sBAGvD1B,KAAKgB,aAAeO,EACpBvB,KAAKC,SAASyB,SAAS,oBACvB1B,KAAKC,SAAS0B,QAAQ,qBAAsBJ,IAG7CK,MAAO,WACF5B,KAAKS,MAAMe,SAAS,cACvBxB,KAAKS,MAAMgB,YAAY,oBAAoBC,SAAS,oBAEjD1B,KAAKS,MAAMe,SAAS,gBACvBxB,KAAKS,MAAMgB,YAAY,sBAAsBC,SAAS,sBAGnD1B,KAAKC,SAASuB,SAAS,YAC1BxB,KAAKC,SAAS0B,QAAQ,sBAGvB3B,KAAKgB,aAAe,GACpBhB,KAAKQ,OAAOY,IAAI,IAChBpB,KAAKC,SAAS0B,QAAQ,qBACtB3B,KAAKC,SAASwB,YAAY,qBAG3BV,aAAc,WACbf,KAAKC,SAASwB,YAAY,YAG3BI,OAAQ,WACP,IAAIT,EAAMpB,KAAKQ,OAAOY,MAElBA,GAAOA,EAAIN,OAAS,EACvBd,KAAKsB,OAAOF,GAEZpB,KAAK4B,SAIPhB,cAAe,SAAUkB,GACxBA,EAAEC,iBACE3C,EAAE0C,EAAEE,eAAeC,GAAG,0BAEtBjC,KAAKC,SAASuB,SAAS,YAAcxB,KAAKC,SAASuB,SAAS,YAC/DxB,KAAK4B,QAEL5B,KAAK6B,WAIPhB,SAAU,SAAUiB,GACE,KAIjBA,EAAEI,OACLJ,EAAEC,iBACF/B,KAAK6B,UALa,IAMRC,EAAEI,MACZJ,EAAEC,iBANgB,KAORD,EAAEI,OACZJ,EAAEC,iBACF/B,KAAK4B,SACK5B,KAAKL,QAAQE,kBAEvBG,KAAK6B,UAIPM,QAAS,WACRnC,KAAKC,SAASyB,SAAS,YACvB1B,KAAKQ,OAAOH,KAAK,WAAY,YAExBL,KAAKL,QAAQG,aACjBE,KAAKM,QAAQoB,SAAS,aAIxBU,OAAQ,WACPpC,KAAKC,SAASwB,YAAY,YAC1BzB,KAAKQ,OAAO6B,WAAW,YACvBrC,KAAKM,QAAQmB,YAAY,eAI3B,OAAQpC,EAAIE,UAAYA","file":"../SearchBox.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"./swt\",\n  \"./Widget\",\n  \"skylark-bootstrap3/dropdown\"\n],function(langx,browser,eventer,noder,geom,$,swt,Widget){\n\n\n\t// SEARCH CONSTRUCTOR AND PROTOTYPE\n\n\tvar SearchBox = Widget.inherit({\n\t\tklassName: \"SearchBox\",\n\n\t\tpluginName: \"lark.searchbox\",\n\n\t\toptions : {\n\t\t\tclearOnEmpty: false,\n\t\t\tsearchOnKeyPress: false,\n\t\t\tallowCancel: false\n\t\t},\n\t\n\t\t_init : function() {\n\t\t\tthis.$element = $(this._elm);\n\t\t\tthis.$repeater = this.$element.closest('.repeater');\n\n\t\t\tif (this.$element.attr('data-searchOnKeyPress') === 'true'){\n\t\t\t\tthis.options.searchOnKeyPress = true;\n\t\t\t}\n\n\t\t\tthis.$button = this.$element.find('button');\n\t\t\tthis.$input = this.$element.find('input');\n\t\t\tthis.$icon = this.$element.find('.glyphicon, .fuelux-icon');\n\n\t\t\tthis.$button.on('click.fu.search', langx.proxy(this.buttonclicked, this));\n\t\t\tthis.$input.on('keyup.fu.search', langx.proxy(this.keypress, this));\n\n\t\t\tif (this.$repeater.length > 0) {\n\t\t\t\tthis.$repeater.on('rendered.fu.repeater', langx.proxy(this.clearPending, this));\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t},\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tsearch: function (searchText) {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-search').addClass('glyphicon-remove');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-search').addClass('fuelux-icon-remove');\n\t\t\t}\n\n\t\t\tthis.activeSearch = searchText;\n\t\t\tthis.$element.addClass('searched pending');\n\t\t\tthis.$element.trigger('searched.fu.search', searchText);\n\t\t},\n\n\t\tclear: function () {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-remove').addClass('glyphicon-search');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-remove').addClass('fuelux-icon-search');\n\t\t\t}\n\n\t\t\tif (this.$element.hasClass('pending')) {\n\t\t\t\tthis.$element.trigger('canceled.fu.search');\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t\tthis.$input.val('');\n\t\t\tthis.$element.trigger('cleared.fu.search');\n\t\t\tthis.$element.removeClass('searched pending');\n\t\t},\n\n\t\tclearPending: function () {\n\t\t\tthis.$element.removeClass('pending');\n\t\t},\n\n\t\taction: function () {\n\t\t\tvar val = this.$input.val();\n\n\t\t\tif (val && val.length > 0) {\n\t\t\t\tthis.search(val);\n\t\t\t} else {\n\t\t\t\tthis.clear();\n\t\t\t}\n\t\t},\n\n\t\tbuttonclicked: function (e) {\n\t\t\te.preventDefault();\n\t\t\tif ($(e.currentTarget).is('.disabled, :disabled')) return;\n\n\t\t\tif (this.$element.hasClass('pending') || this.$element.hasClass('searched')) {\n\t\t\t\tthis.clear();\n\t\t\t} else {\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tkeypress: function (e) {\n\t\t\tvar ENTER_KEY_CODE = 13;\n\t\t\tvar TAB_KEY_CODE = 9;\n\t\t\tvar ESC_KEY_CODE = 27;\n\n\t\t\tif (e.which === ENTER_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.action();\n\t\t\t} else if (e.which === TAB_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t} else if (e.which === ESC_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.clear();\n\t\t\t} else if (this.options.searchOnKeyPress) {\n\t\t\t\t// search on other keypress\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', 'disabled');\n\n\t\t\tif (!this.options.allowCancel) {\n\t\t\t\tthis.$button.addClass('disabled');\n\t\t\t}\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t}\n\t});\n\n\treturn \tswt.SearchBox = SearchBox;\n});\n"]}