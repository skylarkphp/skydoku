/**
 * skylark-data-collection - The skylark collection utility library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,n){var e=n.define,r=n.require,o="function"==typeof e&&e.amd,a=!o&&"undefined"!=typeof exports;if(!o&&!e){var s={};e=n.define=function(t,n,e){"function"==typeof e?(s[t]={factory:e,deps:n.map(function(n){return function(t,n){if("."!==t[0])return t;var e=n.split("/"),r=t.split("/");e.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?e.pop():e.push(r[i]));return e.join("/")}(n,t)}),resolved:!1,exports:null},r(t)):s[t]={factory:null,resolved:!0,exports:e}},r=n.require=function(t){if(!s.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var e=s[t];if(!e.resolved){var i=[];e.deps.forEach(function(t){i.push(r(t))}),e.exports=e.factory.apply(n,i)||null,e.resolved=!0}return e.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,n){t("skylark-langx/_attach",[],function(){return function(t,n,e){"string"==typeof n&&(n=n.split("."));for(var r=n.length,i=t,o=0,a=n[o++];o<r;)i=i[a]=i[a]||{},a=n[o++];return i[a]=e}}),t("skylark-langx/skylark",["./_attach"],function(t){var n={attach:function(e,r){return t(n,e,r)}};return n}),t("skylark-data-collection/collections",["skylark-langx/skylark"],function(t){return t.attach("data.collections",{})}),t("skylark-langx/types",[],function(){var t,n={}.toString,e=(t={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(n){t["[object "+n+"]"]=n.toLowerCase()}),function(e){return null==e?String(e):t[n.call(e)]||"object"});function r(t){var n;for(n in t)if(null!==t[n])return!1;return!0}function i(t){return"function"==e(t)}function o(t){return t&&t.nodeType}function a(t){return"number"==typeof t}function s(t){return"object"==e(t)}function u(t){return"string"==typeof t}function c(t){return t&&t==t.window}return{isArray:function(t){return t&&t.constructor===Array},isArrayLike:function(t){return!u(t)&&!o(t)&&"number"==typeof t.length&&!i(t)},isBoolean:function(t){return"boolean"==typeof t},isDefined:function(t){return void 0!==t},isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isEmpty:r,isEmptyObject:r,isFunction:i,isHtmlNode:o,isNull:function(t){return"null"===e(t)},isNumber:a,isNumeric:a,isObject:s,isPlainObject:function(t){return s(t)&&!c(t)&&Object.getPrototypeOf(t)==Object.prototype},isString:u,isSameOrigin:function(t){if(t){var n=location.protocol+"//"+location.hostname;return location.port&&(n+=":"+location.port),t.startsWith(n)}},isSymbol:function(t){return"symbol"==typeof t||isObjectLike(t)&&objectToString.call(t)==symbolTag},isUndefined:function(t){return void 0===t},isWindow:c,type:e}}),t("skylark-langx/arrays",["./types"],function(t,n){var e=Array.prototype.filter,r=t.isArrayLike;function i(t,n,e,r){for(var i=t.length,o=e+(r?1:-1);r?o--:++o<i;)if(n(t[o],o,t))return o;return-1}function o(t){return t!=t}function a(t){if(r(t)){for(var n=[],e=0;e<t.length;e++){var i=t[e];if(r(i))for(var o=0;o<i.length;o++)n.push(i[o]);else n.push(i)}return n}return t}return{baseFindIndex:i,baseIndexOf:function(t,n,e){if(n!=n)return i(t,o,e);var r=e-1,a=t.length;for(;++r<a;)if(t[r]===n)return r;return-1},compact:function(t){return e.call(t,function(t){return null!=t})},first:function(t,n){return n?t.slice(0,n):t[0]},filter:function(t,n){return e.call(t,n)},flatten:a,inArray:function(t,n){if(!n)return-1;var e;if(n.indexOf)return n.indexOf(t);e=n.length;for(;e--;)if(n[e]===t)return e;return-1},makeArray:function(t,n,e){if(r(t))return(e||[]).concat(Array.prototype.slice.call(t,n||0));return[t]},merge:function(t,n){var e=n.length,r=t.length,i=0;if("number"==typeof e)for(;i<e;i++)t[r++]=n[i];else for(;void 0!==n[i];)t[r++]=n[i++];return t.length=r,t},forEach:function(t,n){if(t.forEach)return t.forEach(n);for(var e=0;e<t.length;e++)n(t[e],e)},map:function(t,n){var e,i,o,s=[];if(r(t))for(i=0;i<t.length;i++)null!=(e=n.call(t[i],t[i],i))&&s.push(e);else for(o in t)null!=(e=n.call(t[o],t[o],o))&&s.push(e);return a(s)},reduce:function(t,n,e){return Array.prototype.reduce.call(t,n,e)},uniq:function(t){return e.call(t,function(n,e){return t.indexOf(n)==e})}}}),t("skylark-langx/numbers",["./types"],function(t){var n=t.isObject,e=t.isSymbol,r=1/0,i=1.7976931348623157e308,o=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;function h(t){if(!t)return 0===t?t:0;if((t=f(t))===r||t===-r){var n=t<0?-1:1;return n*i}return t==t?t:0}function f(t){if("number"==typeof t)return t;if(e(t))return o;if(n(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=n(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var i=u.test(t);return i||c.test(t)?l(t.slice(2),i?2:8):s.test(t)?o:+t}return{toFinite:h,toNumber:f,toInteger:function(t){var n=h(t),e=n%1;return n==n?e?n-e:n:0}}}),t("skylark-langx/objects",["./_attach","./types","./numbers"],function(t,n,e){var r,i,o=Object.prototype.hasOwnProperty,a=Array.prototype.slice,s=n.isBoolean,u=n.isFunction,c=n.isObject,l=n.isPlainObject,h=n.isArray,f=n.isArrayLike,p=n.isString,g=e.toInteger;var v,d,_="undefined"!=typeof Symbol?Symbol.prototype:null;function m(t){if(!c(t))return[];var n=[];for(var e in t)n.push(e);return n}function y(t,n){if(!h(n))return null!=t&&o.call(t,n);for(var e=n.length,r=0;r<e;r++){var i=n[r];if(null==t||!o.call(t,i))return!1;t=t[i]}return!!e}function k(t,n,e,r){for(var i in n)r&&void 0!==t[i]||(e&&(l(n[i])||h(n[i]))?(l(n[i])&&!l(t[i])&&(t[i]={}),h(n[i])&&!h(t[i])&&(t[i]=[]),k(t[i],n[i],e,r)):void 0!==n[i]&&(t[i]=n[i]));return t}function x(t){var n=a.call(arguments,0),e=n.shift(),r=!1;return s(n[n.length-1])&&(r=n.pop()),{target:e,sources:n,deep:r}}function b(){var t=x.apply(this,arguments);return t.sources.forEach(function(n){k(t.target,n,t.deep,!1)}),t.target}function I(t){for(var n=m(t),e=n.length,r=Array(e),i=0;i<e;i++)r[i]=t[n[i]];return r}return r=function(t,n,e,r){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return!1;if(t!=t)return n!=n;var o=typeof t;return("function"===o||"object"===o||"object"==typeof n)&&i(t,n,e,r)},i=function(t,n,e,i){var o=toString.call(t);if(o!==toString.call(n))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return _.valueOf.call(t)===_.valueOf.call(n)}var a="[object Array]"===o;if(!a){if("object"!=typeof t||"object"!=typeof n)return!1;var s=t.constructor,c=n.constructor;if(s!==c&&!(u(s)&&s instanceof s&&u(c)&&c instanceof c)&&"constructor"in t&&"constructor"in n)return!1}e=e||[],i=i||[];for(var l=e.length;l--;)if(e[l]===t)return i[l]===n;if(e.push(t),i.push(n),a){if((l=t.length)!==n.length)return!1;for(;l--;)if(!r(t[l],n[l],e,i))return!1}else{var h,f=Object.keys(t);if(l=f.length,Object.keys(n).length!==l)return!1;for(;l--;)if(h=f[l],void 0===n[h]||!r(t[h],n[h],e,i))return!1}return e.pop(),i.pop(),!0},{allKeys:m,attach:t,clone:function t(n,e){var r;if(void 0===n||null===n)r=n;else if(e&&n.clone)r=n.clone();else if(h(n)){r=[];for(var i=0;i<n.length;i++)r.push(t(n[i]))}else if(l(n))for(var o in r={},n)r[o]=t(n[o]);else r=n;return r},defaults:(v=m,d=!0,function(t){var n=arguments.length;if(d&&(t=Object(t)),n<2||null==t)return t;for(var e=1;e<n;e++)for(var r=arguments[e],i=v(r),o=i.length,a=0;a<o;a++){var s=i[a];d&&void 0!==t[s]||(t[s]=r[s])}return t}),each:function(t,n){var e,r,i,o;if(t)if(void 0===(e=t.length)){for(r in t)if(t.hasOwnProperty(r)&&(o=t[r],!1===n.call(o,r,o)))break}else for(i=0;i<e&&(o=t[i],!1!==n.call(o,i,o));i++);return this},extend:function(t){var n,e=a.call(arguments,1);"boolean"==typeof t&&(n=t,t=e.shift());0==e.length&&(e=[t],t=this);return e.forEach(function(e){b(t,e,n)}),t},has:y,isEqual:function(t,n){return r(t,n)},includes:function(t,n,e,r){t=f(t)?t:I(t),e=e&&!r?g(e):0;var i=t.length;e<0&&(e=nativeMax(i+e,0));return p(t)?e<=i&&t.indexOf(n,e)>-1:!!i&&baseIndexOf(t,n,e)>-1},isMatch:function(t,n){var e=e(n),r=e.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=e[o];if(n[a]!==i[a]||!(a in i))return!1}return!0},keys:function(t){if(c(t))return[];var n=[];for(var e in t)y(t,e)&&n.push(e);return n},mixin:b,omit:function(t,n,e){if(!t)return null;for(var r=b({},t),i=1;i<arguments.length;i++){var o=arguments[i];o in t&&delete r[o]}return r},pick:function(t,n,e){if(!t)return null;for(var r={},i=1;i<arguments.length;i++){var o=arguments[i];o in t&&(r[o]=t[o])}return r},removeItem:function(t,n){if(h(t)){var e=t.indexOf(n);-1!=e&&t.splice(e,1)}else if(l(t))for(var r in t)if(t[r]==n){delete t[r];break}return this},result:function(t,n,e){h(n)||(n=n.split("."));var r=n.length;if(!r)return u(e)?e.call(t):e;for(var i=0;i<r;i++){var o=null==t?void 0:t[n[i]];void 0===o&&(o=e,i=r),t=u(o)?o.call(t):o}return t},safeMixin:function(){var t=x.apply(this,arguments);return t.sources.forEach(function(n){k(t.target,n,t.deep,!0)}),t.target},values:I}}),t("skylark-langx/klass",["./arrays","./objects","./types"],function(t,n,e){var r=t.uniq,i=n.has,o=n.mixin,a=e.isArray,s=e.isDefined;var u=function(){function t(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function n(u,c,l,h){a(c)&&(h=l,l=c,c=null),c=c||Object,s(l)&&!a(l)&&(h=l,l=!1);var f=c;l&&(l=function(t,n){var e=[];return n.forEach(function(t){if(i(t,"__mixins__"))throw new Error("nested mixins");for(var n=[];t;)n.unshift(t),t=t.superclass;e=e.concat(n)}),(e=(e=r(e)).filter(function(n){for(var e=t;e;){if(n===e)return!1;if(i(e,"__mixins__"))for(var r=e.__mixins__,o=0;o<r.length;o++)if(r[o]===n)return!1;e=e.superclass}return!0})).length>0&&e}(f,l)),l&&(f=function(t,n){for(var e=t,r=0;r<n.length;r++){var i=new Function;i.prototype=Object.create(e.prototype),i.__proto__=e,i.superclass=null,o(i.prototype,n[r].prototype),i.prototype.__mixin__=n[r],e=i}return e}(f,l));var p=u.klassName||"",g=new Function("return function "+p+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return g.prototype=Object.create(f.prototype),g.prototype.constructor=g,g.superclass=c,g.__proto__=f,g._constructor||(g._constructor=t),l&&(g.__mixins__=l),g.partial||(g.partial=function(t,n){return function(t,n,r){var i=t.prototype,o=t.superclass.prototype,a=r&&r.noOverrided;r&&r.overrides;for(var s in n)if("constructor"!==s){var u=n[s];"function"==typeof n[s]?i[s]=u._constructor||a||"function"!=typeof o[s]?u:function(t,n,e){return function(){var t=this.overrided;this.overrided=e;var r=n.apply(this,arguments);return this.overrided=t,r}}(0,u,o[s]):e.isPlainObject(u)&&null!==u&&u.get?Object.defineProperty(i,s,u):i[s]=u}return t}(this,t,n)}),g.inherit||(g.inherit=function(t,e,r){return n(t,this,e,r)}),g.partial(u,h),g}}();return u}),t("skylark-langx/Evented",["./klass","./arrays","./objects","./types"],function(t,n,e,r){var i=Array.prototype.slice,o=n.compact,a=r.isDefined,s=r.isPlainObject,u=r.isFunction,c=r.isString,l=r.isEmptyObject,h=e.mixin;function f(t){var n=(""+t).split(".");return{name:n[0],ns:n.slice(1).join(" ")}}var p=t({on:function(t,n,e,r,i,o){var a=this,l=this._hub||(this._hub={});return s(t)?(i=r,each(t,function(t,r){a.on(t,n,e,r,i,o)}),this):(c(n)||u(r)||(i=r,r=e,e=n,n=void 0),u(e)&&(i=r,r=e,e=null),c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var a=f(t),s=a.name,u=a.ns;(l[s]||(l[s]=[])).push({fn:r,selector:n,data:e,ctx:i,ns:u,one:o})}),this)},one:function(t,n,e,r,i){return this.on(t,n,e,r,i,1)},trigger:function(t){if(!this._hub)return this;var n=this;c(t)&&(t=new CustomEvent(t)),Object.defineProperty(t,"target",{value:this});var e=i.call(arguments,1);return e=a(e)?[t].concat(e):[t],[t.type||t.name,"all"].forEach(function(r){var i=f(r),a=i.name,s=i.ns,u=n._hub[a];if(u){for(var c=u.length,l=!1,p=0;p<c;p++){var g=u[p];(!s||g.ns&&g.ns.startsWith(s))&&(t.data?g.data&&(t.data=h({},g.data,t.data)):t.data=g.data||null,g.fn.apply(g.ctx,e),g.one&&(u[p]=null,l=!0))}l&&(n._hub[r]=o(u))}}),this},listened:function(t){var n=(this._hub||(this._events={}))[t]||[];return n.length>0},listenTo:function(t,n,e,r){if(!t)return this;c(e)&&(e=this[e]),r?t.one(n,e,this):t.on(n,e,this);for(var i,o=this._listeningTo||(this._listeningTo=[]),a=0;a<o.length;a++)if(o[a].obj==t){i=o[a];break}i||o.push(i={obj:t,events:{}});var s=i.events,u=s[n]=s[n]||[];return-1==u.indexOf(e)&&u.push(e),this},listenToOnce:function(t,n,e){return this.listenTo(t,n,e,1)},off:function(t,n){var e=this._hub||(this._hub={});return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var r=f(t),i=r.name,o=r.ns,a=e[i];if(a){var s=[];if(n||o)for(var u=0,c=a.length;u<c;u++)n&&a[u].fn!==n&&a[u].fn._!==n?s.push(a[u]):!o||a[u].ns&&0==a[u].ns.indexOf(o)||s.push(a[u]);s.length?e[i]=s:delete e[i]}}),this},unlistenTo:function(t,n,e){var r=this._listeningTo;if(!r)return this;for(var i=0;i<r.length;i++){var a=r[i];if(!t||t==a.obj){var s=a.events;for(var u in s)if(!n||n==u){for(var c=s[u],h=0;h<c.length;h++)e&&e!=c[i]||(a.obj.off(u,c[i],this),c[i]=null);c=s[u]=o(c),l(c)&&(s[u]=null)}l(s)&&(r[i]=null)}}return r=this._listeningTo=o(r),l(r)&&(this._listeningTo=null),this}});return p}),t("skylark-data-collection/Collection",["skylark-langx/Evented","./collections"],function(t,n){var e=n.Collection=t.inherit({klassName:"Collection",_clear:function(){throw new Error("Unimplemented API")},clear:function(){return this._clear(),this.trigger("changed:clear"),this},count:function(){for(var t=0,n=this.iterator();!n.hasNext();)t++;return t},forEach:function(t,n){for(var e=this.iterator();e.hasNext();){var r=e.next();t.call(n||r,r)}return this},iterator:function(){throw new Error("Unimplemented API")},toArray:function(){for(var t=[],n=this.iterator();!n.hasNext();)t.push(n.next());return t}});return e}),t("skylark-data-collection/Map",["./collections","./Collection"],function(t,n){var e=t.Map=n.inherit({klassName:"Map",_getInnerItems:function(){return this._items},_clear:function(){this._items=[]},_findKeyByRegExp:function(t,n){var e=this._getInnerItems();return e.filter(function(e){return!!e.match(t)&&(n&&n(e),!0)})},get:function(t,n){if("string"!=typeof t)throw"hash key is not string!";var e=this._getInnerItems();return e[t]},iterator:function(){var t=0;return{hasNext:function(){return t<this._items.length},next:function(){var n=this._items[t++];return[this._items[n],n]}}},set:function(t,n){if("string"!=typeof t)throw"hash key is not string!";var e=this._getInnerItems();-1==e.indexOf(t)&&e.push(t);var r=e[t];if(r!==n){e[t]=n;var i={};i[t]={name:t,value:n,oldValue:r},this.trigger("changed",{data:i})}return this},remove:function(t){if("string"!=typeof t)throw"hash key is not string!";var n=this._getInnerItems(),e=n.indexOf(t);e>=0&&(delete n[t],delete n[e])},findByRegExp:function(t,n){var e=[],r=this;return this._findKeyByRegExp(t,function(t){var i=r.get(t);n&&n(i),e.push(i)}),e},removeByRegExp:function(t){var n=this;this._findKeyByRegExp(t,function(t){n.remove(t)})},toPlain:function(){for(var t=this._getInnerItems(),n=0;n<t.length;n++){var e=t[n];plain[e]=t[e]}return plain},toString:function(t){var n=this._getInnerItems();return n.join(t||",")},init:function(t){var n=this._items=[];for(var e in t)n.push(e),n[e]=t[e]}});return e}),t("skylark-data-collection/HashMap",["./collections","./Map"],function(t,n){var e=t.HashMap=n.inherit({});return e}),t("skylark-data-collection/List",["skylark-langx/arrays","./collections","./Collection"],function(t,n,e){var r=n.List=e.inherit({klassName:"List",_getInnerItems:function(){return this._items},_clear:function(){this._items=[]},contains:function(t){var n=this._getInnerItems();return n.indexOf(t)>=0},count:function(){var t=this._getInnerItems();return t.length},getAll:function(){return this._getInnerItems()},get:function(t){var n=this._getInnerItems();if(t<0||t>=n.length)throw new Error("Not exist:"+t);return n[t]},getRange:function(t,n){for(var e=this._getInnerItems(),r=[],i=Math.max(t,0);i<n&&!(i>=e.length);i++)r.push(e[i]);return r},indexOf:function(t){var n=this._getInnerItems();return n.indexOf(t)},iterator:function(){var t=0,n=this;return{hasNext:function(){return t<n._items.length},next:function(){return n._items[t++]}}},init:function(n){this._items=n?t.makeArray(n):[]}});return r}),t("skylark-data-collection/ArrayList",["./collections","./List"],function(t,n){var e=t.ArrayList=n.inherit({klassName:"ArrayList",add:function(t){var n=this._getInnerItems();return n.push(t),this.trigger("changed:add",{data:[{item:t,index:n.length-1,isSingle:!0}]}),this},addRange:function(t){for(var n=this._getInnerItems(),e=t.toArray?t.toArray():t,r=[],i=0;i<e.length;i++)n.push(e[i]),r.push({item:e[i],index:n.length-1});return this.trigger("changed:add",{data:r}),this},clone:function(){return new e({items:this._.items})},insert:function(t,n){var e=this._getInnerItems();if(t<0||t>e.length)throw new Error("invalid parameter!");return e.splice(t,0,n),this.trigger("changed",{data:[{item:n,index:t}]}),this},insertRange:function(t,n){var e=this._getInnerItems(),r=[];if(t<0||t>=e.length)throw new Error("invalid parameter!");for(var i=n.toArray(),o=0;o<i.length-1;o++)e.splice(t+o,0,i[o]),r.push({item:i[o],index:t+o});return this.trigger("changed:insert",{data:r}),this},removeFirstMatch:function(t){for(var n=this._getInnerItems(),e=0,r=n.length;e<r;e++)if(n[e]===t){this.removeAt(e);break}return this},remove:function(t){for(var n=this._getInnerItems(),e=[],r=0,i=n.length;r<i;r++)n[r]===t&&(Array.removeAt(n,r),e.push({item:t,index:r}));return this.trigger("changed:remove",{data:e}),this},removeAt:function(t){var n=this._getInnerItems(),e=n.splice(t,1)[0];return this.trigger("changed:remove",{data:[{item:e,index:t}]}),this},removeRange:function(t,n){for(var e=this._getInnerItems(),r=[],i=t;i<t+n;i++)r.push({item:e[i],index:i});return e.splice(t,n),this.trigger("changed:remove",{data:{removed:r}}),this},setByIndex:function(t,n){var e=this._getInnerItems();if(t<0||t>=e.length)throw new Error(""+i);var r=e[t];return e[i]=n,this.trigger("changed:update",{data:[{item:n,index:t,oldItem:r}]}),this},reset:function(t){var n=this._getInnerItems();n.length=0;for(var e=0;e<t.length;e++)n.push(t[e]);return this.trigger("changed:reset"),this},reverse:function(){var t=this._getInnerItems();return t.reverse(),this.trigger("changed:reverse"),this},sort:function(t){var n=this._getInnerItems();return t?n.sort(t):n.sort(),this.trigger("changed:sort"),this}});return e}),t("skylark-langx/funcs",["./objects","./types"],function(t,n){var e=t.mixin,r=Array.prototype.slice,i=n.isFunction,o=n.isString;var a=function(){function t(){}return function(n,r){t.prototype=n;var i=new t;return t.prototype=null,r&&e(i,r),i}}(),s={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};return{debounce:function(t,n){var e;return function(){var r=this,i=arguments;e&&clearTimeout(e),e=setTimeout(function(){e=null,t.apply(r,i)},n)}},delegate:a,defer:function(t){requestAnimationFrame?requestAnimationFrame(t):setTimeoutout(t);return this},noop:function(){},proxy:function t(n,e){var a=2 in arguments&&r.call(arguments,2);if(i(n)){return function(){return n.apply(e,a?a.concat(r.call(arguments)):arguments)}}if(o(e))return a?(a.unshift(n[e],n),t.apply(null,a)):t(n[e],n);throw new TypeError("expected function")},returnTrue:function(){return!0},returnFalse:function(){return!1},templateSettings:s,template:function(n,e,r){!e&&r&&(e=r);e=t.defaults({},e,s);var i,o=RegExp([(e.escape||noMatch).source,(e.interpolate||noMatch).source,(e.evaluate||noMatch).source].join("|")+"|$","g"),a=0,u="__p+='";n.replace(o,function(t,e,r,i,o){return u+=n.slice(a,o).replace(escapeRegExp,escapeChar),a=o+t.length,e?u+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":r?u+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(u+="';\n"+i+"\n__p+='"),t}),u+="';\n",e.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{i=new Function(e.variable||"obj","_",u)}catch(t){throw t.source=u,t}var c=function(t){return i.call(this,t,_)},l=e.variable||"obj";return c.source="function("+l+"){\n"+u+"}",c}}}),t("skylark-langx/Deferred",["./arrays","./funcs","./objects"],function(t,n,e){"use strict";var r=Symbol?Symbol():"__pglisteners",i=Symbol?Symbol():"__pgnotifies",o=Array.prototype.slice,a=n.proxy,s=t.makeArray,u=e.result,c=e.mixin;c(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(){for(var t=0;t<arguments.length;t++)this.then(arguments[t]);return this},fail:function(t){return this.catch(t),this}});var l=function(){var t=this,n=this.promise=new Promise(function(n,e){t._resolve=n,t._reject=e});h(n,t),this[r]=[],this[i]=[]};function h(t,n){var e={state:function(){return n.isResolved()?"resolved":n.isRejected()?"rejected":"pending"},then:function(t,n,e){return e&&this.progress(e),h(Promise.prototype.then.call(this,t&&function(n){return n&&void 0!==n.__ctx__?t.apply(n.__ctx__,n):t(n)},n&&function(t){return t&&void 0!==t.__ctx__?n.apply(t.__ctx__,t):n(t)}))},progress:function(t){return n[i].forEach(function(n){t(n)}),n[r].push(t),this}};return e.pipe=e.then,c(t,e)}return l.prototype.resolve=function(t){var n=o.call(arguments);return this.resolveWith(null,n)},l.prototype.resolveWith=function(t,n){return(n=n?s(n):[]).__ctx__=t,this._resolve(n),this._resolved=!0,this},l.prototype.notify=function(t){try{return this[i].push(t),this[r].forEach(function(n){return n(t)})}catch(t){this.reject(t)}return this},l.prototype.reject=function(t){var n=o.call(arguments);return this.rejectWith(null,n)},l.prototype.rejectWith=function(t,n){return(n=n?s(n):[]).__ctx__=t,this._reject(n),this._rejected=!0,this},l.prototype.isResolved=function(){return!!this._resolved},l.prototype.isRejected=function(){return!!this._rejected},l.prototype.then=function(t,n,e){var r=u(this,"promise");return r.then(t,n,e)},l.prototype.progress=function(t){var n=u(this,"promise");return n.progress(t)},l.prototype.catch=function(t){var n=u(this,"promise");return n.catch(t)},l.prototype.done=function(){var t=u(this,"promise");return t.done.apply(t,arguments)},l.prototype.fail=function(t){var n=u(this,"promise");return n.fail(t)},l.all=function(t){var n=new l;return Promise.all(t).then(n.resolve.bind(n),n.reject.bind(n)),u(n,"promise")},l.first=function(t){return h(Promise.race(t))},l.when=function(t,n,e,r){var i=t&&"function"==typeof t.then,o=i&&t instanceof Promise;if(!i)return arguments.length>1?n?n(t):t:(new l).resolve(t);if(!o){var s=new l(t.cancel);t.then(a(s.resolve,s),a(s.reject,s),s.notify),t=s.promise}return n||e||r?t.then(n,e,r):t},l.reject=function(t){var n=new l;return n.reject(t),n.promise},l.immediate=l.resolve=function(t){var n=new l;return n.resolve.apply(n,arguments),n.promise},l}),t("skylark-data-collection/PagedList",["skylark-langx/types","skylark-langx/Deferred","./collections","./Collection"],function(t,n,e,r){var i=e.PagedList=r.inherit({klassName:"PagedList",_options:null,_cachePageData:function(t,n){var e=this._pages,r=this._count,i=(t-1)*this.pageSize+n.length;e[t]=n,this.trigger("changed:cache",{data:{pageNo:t,pageItems:n}}),i>OldLen&&(this._count=i,this.trigger("changed:count",{data:{count:i,oldCount:r}}))},_getPageData:function(t){for(var n=this._getInnerItems(),e=[],r=this.pageSize,i=(t-1)*r,o=n.length,a=0;a<r&&i<o;a++,i++)n[i]&&e.push(n[i]);return e},_laodPageData:function(t){var e=this._options.loadData;return pageSize=this.pageSize,from=(t-1)*pageSize,deferred=new n,self=this,e(from,pageSize).then(function(n){self._cachePageData(t,n),deferred.resolve(n)},function(t){deferred.reject(t)}),deferred.promise},pageSize:{get:function(){return this._pageSize}},totalCount:{get:function(){return this._options&&(this._endless._options||1/0)}},totalPageCount:{get:function(){return Math.ceil(this.totalCount/this.pageSize)}},count:{get:function(){return this._count}},pageCount:{get:function(){return Math.ceil(this.count/this.pageSize)}},hasMore:function(){return this.count<this.totalCount},loadMore:function(){return this._laodPageData(this.pageCount)},getPage:function(t,n){return this._getPageData(t)},fetchPage:function(t){var e=this._getPageData(t);return e?n.when(items):this._laodPageData(t)},init:function(t,n){this._pages={},this._count=0,this._options=n}});return i}),t("skylark-data-collection/Queue",["./collections","./List"],function(t,n){var e=t.Queue=n.inherit({klassName:"Queue",clone:function(t){var n=this._getInnerItems();return new e({items:n})},dequeue:function(){var t=this._getInnerItems(),n=t.shift();return this.trigger("changed:dequeue",{data:n}),n},enqueue:function(t){var n=this._getInnerItems();return n.push(t),this.trigger("changed:enqueue",{data:t}),this}});return e}),t("skylark-data-collection/Set",["skylark-langx/arrays","./collections","./Collection"],function(t,n,e){var r=n.Set=e.inherit({klassName:"Set",clone:function(){return new r({items:this._.items})},difference:function(t){for(var n=[],e=this._getInnerItems(),i=0;i<e.length;i++){var o=e[i];t.contains(o)||n.push(o)}return new r(n)},exclude:function(t){var n=this._.items,e=n.indexOf(t);e>=0&&(n.splice(e,1),this.trigger("changed:exclude",{data:[t]}))},include:function(t){var n=this._.items;n.indexOf(t)<0&&(n.push(t),this.trigger("changed:include",{data:[t]}))},iterator:function(){var t=0;return{hasNext:function(){return t<this._items.length},next:function(){return this._items[t++]}}},intersection:function(t){for(var n=[],e=this._getInnerItems(),i=0;i<e.length;i++){var o=e[i];t.contains(o)&&n.push(o)}return new r(n)},isSubSet:function(t){for(var n=this._getInnerItems(),e=0;e<n.length;e++){var r=n[e];if(!t.contains(r))return!1}return!0},isSuperSet:function(t){return t.isSubSet(this)},union:function(t,n){for(var e=n.clone(),r=this._getInnerItems(),i=0;i<r.length;i++)e.include(r[i]);return e},init:function(n){this._items=n?t.makeArray(n):[]}});return r}),t("skylark-data-collection/Stack",["./collections","./List"],function(t,n){var e=t.Stack=n.inhert({klassName:"Stack",clone:function(){var t=this._getInnerItems();return new e(t)},peek:function(){var t=this._getInnerItems(),n=t.length-1;return n>-1?t[n]:null},pop:function(){var t=this._getInnerItems(),n=null;return t.length>0&&(n=t.pop(),this.trigger("changed:pop",{data:n})),n},push:function(t){var n=this._getInnerItems();return n.push(t),this.trigger("changed:push",{data:t}),this}});return e}),t("skylark-data-collection/TreeItem",["skylark-langx/arrays","skylark-langx/Evented","./collections"],function(t,n,e){var r=e.TreeItem=n.inherit({klassName:"TreeItem",_internalChildren:function(n){var e=this._.children;return n?t.makeArray(e):e},_checkPublicOperation:function(t){return!0},_internalSetParent:function(t){this._.parent=t},_internalAddChild:function(t,n){var e=this._internalCreateItem(t),r=this._internalChildren();return r&&(void 0===n?r.push(e):r.insert(n,e)),e._internalSetParent(this),e},_internalRemoveChildAt:function(t){var n=this._internalChildren(),e=n.splice(t,1);e._internalSetParent(null)},_internalClearChildren:function(){var t=this._internalChildren();if(t){for(var n=0;n<t.length;n++)t[n]._internalSetParent(null);t.length=0}},_internalCreateItem:function(t){var n=this.root,e=n?n.createItem(t):t;return e},name:{get:function(){return this._.name}},data:{get:function(){return this._.data}},children:{type:Array,getter:function(){return this._internalChildren(!0)}},firstChild:{get:function(){var t=this._internalChildren();return t&&t[0]}},fullPath:{get:function(){for(var t=this.name,n=this.parent;n;)t=n.name+"/"+t,n=n.parent;return t}},lastChild:{get:function(){var t=this._internalChildren();return t&&t[t.length-1]}},lastDescendants:{get:function(){for(var t=this.lastChild,n=t.lastChild;n;)n=(t=n).lastChild;return t}},level:{get:function(){for(var t=0,n=this.parent;n;)t++,n=n.parent;return t}},next:{get:function(){var t=this.firstChild;if(!t)for(var n=this,e=n.parent;e&&!(t=e.getNextChild(n));)e=(n=e).parent;return t}},nextSibling:{get:function(){var t=this.parent;return t&&t.getNextChild(this)}},parent:{get:function(){return this._.parent}},prev:{get:function(){var t,n=this.prevSibling;return n?(t=n.lastDescendants)||(t=n):t=this.parent,t}},prevSibling:{get:function(){var t=this.parent;return t&&t.getPrevChild(this)}},root:{get:function(){for(var t=this;t.parent;)t=t.parent;return t}},prependChild:function(t){return this.addChild(t,0)},addChild:function(t,n){this._checkPublicOperation("addChild");var e=this._internalAddChild(t,n);return this.trigger("changed:addChild",{data:[{item:e,index:n,isSingle:!0}]}),this},appendChild:function(t){return this.addChild(this)},canHaveChildren:function(){var t=this._internalChildren();return void 0!==t},childrenCount:function(){var t=this._internalChildren();return t?t.length:0},clearChildren:function(){return this._checkPublicOperation("clearChildren"),this._internalClearChildren(),this.trigger("changed:clearChildren"),this},getChildAt:function(t){var n=this._internalChildren();return n[t]},getChildren:function(){return this.children},getPrevChild:function(t){var n=this._internalChildren(),e=n.indexOf(t);return e>0?n[e-1]:null},getNextChild:function(t){var n=this._internalChildren(),e=n.indexOf(t);return e>=0&&e<n.length-1?n[e+1]:null},hasChildren:function(){var t=this._internalChildren();return t&&t.length>0},indexOfChild:function(t){var n=this._internalChildren();return n.indexOf(t)},insertChild:function(t,n){return this.addChild(item,n)},parents:function(){for(var t=[],n=this.parent;n;)t.push(n),n=n.parent;return t},remove:function(){var t=this.parent;t&&t.removeChild(this)},removeChild:function(t){var n=this.indexOfChild(t);if(n>-1)return this.removeChildAt(n)},removeChildAt:function(t){this._checkPublicOperation("removeChild"),this._internalRemoveChildAt(t),this.trigger("changed:removeChild",{data:[{item:item,index:t}]})},init:function(t){var n=this._={};n.data=t,n.name=t.name,n.children=[]}});return r}),t("skylark-data-collection/Tree",["./collections","./Collection","./ArrayList","./TreeItem"],function(t,n,e,r){var i=t.Tree=n.inherit({createItem:function(t){return new i.TreeItem(t)},items:{get:function(){return this.toArray()}},iterator:function(){var t=this.firstItem();return{hasNext:function(){return t},next:function(){if(t){var n=t;return t=n.next,n}}}},count:function(){var t=0;return this.forEach(function(n){t+=1}),t},firstItem:function(){var t=this._.children;return t&&t.length?t[0]:null},lastItem:function(){var t=function(n,e){var r=n.children;return r&&r.length?t(r[r.length-1],!1):e?null:n};return t(item,!0)},init:function(){this._.children=[]}});return i.TreeItem=r,i}),t("skylark-data-collection/main",["./collections","./Collection","./HashMap","./List","./Map","./ArrayList","./PagedList","./Queue","./Set","./Stack","./Tree","./TreeItem"],function(t){return t}),t("skylark-data-collection",["skylark-data-collection/main"],function(t){return t})}(e),!o){var u=r("skylark-langx/skylark");a?module.exports=u:n.skylarkjs=u}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-data-collection-all.js.map
