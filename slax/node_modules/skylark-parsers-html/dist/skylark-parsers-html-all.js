/**
 * skylark-parsers-html - The html features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){var n=e.define,require=e.require,i="function"==typeof n&&n.amd,r=!i&&"undefined"!=typeof exports;if(!i&&!n){var s={};n=e.define=function(t,e,n){"function"==typeof n?(s[t]={factory:n,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var n=e.split("/"),i=t.split("/");n.pop();for(var r=0;r<i.length;r++)"."!=i[r]&&(".."==i[r]?n.pop():n.push(i[r]));return n.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):s[t]={factory:null,resolved:!0,exports:n}},require=e.require=function(t){if(!s.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=s[t];if(!module.resolved){var n=[];module.deps.forEach(function(t){n.push(require(t))}),module.exports=module.factory.apply(e,n)||null,module.resolved=!0}return module.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-langx-ns/_attach",[],function(){return function(t,e,n){"string"==typeof e&&(e=e.split("."));for(var i=e.length,r=t,s=0,a=e[s++];s<i;)r=r[a]=r[a]||{},a=e[s++];return r[a]=n}}),t("skylark-langx-ns/ns",["./_attach"],function(t){var e={attach:function(n,i){return t(e,n,i)}};return e}),t("skylark-langx-ns/main",["./ns"],function(t){return t}),t("skylark-langx-ns",["skylark-langx-ns/main"],function(t){return t}),t("skylark-langx/skylark",["skylark-langx-ns"],function(t){return t}),t("skylark-parsers-html/html",["skylark-langx/skylark"],function(t){return t.attach("domx.html",{})}),t("skylark-parsers-css/css",["skylark-langx/skylark"],function(t){return t.attach("markups.css",{})}),t("skylark-parsers-css/primitives/beautify-css",[],function(){function t(e,n){var i=(n=n||{}).indent_size||4,r=n.indent_char||" ",s=void 0===n.selector_separator_newline||n.selector_separator_newline,a=void 0!==n.end_with_newline&&n.end_with_newline;"string"==typeof i&&(i=parseInt(i,10));var _,o=/^\s+$/,l=-1;function h(){return(_=e.charAt(++l))||""}function c(t){var n=l;return t&&f(),result=e.charAt(l+1)||"",l=n-1,h(),result}function u(t){for(var n=l;h();)if("\\"===_)h();else{if(-1!==t.indexOf(_))break;if("\n"===_)break}return e.substring(n,l+1)}function p(t){var e=l,n=u(t);return l=e-1,h(),n}function f(){for(var t="";o.test(c());)h(),t+=_;return t}function d(){var t="";for(_&&o.test(_)&&(t=_);o.test(h());)t+=_;return t}function T(t){var n=l,t="/"===c();for(h();h();){if(!t&&"*"===_&&"/"===c()){h();break}if(t&&"\n"===_)return e.substring(n,l)}return e.substring(n,l)+_}function E(t){return e.substring(l-t.length,l).toLowerCase()===t}function g(){for(var t=l+1;t<e.length;t++){var n=e.charAt(t);if("{"===n)return!0;if(";"===n||"}"===n||")"===n)return!1}return!1}var x=e.match(/^[\t ]*/)[0],m=new Array(i+1).join(r),k=0,y=0;function K(){k++,x+=m}function R(){k--,x=x.slice(0,-i)}var v={"{":function(t){v.singleSpace(),b.push(t),v.newLine()},"}":function(t){v.newLine(),b.push(t),v.newLine()},_lastCharWhitespace:function(){return o.test(b[b.length-1])},newLine:function(t){t||v.trim(),b.length&&b.push("\n"),x&&b.push(x)},singleSpace:function(){b.length&&!v._lastCharWhitespace()&&b.push(" ")},trim:function(){for(;v._lastCharWhitespace();)b.pop()}},b=[];x&&b.push(x);for(var w=!1,A=!1,S="",O="";;){var N=d(),D=""!==N,C=-1!==N.indexOf("\n"),O=S,S=_;if(!_)break;if("/"===_&&"*"===c()){var L=E("");v.newLine(),b.push(T()),v.newLine(),L&&v.newLine(!0)}else if("/"===_&&"/"===c())C||"{"===O||v.trim(),v.singleSpace(),b.push(T()),v.newLine();else if("@"===_){D&&v.singleSpace(),b.push(_);var I=p(": ,;{}()[]/='\"").replace(/\s$/,"");I in t.NESTED_AT_RULE?(y+=1,I in t.CONDITIONAL_GROUP_RULE&&(A=!0)):": ".indexOf(I[I.length-1])>=0&&(h(),I=u(": ").replace(/\s$/,""),b.push(I),v.singleSpace())}else"{"===_?"}"===c(!0)?(f(),h(),v.singleSpace(),b.push("{}")):(K(),v["{"](_),A?(A=!1,w=k>y):w=k>=y):"}"===_?(R(),v["}"](_),w=!1,y&&y--):":"===_?(f(),!w&&!A||E("&")||g()?":"===c()?(h(),b.push("::")):b.push(":"):(b.push(":"),v.singleSpace())):'"'===_||"'"===_?(D&&v.singleSpace(),b.push(u(_))):";"===_?(b.push(_),v.newLine()):"("===_?E("url")?(b.push(_),f(),h()&&(")"!==_&&'"'!==_&&"'"!==_?b.push(u(")")):l--)):(D&&v.singleSpace(),b.push(_),f()):")"===_?b.push(_):","===_?(b.push(_),f(),!w&&s?v.newLine():v.singleSpace()):"]"===_?b.push(_):"["===_?(D&&v.singleSpace(),b.push(_)):"="===_?(f(),b.push(_)):(D&&v.singleSpace(),b.push(_))}var j=b.join("").replace(/[\r\n\t ]+$/,"");return a&&(j+="\n"),j}return t.NESTED_AT_RULE={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},t.CONDITIONAL_GROUP_RULE={"@media":!0,"@supports":!0,"@document":!0},{css_beautify:t}}),t("skylark-parsers-css/beautify",["./css","./primitives/beautify-css"],function(t,e){return t.beautify=e.css_beautify}),t("skylark-parsers-javascript/js",["skylark-langx/skylark"],function(t){return t.attach("scripts.js",{})}),t("skylark-parsers-javascript/primitives/beautify-js",[],function(){var exports,t,e,n,i={};function r(t,e){for(var n=0;n<e.length;n+=1)if(e[n]===t)return!0;return!1}function s(t){return t.replace(/^\s+|\s+$/g,"")}exports=i,t="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",e=new RegExp("["+t+"]"),n=new RegExp("["+t+"̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿]"),exports.newline=/[\n\r\u2028\u2029]/,exports.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&e.test(String.fromCharCode(t)))},exports.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&n.test(String.fromCharCode(t))))};var a={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};function _(t,e){"use strict";var n,i,_,o,h,c,u,p,f,d,T,E,g,x=[],m="";function k(t,e){var i=0;t&&(i=t.indentation_level,!n.just_added_newline()&&t.line_indent_level>i&&(i=t.line_indent_level));var r={mode:e,parent:t,last_text:t?t.last_text:"",last_word:t?t.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:i,line_indent_level:t?t.line_indent_level:i,start_line_index:n.get_line_number(),ternary_depth:0};return r}for(E={TK_START_EXPR:function(){C();var t=a.Expression;if("["===o.text){if("TK_WORD"===h||")"===p.last_text)return"TK_RESERVED"===h&&r(p.last_text,_.line_starters)&&(n.space_before_token=!0),A(t),b(),w(),void(g.space_in_paren&&(n.space_before_token=!0));t=a.ArrayLiteral,S(p.mode)&&("["!==p.last_text&&(","!==p.last_text||"]"!==c&&"}"!==c)||g.keep_array_indentation||v())}else"TK_RESERVED"===h&&"for"===p.last_text?t=a.ForInitializer:"TK_RESERVED"===h&&r(p.last_text,["if","while"])&&(t=a.Conditional);";"===p.last_text||"TK_START_BLOCK"===h?v():"TK_END_EXPR"===h||"TK_START_EXPR"===h||"TK_END_BLOCK"===h||"."===p.last_text?R(o.wanted_newline):"TK_RESERVED"===h&&"("===o.text||"TK_WORD"===h||"TK_OPERATOR"===h?"TK_RESERVED"===h&&("function"===p.last_word||"typeof"===p.last_word)||"*"===p.last_text&&"function"===c?g.space_after_anon_function&&(n.space_before_token=!0):"TK_RESERVED"!==h||!r(p.last_text,_.line_starters)&&"catch"!==p.last_text||g.space_before_conditional&&(n.space_before_token=!0):n.space_before_token=!0;"("===o.text&&("TK_EQUALS"!==h&&"TK_OPERATOR"!==h||D()||R());A(t),b(),g.space_in_paren&&(n.space_before_token=!0);w()},TK_END_EXPR:function(){for(;p.mode===a.Statement;)N();p.multiline_frame&&R("]"===o.text&&S(p.mode)&&!g.keep_array_indentation);g.space_in_paren&&("TK_START_EXPR"!==h||g.space_in_empty_paren?n.space_before_token=!0:(n.trim(),n.space_before_token=!1));"]"===o.text&&g.keep_array_indentation?(b(),N()):(N(),b());n.remove_redundant_indentation(f),p.do_while&&f.mode===a.Conditional&&(f.mode=a.Expression,p.do_block=!1,p.do_while=!1)},TK_START_BLOCK:function(){var t=I(1),e=I(2);e&&(":"===e.text&&r(t.type,["TK_STRING","TK_WORD","TK_RESERVED"])||r(t.text,["get","set"])&&r(e.type,["TK_WORD","TK_RESERVED"]))?r(c,["class","interface"])?A(a.BlockStatement):A(a.ObjectLiteral):A(a.BlockStatement);var i=!t.comments_before.length&&"}"===t.text&&"function"===p.last_word&&"TK_END_EXPR"===h;"expand"===g.brace_style||"none"===g.brace_style&&o.wanted_newline?"TK_OPERATOR"!==h&&(i||"TK_EQUALS"===h||"TK_RESERVED"===h&&L(p.last_text)&&"else"!==p.last_text)?n.space_before_token=!0:v(!1,!0):"TK_OPERATOR"!==h&&"TK_START_EXPR"!==h?"TK_START_BLOCK"===h?v():n.space_before_token=!0:S(f.mode)&&","===p.last_text&&("}"===c?n.space_before_token=!0:v());b(),w()},TK_END_BLOCK:function(){for(;p.mode===a.Statement;)N();var t="TK_START_BLOCK"===h;"expand"===g.brace_style?t||v():t||(S(p.mode)&&g.keep_array_indentation?(g.keep_array_indentation=!1,v(),g.keep_array_indentation=!0):v());N(),b()},TK_WORD:j,TK_RESERVED:j,TK_SEMICOLON:function(){C()&&(n.space_before_token=!1);for(;p.mode===a.Statement&&!p.if_block&&!p.do_block;)N();b()},TK_STRING:function(){C()?n.space_before_token=!0:"TK_RESERVED"===h||"TK_WORD"===h?n.space_before_token=!0:"TK_COMMA"===h||"TK_START_EXPR"===h||"TK_EQUALS"===h||"TK_OPERATOR"===h?D()||R():v();b()},TK_EQUALS:function(){C();p.declaration_statement&&(p.declaration_assignment=!0);n.space_before_token=!0,b(),n.space_before_token=!0},TK_OPERATOR:function(){C();if("TK_RESERVED"===h&&L(p.last_text))return n.space_before_token=!0,void b();if("*"===o.text&&"TK_DOT"===h)return void b();if(":"===o.text&&p.in_case)return p.case_body=!0,w(),b(),v(),void(p.in_case=!1);if("::"===o.text)return void b();!o.wanted_newline||"--"!==o.text&&"++"!==o.text||v(!1,!0);"TK_OPERATOR"===h&&R();var t=!0,e=!0;r(o.text,["--","++","!","~"])||r(o.text,["-","+"])&&(r(h,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||r(p.last_text,_.line_starters)||","===p.last_text)?(t=!1,e=!1,";"===p.last_text&&O(p.mode)&&(t=!0),"TK_RESERVED"===h||"TK_END_EXPR"===h?t=!0:"TK_OPERATOR"===h&&(t=r(o.text,["--","-"])&&r(p.last_text,["--","-"])||r(o.text,["++","+"])&&r(p.last_text,["++","+"])),p.mode!==a.BlockStatement&&p.mode!==a.Statement||"{"!==p.last_text&&";"!==p.last_text||v()):":"===o.text?0===p.ternary_depth?t=!1:p.ternary_depth-=1:"?"===o.text?p.ternary_depth+=1:"*"===o.text&&"TK_RESERVED"===h&&"function"===p.last_text&&(t=!1,e=!1);n.space_before_token=n.space_before_token||t,b(),n.space_before_token=e},TK_COMMA:function(){if(p.declaration_statement)return O(p.parent.mode)&&(p.declaration_assignment=!1),b(),void(p.declaration_assignment?(p.declaration_assignment=!1,v(!1,!0)):n.space_before_token=!0);b(),p.mode===a.ObjectLiteral||p.mode===a.Statement&&p.parent.mode===a.ObjectLiteral?(p.mode===a.Statement&&N(),v()):n.space_before_token=!0},TK_BLOCK_COMMENT:function(){var t,e=function(t){var e=[],n=(t=t.replace(/\x0d/g,"")).indexOf("\n");for(;-1!==n;)e.push(t.substring(0,n)),t=t.substring(n+1),n=t.indexOf("\n");t.length&&e.push(t);return e}(o.text),i=!1,r=!1,a=o.whitespace_before,_=a.length;v(!1,!0),e.length>1&&(!function(t,e){for(var n=0;n<t.length;n++){var i=s(t[n]);if(i.charAt(0)!==e)return!1}return!0}(e.slice(1),"*")?function(t,e){for(var n,i=0,r=t.length;i<r;i++)if((n=t[i])&&0!==n.indexOf(e))return!1;return!0}(e.slice(1),a)&&(r=!0):i=!0);for(b(e[0]),t=1;t<e.length;t++)v(!1,!0),i?b(" "+s(e[t])):r&&e[t].length>_?b(e[t].substring(_)):n.add_token(e[t]);v(!1,!0)},TK_INLINE_COMMENT:function(){n.space_before_token=!0,b(),n.space_before_token=!0},TK_COMMENT:function(){o.wanted_newline?v(!1,!0):n.trim(!0);n.space_before_token=!0,b(),v(!1,!0)},TK_DOT:function(){C();"TK_RESERVED"===h&&L(p.last_text)?n.space_before_token=!0:R(")"===p.last_text&&g.break_chained_methods);b()},TK_UNKNOWN:function(){b(),"\n"===o.text[o.text.length-1]&&v()},TK_EOF:function(){for(;p.mode===a.Statement;)N()}},g={},void 0!==(e=e||{}).braces_on_own_line&&(g.brace_style=e.braces_on_own_line?"expand":"collapse"),g.brace_style=e.brace_style?e.brace_style:g.brace_style?g.brace_style:"collapse","expand-strict"===g.brace_style&&(g.brace_style="expand"),g.indent_size=e.indent_size?parseInt(e.indent_size,10):4,g.indent_char=e.indent_char?e.indent_char:" ",g.preserve_newlines=void 0===e.preserve_newlines||e.preserve_newlines,g.break_chained_methods=void 0!==e.break_chained_methods&&e.break_chained_methods,g.max_preserve_newlines=void 0===e.max_preserve_newlines?0:parseInt(e.max_preserve_newlines,10),g.space_in_paren=void 0!==e.space_in_paren&&e.space_in_paren,g.space_in_empty_paren=void 0!==e.space_in_empty_paren&&e.space_in_empty_paren,g.jslint_happy=void 0!==e.jslint_happy&&e.jslint_happy,g.space_after_anon_function=void 0!==e.space_after_anon_function&&e.space_after_anon_function,g.keep_array_indentation=void 0!==e.keep_array_indentation&&e.keep_array_indentation,g.space_before_conditional=void 0===e.space_before_conditional||e.space_before_conditional,g.unescape_strings=void 0!==e.unescape_strings&&e.unescape_strings,g.wrap_line_length=void 0===e.wrap_line_length?0:parseInt(e.wrap_line_length,10),g.e4x=void 0!==e.e4x&&e.e4x,g.end_with_newline=void 0!==e.end_with_newline&&e.end_with_newline,g.jslint_happy&&(g.space_after_anon_function=!0),e.indent_with_tabs&&(g.indent_char="\t",g.indent_size=1),u="";g.indent_size>0;)u+=g.indent_char,g.indent_size-=1;var y=0;if(t&&t.length){for(;" "===t.charAt(y)||"\t"===t.charAt(y);)m+=t.charAt(y),y+=1;t=t.substring(y)}function K(t){var e=t.newlines,n=g.keep_array_indentation&&S(p.mode);if(n)for(i=0;i<e;i+=1)v(i>0);else if(g.max_preserve_newlines&&e>g.max_preserve_newlines&&(e=g.max_preserve_newlines),g.preserve_newlines&&t.newlines>1){v();for(var i=1;i<e;i+=1)v(!0)}E[(o=t).type]()}function R(t){if(t=void 0!==t&&t,!n.just_added_newline())if(g.preserve_newlines&&o.wanted_newline||t)v(!1,!0);else if(g.wrap_line_length){var e=n.current_line.get_character_count()+o.text.length+(n.space_before_token?1:0);e>=g.wrap_line_length&&v(!1,!0)}}function v(t,e){if(!e&&";"!==p.last_text&&","!==p.last_text&&"="!==p.last_text&&"TK_OPERATOR"!==h)for(;p.mode===a.Statement&&!p.if_block&&!p.do_block;)N();n.add_new_line(t)&&(p.multiline_frame=!0)}function b(t){t=t||o.text,n.just_added_newline()&&(g.keep_array_indentation&&S(p.mode)&&o.wanted_newline?(n.current_line.push(o.whitespace_before),n.space_before_token=!1):n.set_indent(p.indentation_level)&&(p.line_indent_level=p.indentation_level)),n.add_token(t)}function w(){p.indentation_level+=1}function A(t){p?(d.push(p),f=p):f=k(null,t),p=k(f,t)}function S(t){return t===a.ArrayLiteral}function O(t){return r(t,[a.Expression,a.ForInitializer,a.Conditional])}function N(){d.length>0&&(f=p,p=d.pop(),f.mode===a.Statement&&n.remove_redundant_indentation(f))}function D(){return p.parent.mode===a.ObjectLiteral&&p.mode===a.Statement&&(":"===p.last_text&&0===p.ternary_depth||"TK_RESERVED"===h&&r(p.last_text,["get","set"]))}function C(){return!!("TK_RESERVED"===h&&r(p.last_text,["var","let","const"])&&"TK_WORD"===o.type||"TK_RESERVED"===h&&"do"===p.last_text||"TK_RESERVED"===h&&"return"===p.last_text&&!o.wanted_newline||"TK_RESERVED"===h&&"else"===p.last_text&&("TK_RESERVED"!==o.type||"if"!==o.text)||"TK_END_EXPR"===h&&(f.mode===a.ForInitializer||f.mode===a.Conditional)||"TK_WORD"===h&&p.mode===a.BlockStatement&&!p.in_case&&"--"!==o.text&&"++"!==o.text&&"TK_WORD"!==o.type&&"TK_RESERVED"!==o.type||p.mode===a.ObjectLiteral&&(":"===p.last_text&&0===p.ternary_depth||"TK_RESERVED"===h&&r(p.last_text,["get","set"])))&&(A(a.Statement),w(),"TK_RESERVED"===h&&r(p.last_text,["var","let","const"])&&"TK_WORD"===o.type&&(p.declaration_statement=!0),D()||R("TK_RESERVED"===o.type&&r(o.text,["do","for","if","while"])),!0)}function L(t){return r(t,["case","return","do","if","throw","else"])}function I(t){var e=i+(t||0);return e<0||e>=x.length?null:x[e]}function j(){if("TK_RESERVED"===o.type&&p.mode!==a.ObjectLiteral&&r(o.text,["set","get"])&&(o.type="TK_WORD"),"TK_RESERVED"===o.type&&p.mode===a.ObjectLiteral){var t=I(1);":"==t.text&&(o.type="TK_WORD")}if(C()||!o.wanted_newline||O(p.mode)||"TK_OPERATOR"===h&&"--"!==p.last_text&&"++"!==p.last_text||"TK_EQUALS"===h||!g.preserve_newlines&&"TK_RESERVED"===h&&r(p.last_text,["var","let","const","set","get"])||v(),p.do_block&&!p.do_while){if("TK_RESERVED"===o.type&&"while"===o.text)return n.space_before_token=!0,b(),n.space_before_token=!0,void(p.do_while=!0);v(),p.do_block=!1}if(p.if_block)if(p.else_block||"TK_RESERVED"!==o.type||"else"!==o.text){for(;p.mode===a.Statement;)N();p.if_block=!1,p.else_block=!1}else p.else_block=!0;if("TK_RESERVED"===o.type&&("case"===o.text||"default"===o.text&&p.in_case_statement))return v(),(p.case_body||g.jslint_happy)&&(p.indentation_level>0&&(!p.parent||p.indentation_level>p.parent.indentation_level)&&(p.indentation_level-=1),p.case_body=!1),b(),p.in_case=!0,void(p.in_case_statement=!0);if("TK_RESERVED"===o.type&&"function"===o.text&&((r(p.last_text,["}",";"])||n.just_added_newline()&&!r(p.last_text,["[","{",":","=",","]))&&(n.just_added_blankline()||o.comments_before.length||(v(),v(!0))),"TK_RESERVED"===h||"TK_WORD"===h?"TK_RESERVED"===h&&r(p.last_text,["get","set","new","return","export"])?n.space_before_token=!0:"TK_RESERVED"===h&&"default"===p.last_text&&"export"===c?n.space_before_token=!0:v():"TK_OPERATOR"===h||"="===p.last_text?n.space_before_token=!0:(p.multiline_frame||!O(p.mode)&&!S(p.mode))&&v()),"TK_COMMA"!==h&&"TK_START_EXPR"!==h&&"TK_EQUALS"!==h&&"TK_OPERATOR"!==h||D()||R(),"TK_RESERVED"===o.type&&r(o.text,["function","get","set"]))return b(),void(p.last_word=o.text);if(T="NONE","TK_END_BLOCK"===h?"TK_RESERVED"===o.type&&r(o.text,["else","catch","finally"])?"expand"===g.brace_style||"end-expand"===g.brace_style||"none"===g.brace_style&&o.wanted_newline?T="NEWLINE":(T="SPACE",n.space_before_token=!0):T="NEWLINE":"TK_SEMICOLON"===h&&p.mode===a.BlockStatement?T="NEWLINE":"TK_SEMICOLON"===h&&O(p.mode)?T="SPACE":"TK_STRING"===h?T="NEWLINE":"TK_RESERVED"===h||"TK_WORD"===h||"*"===p.last_text&&"function"===c?T="SPACE":"TK_START_BLOCK"===h?T="NEWLINE":"TK_END_EXPR"===h&&(n.space_before_token=!0,T="NEWLINE"),"TK_RESERVED"===o.type&&r(o.text,_.line_starters)&&")"!==p.last_text&&(T="else"===p.last_text||"export"===p.last_text?"SPACE":"NEWLINE"),"TK_RESERVED"===o.type&&r(o.text,["else","catch","finally"]))if("TK_END_BLOCK"!==h||"expand"===g.brace_style||"end-expand"===g.brace_style||"none"===g.brace_style&&o.wanted_newline)v();else{n.trim(!0);var e=n.current_line;"}"!==e.last()&&v(),n.space_before_token=!0}else"NEWLINE"===T?"TK_RESERVED"===h&&L(p.last_text)?n.space_before_token=!0:"TK_END_EXPR"!==h?"TK_START_EXPR"===h&&"TK_RESERVED"===o.type&&r(o.text,["var","let","const"])||":"===p.last_text||("TK_RESERVED"===o.type&&"if"===o.text&&"else"===p.last_text?n.space_before_token=!0:v()):"TK_RESERVED"===o.type&&r(o.text,_.line_starters)&&")"!==p.last_text&&v():p.multiline_frame&&S(p.mode)&&","===p.last_text&&"}"===c?v():"SPACE"===T&&(n.space_before_token=!0);b(),p.last_word=o.text,"TK_RESERVED"===o.type&&"do"===o.text&&(p.do_block=!0),"TK_RESERVED"===o.type&&"if"===o.text&&(p.if_block=!0)}h="TK_START_BLOCK",c="",n=new function(t,e){e=e||"",this.indent_cache=[e],this.baseIndentLength=e.length,this.indent_length=t.length;var n=[];this.baseIndentString=e,this.indent_string=t,this.current_line=null,this.space_before_token=!1,this.get_line_number=function(){return n.length},this.add_new_line=function(t){return(1!==this.get_line_number()||!this.just_added_newline())&&(!(!t&&this.just_added_newline())&&(this.current_line=new function(t){var e=0,n=-1,i=[],r=!0;this.set_indent=function(i){e=t.baseIndentLength+i*t.indent_length,n=i},this.get_character_count=function(){return e},this.is_empty=function(){return r},this.last=function(){return this._empty?null:i[i.length-1]},this.push=function(t){i.push(t),e+=t.length,r=!1},this.remove_indent=function(){n>0&&(n-=1,e-=t.indent_length)},this.trim=function(){for(;" "===this.last();){i.pop();e-=1}r=0===i.length},this.toString=function(){var e="";return this._empty||(n>=0&&(e=t.indent_cache[n]),e+=i.join("")),e}}(this),n.push(this.current_line),!0))},this.add_new_line(!0),this.get_code=function(){var t=n.join("\n").replace(/[\r\n\t ]+$/,"");return t},this.set_indent=function(t){if(n.length>1){for(;t>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);return this.current_line.set_indent(t),!0}return this.current_line.set_indent(0),!1},this.add_token=function(t){this.add_space_before_token(),this.current_line.push(t)},this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" "),this.space_before_token=!1},this.remove_redundant_indentation=function(t){if(!t.multiline_frame&&t.mode!==a.ForInitializer&&t.mode!==a.Conditional)for(var e=t.start_line_index,i=n.length;e<i;)n[e].remove_indent(),e++},this.trim=function(i){for(i=void 0!==i&&i,this.current_line.trim(t,e);i&&n.length>1&&this.current_line.is_empty();)n.pop(),this.current_line=n[n.length-1],this.current_line.trim()},this.just_added_newline=function(){return this.current_line.is_empty()},this.just_added_blankline=function(){if(this.just_added_newline()){if(1===n.length)return!0;var t=n[n.length-2];return t.is_empty()}return!1}}(u,m),d=[],A(a.BlockStatement),this.beautify=function(){var e,r;for(_=new l(t,g,u),x=_.tokenize(),i=0;e=I();){for(var s=0;s<e.comments_before.length;s++)K(e.comments_before[s]);K(e),c=p.last_text,h=e.type,p.last_text=e.text,i+=1}return r=n.get_code(),g.end_with_newline&&(r+="\n"),r}}var o=function(t,e,n,i,r,s){this.type=t,this.text=e,this.comments_before=[],this.newlines=n||0,this.wanted_newline=n>0,this.whitespace_before=i||"",this.parent=null};function l(t,e,n){var a="\n\r\t ".split(""),_=/[0-9]/,l="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: => <%= <% %> <?= <? ?>".split(" ");this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,yield,import,export".split(",");var h,c,u,p,f,d,T=this.line_starters.concat(["do","in","else","get","set","new","catch","finally","typeof"]);function E(){var E,g,x=[];if(h=0,c="",f>=d)return["","TK_EOF"];g=p.length?p[p.length-1]:new o("TK_START_BLOCK","{");var m=t.charAt(f);for(f+=1;r(m,a);){if("\n"===m?(h+=1,x=[]):h&&(m===n?x.push(n):"\r"!==m&&x.push(" ")),f>=d)return["","TK_EOF"];m=t.charAt(f),f+=1}if(x.length&&(c=x.join("")),_.test(m)){var k=!0,y=!0,K=_;for("0"===m&&f<d&&/[Xx]/.test(t.charAt(f))?(k=!1,y=!1,m+=t.charAt(f),f+=1,K=/[0123456789abcdefABCDEF]/):(m="",f-=1);f<d&&K.test(t.charAt(f));)m+=t.charAt(f),f+=1,k&&f<d&&"."===t.charAt(f)&&(m+=t.charAt(f),f+=1,k=!1),y&&f<d&&/[Ee]/.test(t.charAt(f))&&(m+=t.charAt(f),(f+=1)<d&&/[+-]/.test(t.charAt(f))&&(m+=t.charAt(f),f+=1),y=!1,k=!1);return[m,"TK_WORD"]}if(i.isIdentifierStart(t.charCodeAt(f-1))){if(f<d)for(;i.isIdentifierChar(t.charCodeAt(f))&&(m+=t.charAt(f),(f+=1)!==d););return"TK_DOT"===g.type||"TK_RESERVED"===g.type&&r(g.text,["set","get"])||!r(m,T)?[m,"TK_WORD"]:"in"===m?[m,"TK_OPERATOR"]:[m,"TK_RESERVED"]}if("("===m||"["===m)return[m,"TK_START_EXPR"];if(")"===m||"]"===m)return[m,"TK_END_EXPR"];if("{"===m)return[m,"TK_START_BLOCK"];if("}"===m)return[m,"TK_END_BLOCK"];if(";"===m)return[m,"TK_SEMICOLON"];if("/"===m){var R="",v=!0;if("*"===t.charAt(f)){if((f+=1)<d)for(;f<d&&("*"!==t.charAt(f)||!t.charAt(f+1)||"/"!==t.charAt(f+1))&&(m=t.charAt(f),R+=m,"\n"!==m&&"\r"!==m||(v=!1),!((f+=1)>=d)););return f+=2,v&&0===h?["/*"+R+"*/","TK_INLINE_COMMENT"]:["/*"+R+"*/","TK_BLOCK_COMMENT"]}if("/"===t.charAt(f)){for(R=m;"\r"!==t.charAt(f)&&"\n"!==t.charAt(f)&&(R+=t.charAt(f),!((f+=1)>=d)););return[R,"TK_COMMENT"]}}if("`"===m||"'"===m||'"'===m||("/"===m||e.e4x&&"<"===m&&t.slice(f-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&("TK_RESERVED"===g.type&&r(g.text,["return","case","throw","else","do","typeof","yield"])||"TK_END_EXPR"===g.type&&")"===g.text&&g.parent&&"TK_RESERVED"===g.parent.type&&r(g.parent.text,["if","while","for"])||r(g.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var b=m,w=!1,A=!1;if(E=m,"/"===b)for(var S=!1;f<d&&(w||S||t.charAt(f)!==b)&&!i.newline.test(t.charAt(f));)E+=t.charAt(f),w?w=!1:(w="\\"===t.charAt(f),"["===t.charAt(f)?S=!0:"]"===t.charAt(f)&&(S=!1)),f+=1;else if(e.e4x&&"<"===b){var O=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,N=t.slice(f-1),D=O.exec(N);if(D&&0===D.index){for(var C=D[2],L=0;D;){var I=!!D[1],j=D[2],P=!!D[D.length-1]||"![CDATA["===j.slice(0,8);if(j!==C||P||(I?--L:++L),L<=0)break;D=O.exec(N)}var V=D?D.index+D[0].length:N.length;return f+=V-1,[N.slice(0,V),"TK_STRING"]}}else for(;f<d&&(w||t.charAt(f)!==b&&("`"===b||!i.newline.test(t.charAt(f))));)E+=t.charAt(f),w?("x"!==t.charAt(f)&&"u"!==t.charAt(f)||(A=!0),w=!1):w="\\"===t.charAt(f),f+=1;if(A&&e.unescape_strings&&(E=function(t){var e,n=!1,i="",r=0,s="",a=0;for(;n||r<t.length;)if(e=t.charAt(r),r++,n){if(n=!1,"x"===e)s=t.substr(r,2),r+=2;else{if("u"!==e){i+="\\"+e;continue}s=t.substr(r,4),r+=4}if(!s.match(/^[0123456789abcdefABCDEF]+$/))return t;if((a=parseInt(s,16))>=0&&a<32){i+="x"===e?"\\x"+s:"\\u"+s;continue}if(34===a||39===a||92===a)i+="\\"+String.fromCharCode(a);else{if("x"===e&&a>126&&a<=255)return t;i+=String.fromCharCode(a)}}else"\\"===e?n=!0:i+=e;return i}(E)),f<d&&t.charAt(f)===b&&(E+=b,f+=1,"/"===b))for(;f<d&&i.isIdentifierStart(t.charCodeAt(f));)E+=t.charAt(f),f+=1;return[E,"TK_STRING"]}if("#"===m){if(0===p.length&&"!"===t.charAt(f)){for(E=m;f<d&&"\n"!==m;)m=t.charAt(f),E+=m,f+=1;return[s(E)+"\n","TK_UNKNOWN"]}var M="#";if(f<d&&_.test(t.charAt(f))){do{m=t.charAt(f),M+=m,f+=1}while(f<d&&"#"!==m&&"="!==m);return"#"===m||("["===t.charAt(f)&&"]"===t.charAt(f+1)?(M+="[]",f+=2):"{"===t.charAt(f)&&"}"===t.charAt(f+1)&&(M+="{}",f+=2)),[M,"TK_WORD"]}}if("<"===m&&"\x3c!--"===t.substring(f-1,f+3)){for(f+=3,m="\x3c!--";"\n"!==t.charAt(f)&&f<d;)m+=t.charAt(f),f++;return u=!0,[m,"TK_COMMENT"]}if("-"===m&&u&&"--\x3e"===t.substring(f-1,f+2))return u=!1,f+=2,["--\x3e","TK_COMMENT"];if("."===m)return[m,"TK_DOT"];if(r(m,l)){for(;f<d&&r(m+t.charAt(f),l)&&(m+=t.charAt(f),!((f+=1)>=d)););return","===m?[m,"TK_COMMA"]:"="===m?[m,"TK_EQUALS"]:[m,"TK_OPERATOR"]}return[m,"TK_UNKNOWN"]}this.tokenize=function(){var e,n,i;d=t.length,f=0,u=!1,p=[];for(var r=null,s=[],a=[];!n||"TK_EOF"!==n.type;){for(i=E(),e=new o(i[1],i[0],h,c);"TK_INLINE_COMMENT"===e.type||"TK_COMMENT"===e.type||"TK_BLOCK_COMMENT"===e.type||"TK_UNKNOWN"===e.type;)a.push(e),i=E(),e=new o(i[1],i[0],h,c);a.length&&(e.comments_before=a,a=[]),"TK_START_BLOCK"===e.type||"TK_START_EXPR"===e.type?(e.parent=n,r=e,s.push(e)):("TK_END_BLOCK"===e.type||"TK_END_EXPR"===e.type)&&r&&("]"===e.text&&"["===r.text||")"===e.text&&"("===r.text||"}"===e.text&&"}"===r.text)&&(e.parent=r.parent,r=s.pop()),p.push(e),n=e}return p}}return{js_beautify:function(t,e){"use strict";return new _(t,e).beautify()}}}),t("skylark-parsers-javascript/beautify",["./js","./primitives/beautify-js"],function(t,e){return t.beautify=e.js_beautify}),t("skylark-parsers-html/primitives/beautify-html",["skylark-parsers-css/beautify","skylark-parsers-javascript/beautify"],function(t,e){function n(t){return t.replace(/\s+$/g,"")}return{html_beautify:function(i,r){return function(t,e,i,r){var s,a,_,o,l,h,c,u,p,f,d;void 0!==(e=e||{}).wrap_line_length&&0!==parseInt(e.wrap_line_length,10)||void 0===e.max_char||0===parseInt(e.max_char,10)||(e.wrap_line_length=e.max_char);a=void 0!==e.indent_inner_html&&e.indent_inner_html,_=void 0===e.indent_size?4:parseInt(e.indent_size,10),o=void 0===e.indent_char?" ":e.indent_char,h=void 0===e.brace_style?"collapse":e.brace_style,l=0===parseInt(e.wrap_line_length,10)?32786:parseInt(e.wrap_line_length||250,10),c=e.unformatted||["a","span","img","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],u=void 0===e.preserve_newlines||e.preserve_newlines,p=u?isNaN(parseInt(e.max_preserve_newlines,10))?32786:parseInt(e.max_preserve_newlines,10):0,f=void 0!==e.indent_handlebars&&e.indent_handlebars,d=void 0!==e.end_with_newline&&e.end_with_newline,(s=new function(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=a,this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}},this.is_whitespace=function(t){for(;0<t.length;t++)if(!this.Utils.in_array(t.charAt(0),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var t="";if(t=this.input.charAt(this.pos),this.Utils.in_array(t,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(t,this.Utils.whitespace);)u&&"\n"===t&&this.newlines<=p&&(this.newlines+=1),this.pos++,t=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(t){this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,t),this.print_indentation(t)):(this.line_char_count++,t.push(" "))},this.get_content=function(){for(var t="",e=[];"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(e);else{if(f){var n=this.input.substr(this.pos,3);if("{{#"===n||"{{/"===n)break;if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var e="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var i=n.exec(this.input),r=i?i.index:this.input.length;return this.pos<r&&(e=this.input.substring(this.pos,r),this.pos=r),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.indent_to_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]])}},this.get_tag=function(t){var e,n,i="",r=[],s="",a=!1,_=this.pos,o=this.line_char_count;t=void 0!==t&&t;do{if(this.pos>=this.input.length)return t&&(this.pos=_,this.line_char_count=o),r.length?r.join(""):["","TK_EOF"];if(i=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(i,this.Utils.whitespace))a=!0;else{if("'"!==i&&'"'!==i||(i+=this.get_unformatted(i),a=!0),"="===i&&(a=!1),r.length&&"="!==r[r.length-1]&&">"!==i&&a&&(this.space_or_wrap(r),a=!1),f&&"<"===n&&i+this.input.charAt(this.pos)==="{{"&&(i+=this.get_unformatted("}}"),r.length&&" "!==r[r.length-1]&&"<"!==r[r.length-1]&&(i=" "+i),a=!0),"<"!==i||n||(e=this.pos-1,n="<"),f&&!n&&r.length>=2&&"{"===r[r.length-1]&&"{"==r[r.length-2]&&(e="#"===i||"/"===i?this.pos-3:this.pos-2,n="{"),this.line_char_count++,r.push(i),r[1]&&"!"===r[1]){r=[this.get_comment(e)];break}if(f&&"{"===n&&r.length>2&&"}"===r[r.length-2]&&"}"===r[r.length-1])break}}while(">"!==i);var l,h,u=r.join("");l=-1!==u.indexOf(" ")?u.indexOf(" "):"{"===u[0]?u.indexOf("}"):u.indexOf(">"),h="<"!==u[0]&&f?"#"===u[2]?3:2:1;var p=u.substring(h,l).toLowerCase();return"/"===u.charAt(u.length-2)||this.Utils.in_array(p,this.Utils.single_token)?t||(this.tag_type="SINGLE"):f&&"{"===u[0]&&"else"===p?t||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(p,c)?(s=this.get_unformatted("</"+p+">",u),r.push(s),this.pos,this.tag_type="SINGLE"):"script"===p&&(-1===u.search("type")||u.search("type")>-1&&u.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/)>-1)?t||(this.record_tag(p),this.tag_type="SCRIPT"):"style"===p&&(-1===u.search("type")||u.search("type")>-1&&u.search("text/css")>-1)?t||(this.record_tag(p),this.tag_type="STYLE"):"!"===p.charAt(0)?t||(this.tag_type="SINGLE",this.traverse_whitespace()):t||("/"===p.charAt(0)?(this.retrieve_tag(p.substring(1)),this.tag_type="END"):(this.record_tag(p),"html"!==p.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(r),this.Utils.in_array(p,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),t&&(this.pos=_,this.line_char_count=o),r.join("")},this.get_comment=function(t){var e="",n=">",i=!1;for(this.pos=t,input_char=this.input.charAt(this.pos),this.pos++;this.pos<=this.input.length&&((e+=input_char)[e.length-1]!==n[n.length-1]||-1===e.indexOf(n));)!i&&e.length<10&&(0===e.indexOf("<![if")?(n="<![endif]>",i=!0):0===e.indexOf("<![cdata[")?(n="]]>",i=!0):0===e.indexOf("<![")?(n="]>",i=!0):0===e.indexOf("\x3c!--")&&(n="--\x3e",i=!0)),input_char=this.input.charAt(this.pos),this.pos++;return e},this.get_unformatted=function(t,e){if(e&&-1!==e.toLowerCase().indexOf(t))return"";var n="",i="",r=0,s=!0;do{if(this.pos>=this.input.length)return i;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"===n||"\r"===n){i+="\n",this.line_char_count=0;continue}}i+=n,this.line_char_count++,s=!0,f&&"{"===n&&i.length&&"{"===i[i.length-2]&&(r=(i+=this.get_unformatted("}}")).length)}while(-1===i.toLowerCase().indexOf(t,r));return i},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return"string"!=typeof(t=this.get_contents_to(e))?t:[t,"TK_"+e]}return"CONTENT"===this.current_mode?"string"!=typeof(t=this.get_content())?t:[t,"TK_CONTENT"]:"TAG"===this.current_mode?"string"!=typeof(t=this.get_tag())?t:[t,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(t){return(t=this.indent_level+t||0)<1?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,e){if(!this.Utils.in_array(t,e))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",e))return!0;var n=(this.get_tag(!0)||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(n&&!this.Utils.in_array(n,e))},this.printer=function(t,e,i,r,s){this.input=t||"",this.output=[],this.indent_character=e,this.indent_string="",this.indent_size=i,this.brace_style=s,this.indent_level=0,this.wrap_line_length=r,this.line_char_count=0;for(var a=0;a<this.indent_size;a++)this.indent_string+=this.indent_character;this.print_newline=function(t,e){this.line_char_count=0,e&&e.length&&(t||"\n"!==e[e.length-1])&&("\n"!==e[e.length-1]&&(e[e.length-1]=n(e[e.length-1])),e.push("\n"))},this.print_indentation=function(t){for(var e=0;e<this.indent_level;e++)t.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(t){this.is_whitespace(t)&&!this.output.length||((t||""!==t)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),t=t.replace(/^\s+/g,"")),this.print_token_raw(t))},this.print_token_raw=function(t){this.newlines>0&&(t=n(t)),t&&""!==t&&(t.length>1&&"\n"===t[t.length-1]?(this.output.push(t.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(t));for(var e=0;e<this.newlines;e++)this.print_newline(e>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}).printer(t,o,_,l,h);for(;;){var T=s.get_token();if(s.token_text=T[0],s.token_type=T[1],"TK_EOF"===s.token_type)break;switch(s.token_type){case"TK_TAG_START":s.print_newline(!1,s.output),s.print_token(s.token_text),s.indent_content&&(s.indent(),s.indent_content=!1),s.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":s.print_newline(!1,s.output),s.print_token(s.token_text),s.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===s.last_token&&""===s.last_text){var E=s.token_text.match(/\w+/)[0],g=null;s.output.length&&(g=s.output[s.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),null!==g&&g[1]===E||s.print_newline(!1,s.output)}s.print_token(s.token_text),s.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var x=s.token_text.match(/^\s*<([a-z-]+)/i);x&&s.Utils.in_array(x[1],c)||s.print_newline(!1,s.output),s.print_token(s.token_text),s.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":s.print_token(s.token_text),s.indent_content&&(s.indent(),s.indent_content=!1),s.current_mode="CONTENT";break;case"TK_CONTENT":s.print_token(s.token_text),s.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==s.token_text){s.print_newline(!1,s.output);var m,k=s.token_text,y=1;"TK_SCRIPT"===s.token_type?m="function"==typeof i&&i:"TK_STYLE"===s.token_type&&(m="function"==typeof r&&r),"keep"===e.indent_scripts?y=0:"separate"===e.indent_scripts&&(y=-s.indent_level);var K=s.get_full_indent(y);if(m)k=m(k.replace(/^\s*/,K),e);else{var R=k.match(/^\s*/)[0],v=R.match(/[^\n\r]*$/)[0].split(s.indent_string).length-1,b=s.get_full_indent(y-v);k=k.replace(/^\s*/,K).replace(/\r\n|\r|\n/g,"\n"+b).replace(/\s+$/,"")}k&&(s.print_token_raw(k),s.print_newline(!0,s.output))}s.current_mode="TAG";break;default:""!==s.token_text&&s.print_token(s.token_text)}s.last_token=s.token_type,s.last_text=s.token_text}var w=s.output.join("").replace(/[\r\n\t ]+$/,"");d&&(w+="\n");return w}(i,r,e,t)}}}),t("skylark-parsers-html/beautify",["./html","./primitives/beautify-html"],function(t,e){return t.beautify=e.html_beautify}),t("skylark-parsers-html/main",["./html","./beautify"],function(t){return t}),t("skylark-parsers-html",["skylark-parsers-html/main"],function(t){return t})}(n),!i){var a=require("skylark-langx/skylark");r?module.exports=a:e.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-parsers-html-all.js.map
