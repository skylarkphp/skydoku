{"version":3,"sources":["draggable.js"],"names":["define","skylark","langx","browser","noder","eventer","finder","$","element","onmove","onstart","onstop","doc","document","dragging","offset","maxHeight","maxWidth","hasTouch","window","duringDragEvents","prevent","e","stopPropagation","preventDefault","returnValue","move","isIE","documentMode","button","stop","t0","originalEvent","touches","pageX","pageY","dragX","Math","max","min","left","dragY","top","apply","off","body","removeClass","setTimeout","arguments","on","which","height","width","addClass"],"mappings":";;;;;;;AAAAA,QACG,wBACC,sBACA,uBACA,qBACA,uBACA,sBACA,sBACF,SAASC,EAASC,EAAOC,EAASC,EAAOC,EAAQC,EAAQC,GA4F1D,OAvFG,SAAmBC,EAASC,EAAQC,EAASC,GACzCF,EAASA,GAAU,aACnBC,EAAUA,GAAW,aACrBC,EAASA,GAAU,aACnB,IAAIC,EAAMC,SACNC,GAAW,EACXC,KACAC,EAAY,EACZC,EAAW,EACXC,EAAY,iBAAkBC,OAE9BC,KAMJ,SAASC,EAAQC,GACTA,EAAEC,iBACFD,EAAEC,kBAEFD,EAAEE,gBACFF,EAAEE,iBAENF,EAAEG,aAAc,EAGpB,SAASC,EAAKJ,GACV,GAAIR,EAAU,CAEV,GAAIX,EAAQwB,MAAQf,EAAIgB,aAAe,IAAMN,EAAEO,OAC3C,OAAOC,IAGX,IAAIC,EAAKT,EAAEU,eAAiBV,EAAEU,cAAcC,SAAWX,EAAEU,cAAcC,QAAQ,GAC3EC,EAAQH,GAAMA,EAAGG,OAASZ,EAAEY,MAC5BC,EAAQJ,GAAMA,EAAGI,OAASb,EAAEa,MAE5BC,EAAQC,KAAKC,IAAI,EAAGD,KAAKE,IAAIL,EAAQnB,EAAOyB,KAAMvB,IAClDwB,EAAQJ,KAAKC,IAAI,EAAGD,KAAKE,IAAIJ,EAAQpB,EAAO2B,IAAK1B,IAEjDE,GAEAG,EAAQC,GAGZb,EAAOkC,MAAMnC,GAAU4B,EAAOK,EAAOnB,KAwB7C,SAASQ,IACDhB,IACAP,EAAEK,GAAKgC,IAAIxB,GACXb,EAAEK,EAAIiC,MAAMC,YAAY,eAIxBC,WAAW,WACPpC,EAAOgC,MAAMnC,EAASwC,YACvB,IAEPlC,GAAW,EArEfM,EAA8B,YAAIC,EAClCD,EAA4B,UAAIC,EAChCD,EAAiB,uBAAyBM,EAC1CN,EAAiB,oBAAsBU,EAqEvCvB,EAAEC,GAASyC,GAAG,uBAlCd,SAAe3B,IACOA,EAAO,MAAgB,GAAXA,EAAE4B,MAA2B,GAAZ5B,EAAEO,SAE7Bf,IAC0B,IAAtCJ,EAAQiC,MAAMnC,EAASwC,aACvBlC,GAAW,EACXE,EAAYT,EAAEC,GAAS2C,SACvBlC,EAAWV,EAAEC,GAAS4C,QACtBrC,EAASR,EAAEC,GAASO,SAEpBR,EAAEK,GAAKqC,GAAG7B,GACVb,EAAEK,EAAIiC,MAAMQ,SAAS,eAErB3B,EAAKJ,GAELD,EAAQC","file":"../draggable.js","sourcesContent":["define([\r\n   \"skylark-langx/skylark\",\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx-browser\",\r\n    \"skylark-domx-noder\",\r\n    \"skylark-domx-eventer\",\r\n    \"skylark-domx-finder\",\r\n    \"skylark-domx-query\"\r\n],function(skylark, langx, browser, noder, eventer,finder, $) {\r\n    /**\r\n    * Lightweight drag helper.  Handles containment within the element, so that\r\n    * when dragging, the x is within [0,element.width] and y is within [0,element.height]\r\n    */\r\n    function draggable(element, onmove, onstart, onstop) {\r\n        onmove = onmove || function () { };\r\n        onstart = onstart || function () { };\r\n        onstop = onstop || function () { };\r\n        var doc = document;\r\n        var dragging = false;\r\n        var offset = {};\r\n        var maxHeight = 0;\r\n        var maxWidth = 0;\r\n        var hasTouch = ('ontouchstart' in window);\r\n\r\n        var duringDragEvents = {};\r\n        duringDragEvents[\"selectstart\"] = prevent;\r\n        duringDragEvents[\"dragstart\"] = prevent;\r\n        duringDragEvents[\"touchmove mousemove\"] = move;\r\n        duringDragEvents[\"touchend mouseup\"] = stop;\r\n\r\n        function prevent(e) {\r\n            if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n            }\r\n            if (e.preventDefault) {\r\n                e.preventDefault();\r\n            }\r\n            e.returnValue = false;\r\n        }\r\n\r\n        function move(e) {\r\n            if (dragging) {\r\n                // Mouseup happened outside of window\r\n                if (browser.isIE && doc.documentMode < 9 && !e.button) {\r\n                    return stop();\r\n                }\r\n\r\n                var t0 = e.originalEvent && e.originalEvent.touches && e.originalEvent.touches[0];\r\n                var pageX = t0 && t0.pageX || e.pageX;\r\n                var pageY = t0 && t0.pageY || e.pageY;\r\n\r\n                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));\r\n                var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));\r\n\r\n                if (hasTouch) {\r\n                    // Stop scrolling in iOS\r\n                    prevent(e);\r\n                }\r\n\r\n                onmove.apply(element, [dragX, dragY, e]);\r\n            }\r\n        }\r\n\r\n        function start(e) {\r\n            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);\r\n\r\n            if (!rightclick && !dragging) {\r\n                if (onstart.apply(element, arguments) !== false) {\r\n                    dragging = true;\r\n                    maxHeight = $(element).height();\r\n                    maxWidth = $(element).width();\r\n                    offset = $(element).offset();\r\n\r\n                    $(doc).on(duringDragEvents);\r\n                    $(doc.body).addClass(\"sp-dragging\");\r\n\r\n                    move(e);\r\n\r\n                    prevent(e);\r\n                }\r\n            }\r\n        }\r\n\r\n        function stop() {\r\n            if (dragging) {\r\n                $(doc).off(duringDragEvents);\r\n                $(doc.body).removeClass(\"sp-dragging\");\r\n\r\n                // Wait a tick before notifying observers to allow the click event\r\n                // to fire in Chrome.\r\n                setTimeout(function() {\r\n                    onstop.apply(element, arguments);\r\n                }, 0);\r\n            }\r\n            dragging = false;\r\n        }\r\n\r\n        $(element).on(\"touchstart mousedown\", start);\r\n    }\r\n\t\r\n\treturn draggable;\r\n});"]}