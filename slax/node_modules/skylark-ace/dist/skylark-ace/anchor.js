/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(t,o,n){"use strict";var i=t("./lib/oop"),r=t("./lib/event_emitter").EventEmitter,e=o.Anchor=function(t,o,n){this.$onChange=this.onChange.bind(this),this.attach(t),void 0===n?this.setPosition(o.row,o.column):this.setPosition(o,n)};(function(){function t(t,o,n){var i=n?t.column<=o.column:t.column<o.column;return t.row<o.row||t.row==o.row&&i}i.implement(this,r),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(o){if(!(o.start.row==o.end.row&&o.start.row!=this.row||o.start.row>this.row)){var n=function(o,n,i){var r="insert"==o.action,e=(r?1:-1)*(o.end.row-o.start.row),s=(r?1:-1)*(o.end.column-o.start.column),c=o.start,h=r?c:o.end;if(t(n,c,i))return{row:n.row,column:n.column};if(t(h,n,!i))return{row:n.row+e,column:n.column+(n.row==h.row?s:0)};return{row:c.row,column:c.column}}(o,{row:this.row,column:this.column},this.$insertRight);this.setPosition(n.row,n.column,!0)}},this.setPosition=function(t,o,n){var i;if(i=n?{row:t,column:o}:this.$clipPositionToDocument(t,o),this.row!=i.row||this.column!=i.column){var r={row:this.row,column:this.column};this.row=i.row,this.column=i.column,this._signal("change",{old:r,value:i})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(t){this.document=t||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(t,o){var n={};return t>=this.document.getLength()?(n.row=Math.max(0,this.document.getLength()-1),n.column=this.document.getLine(n.row).length):t<0?(n.row=0,n.column=0):(n.row=t,n.column=Math.min(this.document.getLine(n.row).length,Math.max(0,o))),o<0&&(n.column=0),n}}).call(e.prototype)});
//# sourceMappingURL=sourcemaps/anchor.js.map
