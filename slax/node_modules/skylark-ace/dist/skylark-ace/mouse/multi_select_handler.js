/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,n,o){var t=e("../lib/event"),r=e("../lib/useragent");function i(e,n){return e.row==n.row&&e.column==n.column}n.onMouseDown=function(e){var n=e.domEvent,o=n.altKey,l=n.shiftKey,c=n.ctrlKey,a=e.getAccelKey(),u=e.getButton();if(c&&r.isMac&&(u=n.button),e.editor.inMultiSelectMode&&2==u)e.editor.textInput.onContextMenu(e.domEvent);else if(c||o||a){if(0===u){var d,s=e.editor,S=s.selection,f=s.inMultiSelectMode,m=e.getDocumentPosition(),M=S.getCursor(),v=e.inSelection()||S.isEmpty()&&i(m,M),g=e.x,k=e.y,b=s.session,p=s.renderer.pixelToScreenCoordinates(g,k),$=p;if(s.$mouseHandler.$enableJumpToDef)c&&o||a&&o?d=l?"block":"add":o&&s.$blockSelectEnabled&&(d="block");else if(a&&!o){if(d="add",!f&&l)return}else o&&s.$blockSelectEnabled&&(d="block");if(d&&r.isMac&&n.ctrlKey&&s.$mouseHandler.cancelContextMenu(),"add"==d){if(!f&&v)return;if(!f){var R=S.toOrientedRange();s.addSelectionMarker(R)}var y=S.rangeList.rangeAtPoint(m);s.inVirtualSelectionMode=!0,l&&(y=null,R=S.ranges[0]||R,s.removeSelectionMarker(R)),s.once("mouseup",function(){var e=S.toOrientedRange();y&&e.isEmpty()&&i(y.cursor,e.cursor)?S.substractPoint(e.cursor):(l?S.substractPoint(R.cursor):R&&(s.removeSelectionMarker(R),S.addRange(R)),S.addRange(e)),s.inVirtualSelectionMode=!1})}else if("block"==d){var E;e.stop(),s.inVirtualSelectionMode=!0;var P=[],x=function(){var e=s.renderer.pixelToScreenCoordinates(g,k),n=b.screenToDocumentPosition(e.row,e.column,e.offsetX);i($,e)&&i(n,S.lead)||($=e,s.selection.moveToPosition(n),s.renderer.scrollCursorIntoView(),s.removeSelectionMarkers(P),P=S.rectangularRangeBlock($,p),s.$mouseHandler.$clickSelection&&1==P.length&&P[0].isEmpty()&&(P[0]=s.$mouseHandler.$clickSelection.clone()),P.forEach(s.addSelectionMarker,s),s.updateSelectionMarkers())};f&&!a?S.toSingleRange():!f&&a&&(E=S.toOrientedRange(),s.addSelectionMarker(E)),l?p=b.documentToScreenPosition(S.lead):S.moveToPosition(m),$={row:-1,column:-1};var T=x;t.capture(s.container,function(e){g=e.clientX,k=e.clientY},function(e){x(),clearInterval(w),s.removeSelectionMarkers(P),P.length||(P=[S.toOrientedRange()]),E&&(s.removeSelectionMarker(E),S.toSingleRange(E));for(var n=0;n<P.length;n++)S.addRange(P[n]);s.inVirtualSelectionMode=!1,s.$mouseHandler.$clickSelection=null});var w=setInterval(function(){T()},20);return e.preventDefault()}}}else 0===u&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}});
//# sourceMappingURL=../sourcemaps/mouse/multi_select_handler.js.map
