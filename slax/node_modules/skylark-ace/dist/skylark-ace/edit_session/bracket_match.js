/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,r,n){"use strict";var t=e("../token_iterator").TokenIterator,o=e("../range").Range;r.BracketMatch=function(){this.findMatchingBracket=function(e,r){if(0==e.column)return null;var n=r||this.getLine(e.row).charAt(e.column-1);if(""==n)return null;var t=n.match(/([\(\[\{])|([\)\]\}])/);return t?t[1]?this.$findClosingBracket(t[1],e):this.$findOpeningBracket(t[2],e):null},this.getBracketRange=function(e){var r,n=this.getLine(e.row),t=!0,a=n.charAt(e.column-1),i=a&&a.match(/([\(\[\{])|([\)\]\}])/);if(i||(a=n.charAt(e.column),e={row:e.row,column:e.column+1},i=a&&a.match(/([\(\[\{])|([\)\]\}])/),t=!1),!i)return null;if(i[1]){if(!(u=this.$findClosingBracket(i[1],e)))return null;r=o.fromPoints(e,u),t||(r.end.column++,r.start.column--),r.cursor=r.end}else{var u;if(!(u=this.$findOpeningBracket(i[2],e)))return null;r=o.fromPoints(u,e),t||(r.start.column++,r.end.column--),r.cursor=r.start}return r},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(e,r,n){var o=this.$brackets[e],a=1,i=new t(this,r.row,r.column),u=i.getCurrentToken();if(u||(u=i.stepForward()),u){n||(n=new RegExp("(\\.?"+u.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var l=r.column-i.getCurrentTokenColumn()-2,c=u.value;;){for(;l>=0;){var s=c.charAt(l);if(s==o){if(0==(a-=1))return{row:i.getCurrentTokenRow(),column:l+i.getCurrentTokenColumn()}}else s==e&&(a+=1);l-=1}do{u=i.stepBackward()}while(u&&!n.test(u.type));if(null==u)break;l=(c=u.value).length-1}return null}},this.$findClosingBracket=function(e,r,n){var o=this.$brackets[e],a=1,i=new t(this,r.row,r.column),u=i.getCurrentToken();if(u||(u=i.stepForward()),u){n||(n=new RegExp("(\\.?"+u.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var l=r.column-i.getCurrentTokenColumn();;){for(var c=u.value,s=c.length;l<s;){var f=c.charAt(l);if(f==o){if(0==(a-=1))return{row:i.getCurrentTokenRow(),column:l+i.getCurrentTokenColumn()}}else f==e&&(a+=1);l+=1}do{u=i.stepForward()}while(u&&!n.test(u.type));if(null==u)break;l=0}return null}}}});
//# sourceMappingURL=../sourcemaps/edit_session/bracket_match.js.map
