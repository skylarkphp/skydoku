{"version":3,"sources":["scrollbar.js"],"names":["define","require","exports","module","oop","dom","event","EventEmitter","ScrollBar","parent","this","element","createElement","className","classSuffix","inner","appendChild","setVisible","skipEvent","addListener","onScroll","bind","preventDefault","implement","isVisible","style","display","coeff","call","prototype","VScrollBar","renderer","scrollTop","scrollHeight","$scrollbarWidth","width","scrollbarWidth","ownerDocument","$minWidth","inherits","h","clientHeight","_emit","data","getWidth","Math","max","setHeight","height","setInnerHeight","setScrollHeight","setScrollTop","HScrollBar","scrollLeft","getHeight","setWidth","setInnerWidth","setScrollWidth","setScrollLeft","ScrollBarV","ScrollBarH"],"mappings":"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","file":"../scrollbar.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\r\n * Distributed under the BSD license:\r\n *\r\n * Copyright (c) 2010, Ajax.org B.V.\r\n * All rights reserved.\r\n * \r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *     * Redistributions of source code must retain the above copyright\r\n *       notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above copyright\r\n *       notice, this list of conditions and the following disclaimer in the\r\n *       documentation and/or other materials provided with the distribution.\r\n *     * Neither the name of Ajax.org B.V. nor the\r\n *       names of its contributors may be used to endorse or promote products\r\n *       derived from this software without specific prior written permission.\r\n * \r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n * ***** END LICENSE BLOCK ***** */\r\n\r\ndefine(function(require, exports, module) {\r\n\"use strict\";\r\n\r\nvar oop = require(\"./lib/oop\");\r\nvar dom = require(\"./lib/dom\");\r\nvar event = require(\"./lib/event\");\r\nvar EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\r\n// on ie maximal element height is smaller than what we get from 4-5K line document\r\n// so scrollbar doesn't work, as a workaround we do not set height higher than MAX_SCROLL_H\r\n// and rescale scrolltop\r\nvar MAX_SCROLL_H = 0x8000;\r\n\r\n/**\r\n * An abstract class representing a native scrollbar control.\r\n * @class ScrollBar\r\n **/\r\n\r\n/**\r\n * Creates a new `ScrollBar`. `parent` is the owner of the scroll bar.\r\n * @param {DOMElement} parent A DOM element \r\n *\r\n * @constructor\r\n **/\r\nvar ScrollBar = function(parent) {\r\n    this.element = dom.createElement(\"div\");\r\n    this.element.className = \"ace_scrollbar ace_scrollbar\" + this.classSuffix;\r\n\r\n    this.inner = dom.createElement(\"div\");\r\n    this.inner.className = \"ace_scrollbar-inner\";\r\n    this.element.appendChild(this.inner);\r\n\r\n    parent.appendChild(this.element);\r\n\r\n    this.setVisible(false);\r\n    this.skipEvent = false;\r\n\r\n    event.addListener(this.element, \"scroll\", this.onScroll.bind(this));\r\n    event.addListener(this.element, \"mousedown\", event.preventDefault);\r\n};\r\n\r\n(function() {\r\n    oop.implement(this, EventEmitter);\r\n\r\n    this.setVisible = function(isVisible) {\r\n        this.element.style.display = isVisible ? \"\" : \"none\";\r\n        this.isVisible = isVisible;\r\n        this.coeff = 1;\r\n    };\r\n}).call(ScrollBar.prototype);\r\n\r\n/**\r\n * Represents a vertical scroll bar.\r\n * @class VScrollBar\r\n **/\r\n\r\n/**\r\n * Creates a new `VScrollBar`. `parent` is the owner of the scroll bar.\r\n * @param {DOMElement} parent A DOM element\r\n * @param {Object} renderer An editor renderer\r\n *\r\n * @constructor\r\n **/\r\nvar VScrollBar = function(parent, renderer) {\r\n    ScrollBar.call(this, parent);\r\n    this.scrollTop = 0;\r\n    this.scrollHeight = 0;\r\n\r\n    // in OSX lion the scrollbars appear to have no width. In this case resize the\r\n    // element to show the scrollbar but still pretend that the scrollbar has a width\r\n    // of 0px\r\n    // in Firefox 6+ scrollbar is hidden if element has the same width as scrollbar\r\n    // make element a little bit wider to retain scrollbar when page is zoomed \r\n    renderer.$scrollbarWidth = \r\n    this.width = dom.scrollbarWidth(parent.ownerDocument);\r\n    this.inner.style.width =\r\n    this.element.style.width = (this.width || 15) + 5 + \"px\";\r\n    this.$minWidth = 0;\r\n};\r\n\r\noop.inherits(VScrollBar, ScrollBar);\r\n\r\n(function() {\r\n\r\n    this.classSuffix = '-v';\r\n\r\n    /**\r\n     * Emitted when the scroll bar, well, scrolls.\r\n     * @event scroll\r\n     * @param {Object} e Contains one property, `\"data\"`, which indicates the current scroll top position\r\n     **/\r\n    this.onScroll = function() {\r\n        if (!this.skipEvent) {\r\n            this.scrollTop = this.element.scrollTop;\r\n            if (this.coeff != 1) {\r\n                var h = this.element.clientHeight / this.scrollHeight;\r\n                this.scrollTop = this.scrollTop * (1 - h) / (this.coeff - h);\r\n            }\r\n            this._emit(\"scroll\", {data: this.scrollTop});\r\n        }\r\n        this.skipEvent = false;\r\n    };\r\n\r\n    /**\r\n     * Returns the width of the scroll bar.\r\n     * @returns {Number}\r\n     **/\r\n    this.getWidth = function() {\r\n        return Math.max(this.isVisible ? this.width : 0, this.$minWidth || 0);\r\n    };\r\n\r\n    /**\r\n     * Sets the height of the scroll bar, in pixels.\r\n     * @param {Number} height The new height\r\n     **/\r\n    this.setHeight = function(height) {\r\n        this.element.style.height = height + \"px\";\r\n    };\r\n\r\n    /**\r\n     * Sets the inner height of the scroll bar, in pixels.\r\n     * @param {Number} height The new inner height\r\n     * @deprecated Use setScrollHeight instead\r\n     **/\r\n    this.setInnerHeight = \r\n    /**\r\n     * Sets the scroll height of the scroll bar, in pixels.\r\n     * @param {Number} height The new scroll height\r\n     **/\r\n    this.setScrollHeight = function(height) {\r\n        this.scrollHeight = height;\r\n        if (height > MAX_SCROLL_H) {\r\n            this.coeff = MAX_SCROLL_H / height;\r\n            height = MAX_SCROLL_H;\r\n        } else if (this.coeff != 1) {\r\n            this.coeff = 1;\r\n        }\r\n        this.inner.style.height = height + \"px\";\r\n    };\r\n\r\n    /**\r\n     * Sets the scroll top of the scroll bar.\r\n     * @param {Number} scrollTop The new scroll top\r\n     **/\r\n    this.setScrollTop = function(scrollTop) {\r\n        // on chrome 17+ for small zoom levels after calling this function\r\n        // this.element.scrollTop != scrollTop which makes page to scroll up.\r\n        if (this.scrollTop != scrollTop) {\r\n            this.skipEvent = true;\r\n            this.scrollTop = scrollTop;\r\n            this.element.scrollTop = scrollTop * this.coeff;\r\n        }\r\n    };\r\n\r\n}).call(VScrollBar.prototype);\r\n\r\n/**\r\n * Represents a horisontal scroll bar.\r\n * @class HScrollBar\r\n **/\r\n\r\n/**\r\n * Creates a new `HScrollBar`. `parent` is the owner of the scroll bar.\r\n * @param {DOMElement} parent A DOM element\r\n * @param {Object} renderer An editor renderer\r\n *\r\n * @constructor\r\n **/\r\nvar HScrollBar = function(parent, renderer) {\r\n    ScrollBar.call(this, parent);\r\n    this.scrollLeft = 0;\r\n\r\n    // in OSX lion the scrollbars appear to have no width. In this case resize the\r\n    // element to show the scrollbar but still pretend that the scrollbar has a width\r\n    // of 0px\r\n    // in Firefox 6+ scrollbar is hidden if element has the same width as scrollbar\r\n    // make element a little bit wider to retain scrollbar when page is zoomed \r\n    this.height = renderer.$scrollbarWidth;\r\n    this.inner.style.height =\r\n    this.element.style.height = (this.height || 15) + 5 + \"px\";\r\n};\r\n\r\noop.inherits(HScrollBar, ScrollBar);\r\n\r\n(function() {\r\n\r\n    this.classSuffix = '-h';\r\n\r\n    /**\r\n     * Emitted when the scroll bar, well, scrolls.\r\n     * @event scroll\r\n     * @param {Object} e Contains one property, `\"data\"`, which indicates the current scroll left position\r\n     **/\r\n    this.onScroll = function() {\r\n        if (!this.skipEvent) {\r\n            this.scrollLeft = this.element.scrollLeft;\r\n            this._emit(\"scroll\", {data: this.scrollLeft});\r\n        }\r\n        this.skipEvent = false;\r\n    };\r\n\r\n    /**\r\n     * Returns the height of the scroll bar.\r\n     * @returns {Number}\r\n     **/\r\n    this.getHeight = function() {\r\n        return this.isVisible ? this.height : 0;\r\n    };\r\n\r\n    /**\r\n     * Sets the width of the scroll bar, in pixels.\r\n     * @param {Number} width The new width\r\n     **/\r\n    this.setWidth = function(width) {\r\n        this.element.style.width = width + \"px\";\r\n    };\r\n\r\n    /**\r\n     * Sets the inner width of the scroll bar, in pixels.\r\n     * @param {Number} width The new inner width\r\n     * @deprecated Use setScrollWidth instead\r\n     **/\r\n    this.setInnerWidth = function(width) {\r\n        this.inner.style.width = width + \"px\";\r\n    };\r\n\r\n    /**\r\n     * Sets the scroll width of the scroll bar, in pixels.\r\n     * @param {Number} width The new scroll width\r\n     **/\r\n    this.setScrollWidth = function(width) {\r\n        this.inner.style.width = width + \"px\";\r\n    };\r\n\r\n    /**\r\n     * Sets the scroll left of the scroll bar.\r\n     * @param {Number} scrollTop The new scroll left\r\n     **/\r\n    this.setScrollLeft = function(scrollLeft) {\r\n        // on chrome 17+ for small zoom levels after calling this function\r\n        // this.element.scrollTop != scrollTop which makes page to scroll up.\r\n        if (this.scrollLeft != scrollLeft) {\r\n            this.skipEvent = true;\r\n            this.scrollLeft = this.element.scrollLeft = scrollLeft;\r\n        }\r\n    };\r\n\r\n}).call(HScrollBar.prototype);\r\n\r\n\r\nexports.ScrollBar = VScrollBar; // backward compatibility\r\nexports.ScrollBarV = VScrollBar; // backward compatibility\r\nexports.ScrollBarH = HScrollBar; // backward compatibility\r\n\r\nexports.VScrollBar = VScrollBar;\r\nexports.HScrollBar = HScrollBar;\r\n});\r\n"]}