{"version":3,"sources":["commands/occur_commands.js"],"names":["define","require","exports","module","Occur","occurStartCommand","name","exec","editor","options","alreadyInOccur","session","$occur","enter","OccurKeyboardHandler","installIn","readOnly","occurCommands","bindKey","occur","exit","uninstallFrom","translatePosition","HashHandler","inherits","this","isOccurHandler","attach","call","commands","platform","$editor","handleKeyboard$super","handleKeyboard","data","hashId","key","keyCode","cmd","command","undefined","prototype","handler","keyBinding","addKeyboardHandler","addCommands","removeCommands","getKeyboardHandler","removeKeyboardHandler"],"mappings":";;;;;;;AA8BAA,OAAO,SAASC,QAASC,QAASC,QAErBF,QAAQ,aAArB,IACIG,EAAQH,QAAQ,YAAYG,MAG5BC,GACAC,KAAM,QACNC,KAAM,SAASC,EAAQC,GACnB,IAAIC,IAAmBF,EAAOG,QAAQC,QACb,IAAIR,GAAQS,MAAML,EAAQC,KACxBC,GACvBI,EAAqBC,UAAUP,IAEvCQ,UAAU,GAGVC,IACAX,KAAM,YACNY,QAAS,aACTX,KAAM,SAASC,GACX,IAAIW,EAAQX,EAAOG,QAAQC,OACtBO,IACLA,EAAMC,KAAKZ,MACNA,EAAOG,QAAQC,QAAQE,EAAqBO,cAAcb,KAEnEQ,UAAU,IAEVV,KAAM,cACNY,QAAS,QACTX,KAAM,SAASC,GACX,IAAIW,EAAQX,EAAOG,QAAQC,OACtBO,IACLA,EAAMC,KAAKZ,GAASc,mBAAmB,IAClCd,EAAOG,QAAQC,QAAQE,EAAqBO,cAAcb,KAEnEQ,UAAU,IAGVO,EAActB,QAAQ,4BAA4BsB,YAItD,SAAST,KAHCb,QAAQ,cAKduB,SAASV,EAAsBS,GAEnC,WAEIE,KAAKC,gBAAiB,EAEtBD,KAAKE,OAAS,SAASnB,GACnBe,EAAYK,KAAKH,KAAMR,EAAeT,EAAOqB,SAASC,UACtDL,KAAKM,QAAUvB,GAGnB,IAAIwB,EAAuBP,KAAKQ,eAChCR,KAAKQ,eAAiB,SAASC,EAAMC,EAAQC,EAAKC,GAC9C,IAAIC,EAAMN,EAAqBJ,KAAKH,KAAMS,EAAMC,EAAQC,EAAKC,GAC7D,OAAQC,GAAOA,EAAIC,QAAWD,OAAME,IAGzCZ,KAAKd,EAAqB2B,WAE7B3B,EAAqBC,UAAY,SAASP,GACtC,IAAIkC,EAAU,IAAIjB,KAClBjB,EAAOmC,WAAWC,mBAAmBF,GACrClC,EAAOqB,SAASgB,YAAY5B,IAGhCH,EAAqBO,cAAgB,SAASb,GAC1CA,EAAOqB,SAASiB,eAAe7B,GAC/B,IAAIyB,EAAUlC,EAAOuC,qBACjBL,EAAQhB,gBACRlB,EAAOmC,WAAWK,sBAAsBN,IAGhDxC,QAAQG,kBAAoBA","file":"../../commands/occur_commands.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\r\n * Distributed under the BSD license:\r\n *\r\n * Copyright (c) 2010, Ajax.org B.V.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *     * Redistributions of source code must retain the above copyright\r\n *       notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above copyright\r\n *       notice, this list of conditions and the following disclaimer in the\r\n *       documentation and/or other materials provided with the distribution.\r\n *     * Neither the name of Ajax.org B.V. nor the\r\n *       names of its contributors may be used to endorse or promote products\r\n *       derived from this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n * ***** END LICENSE BLOCK ***** */\r\n\r\ndefine(function(require, exports, module) {\r\n\r\nvar config = require(\"../config\"),\r\n    Occur = require(\"../occur\").Occur;\r\n\r\n// These commands can be installed in a normal command handler to start occur:\r\nvar occurStartCommand = {\r\n    name: \"occur\",\r\n    exec: function(editor, options) {\r\n        var alreadyInOccur = !!editor.session.$occur;\r\n        var occurSessionActive = new Occur().enter(editor, options);\r\n        if (occurSessionActive && !alreadyInOccur)\r\n            OccurKeyboardHandler.installIn(editor);\r\n    },\r\n    readOnly: true\r\n};\r\n\r\nvar occurCommands = [{\r\n    name: \"occurexit\",\r\n    bindKey: 'esc|Ctrl-G',\r\n    exec: function(editor) {\r\n        var occur = editor.session.$occur;\r\n        if (!occur) return;\r\n        occur.exit(editor, {});\r\n        if (!editor.session.$occur) OccurKeyboardHandler.uninstallFrom(editor);\r\n    },\r\n    readOnly: true\r\n}, {\r\n    name: \"occuraccept\",\r\n    bindKey: 'enter',\r\n    exec: function(editor) {\r\n        var occur = editor.session.$occur;\r\n        if (!occur) return;\r\n        occur.exit(editor, {translatePosition: true});\r\n        if (!editor.session.$occur) OccurKeyboardHandler.uninstallFrom(editor);\r\n    },\r\n    readOnly: true\r\n}];\r\n\r\nvar HashHandler = require(\"../keyboard/hash_handler\").HashHandler;\r\nvar oop = require(\"../lib/oop\");\r\n\r\n\r\nfunction OccurKeyboardHandler() {}\r\n\r\noop.inherits(OccurKeyboardHandler, HashHandler);\r\n\r\n(function() {\r\n\r\n    this.isOccurHandler = true;\r\n\r\n    this.attach = function(editor) {\r\n        HashHandler.call(this, occurCommands, editor.commands.platform);\r\n        this.$editor = editor;\r\n    };\r\n\r\n    var handleKeyboard$super = this.handleKeyboard;\r\n    this.handleKeyboard = function(data, hashId, key, keyCode) {\r\n        var cmd = handleKeyboard$super.call(this, data, hashId, key, keyCode);\r\n        return (cmd && cmd.command) ? cmd : undefined;\r\n    };\r\n\r\n}).call(OccurKeyboardHandler.prototype);\r\n\r\nOccurKeyboardHandler.installIn = function(editor) {\r\n    var handler = new this();\r\n    editor.keyBinding.addKeyboardHandler(handler);\r\n    editor.commands.addCommands(occurCommands);\r\n};\r\n\r\nOccurKeyboardHandler.uninstallFrom = function(editor) {\r\n    editor.commands.removeCommands(occurCommands);\r\n    var handler = editor.getKeyboardHandler();\r\n    if (handler.isOccurHandler)\r\n        editor.keyBinding.removeKeyboardHandler(handler);\r\n};\r\n\r\nexports.occurStartCommand = occurStartCommand;\r\n\r\n});\r\n"]}