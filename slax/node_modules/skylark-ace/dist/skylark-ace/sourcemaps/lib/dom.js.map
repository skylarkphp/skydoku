{"version":3,"sources":["lib/dom.js"],"names":["define","require","exports","module","useragent","buildDom","arr","parent","refs","txt","document","createTextNode","appendChild","Array","isArray","els","i","length","ch","push","el","createElement","options","childIndex","Object","keys","forEach","n","val","className","join","setAttribute","getDocumentHead","doc","head","getElementsByTagName","documentElement","tag","ns","createElementNS","removeChildren","element","innerHTML","textContent","ownerDocument","createFragment","createDocumentFragment","hasCssClass","name","split","indexOf","addCssClass","removeCssClass","classes","index","splice","toggleCssClass","add","setCssClass","node","include","hasCssString","id","sheets","querySelectorAll","importCssString","cssText","target","container","getRootNode","style","insertBefore","firstChild","importCssStylsheet","uri","rel","href","scrollbarWidth","inner","width","minWidth","height","display","outer","position","left","overflow","body","noScrollbar","offsetWidth","withScrollbar","clientWidth","removeChild","computedStyle","window","getComputedStyle","setStyle","styles","property","value","HAS_CSS_ANIMATION","HAS_CSS_TRANSFORMS","HI_DPI","isWin","devicePixelRatio","div","undefined","transform","isEdge","animationName","translate","tx","ty","Math","round","top"],"mappings":"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","file":"../../lib/dom.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\r\n * Distributed under the BSD license:\r\n *\r\n * Copyright (c) 2010, Ajax.org B.V.\r\n * All rights reserved.\r\n * \r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *     * Redistributions of source code must retain the above copyright\r\n *       notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above copyright\r\n *       notice, this list of conditions and the following disclaimer in the\r\n *       documentation and/or other materials provided with the distribution.\r\n *     * Neither the name of Ajax.org B.V. nor the\r\n *       names of its contributors may be used to endorse or promote products\r\n *       derived from this software without specific prior written permission.\r\n * \r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n * ***** END LICENSE BLOCK ***** */\r\n\r\ndefine(function(require, exports, module) {\r\n\"use strict\";\r\n\r\nvar useragent = require(\"./useragent\"); \r\nvar XHTML_NS = \"http://www.w3.org/1999/xhtml\";\r\n\r\nexports.buildDom = function buildDom(arr, parent, refs) {\r\n    if (typeof arr == \"string\" && arr) {\r\n        var txt = document.createTextNode(arr);\r\n        if (parent)\r\n            parent.appendChild(txt);\r\n        return txt;\r\n    }\r\n    \r\n    if (!Array.isArray(arr))\r\n        return arr;\r\n    if (typeof arr[0] != \"string\" || !arr[0]) {\r\n        var els = [];\r\n        for (var i = 0; i < arr.length; i++) {\r\n            var ch = buildDom(arr[i], parent, refs);\r\n            ch && els.push(ch);\r\n        }\r\n        return els;\r\n    }\r\n    \r\n    var el = document.createElement(arr[0]);\r\n    var options = arr[1];\r\n    var childIndex = 1;\r\n    if (options && typeof options == \"object\" && !Array.isArray(options))\r\n        childIndex = 2;\r\n    for (var i = childIndex; i < arr.length; i++)\r\n        buildDom(arr[i], el, refs);\r\n    if (childIndex == 2) {\r\n        Object.keys(options).forEach(function(n) {\r\n            var val = options[n];\r\n            if (n === \"class\") {\r\n                el.className = Array.isArray(val) ? val.join(\" \") : val;\r\n            } else if (typeof val == \"function\" || n == \"value\") {\r\n                el[n] = val;\r\n            } else if (n === \"ref\") {\r\n                if (refs) refs[val] = el;\r\n            } else if (val != null) {\r\n                el.setAttribute(n, val);\r\n            }\r\n        });\r\n    }\r\n    if (parent)\r\n        parent.appendChild(el);\r\n    return el;\r\n};\r\n\r\nexports.getDocumentHead = function(doc) {\r\n    if (!doc)\r\n        doc = document;\r\n    return doc.head || doc.getElementsByTagName(\"head\")[0] || doc.documentElement;\r\n};\r\n\r\nexports.createElement = function(tag, ns) {\r\n    return document.createElementNS ?\r\n           document.createElementNS(ns || XHTML_NS, tag) :\r\n           document.createElement(tag);\r\n};\r\n\r\nexports.removeChildren = function(element) {\r\n    element.innerHTML = \"\";\r\n};\r\n\r\nexports.createTextNode = function(textContent, element) {\r\n    var doc = element ? element.ownerDocument : document;\r\n    return doc.createTextNode(textContent);\r\n};\r\n\r\nexports.createFragment = function(element) {\r\n    var doc = element ? element.ownerDocument : document;\r\n    return doc.createDocumentFragment();\r\n};\r\n\r\nexports.hasCssClass = function(el, name) {\r\n    var classes = (el.className + \"\").split(/\\s+/g);\r\n    return classes.indexOf(name) !== -1;\r\n};\r\n\r\n/*\r\n* Add a CSS class to the list of classes on the given node\r\n*/\r\nexports.addCssClass = function(el, name) {\r\n    if (!exports.hasCssClass(el, name)) {\r\n        el.className += \" \" + name;\r\n    }\r\n};\r\n\r\n/*\r\n* Remove a CSS class from the list of classes on the given node\r\n*/\r\nexports.removeCssClass = function(el, name) {\r\n    var classes = el.className.split(/\\s+/g);\r\n    while (true) {\r\n        var index = classes.indexOf(name);\r\n        if (index == -1) {\r\n            break;\r\n        }\r\n        classes.splice(index, 1);\r\n    }\r\n    el.className = classes.join(\" \");\r\n};\r\n\r\nexports.toggleCssClass = function(el, name) {\r\n    var classes = el.className.split(/\\s+/g), add = true;\r\n    while (true) {\r\n        var index = classes.indexOf(name);\r\n        if (index == -1) {\r\n            break;\r\n        }\r\n        add = false;\r\n        classes.splice(index, 1);\r\n    }\r\n    if (add)\r\n        classes.push(name);\r\n\r\n    el.className = classes.join(\" \");\r\n    return add;\r\n};\r\n\r\n\r\n/*\r\n * Add or remove a CSS class from the list of classes on the given node\r\n * depending on the value of <tt>include</tt>\r\n */\r\nexports.setCssClass = function(node, className, include) {\r\n    if (include) {\r\n        exports.addCssClass(node, className);\r\n    } else {\r\n        exports.removeCssClass(node, className);\r\n    }\r\n};\r\n\r\nexports.hasCssString = function(id, doc) {\r\n    var index = 0, sheets;\r\n    doc = doc || document;\r\n    if ((sheets = doc.querySelectorAll(\"style\"))) {\r\n        while (index < sheets.length)\r\n            if (sheets[index++].id === id)\r\n                return true;\r\n    }\r\n};\r\n\r\nexports.importCssString = function importCssString(cssText, id, target) {\r\n    var container = target;\r\n    if (!target || !target.getRootNode) {\r\n        container = document;\r\n    } else {\r\n        container = target.getRootNode();\r\n        if (!container || container == target)\r\n            container = document;\r\n    }\r\n    \r\n    var doc = container.ownerDocument || container;\r\n    \r\n    // If style is already imported return immediately.\r\n    if (id && exports.hasCssString(id, container))\r\n        return null;\r\n    \r\n    if (id)\r\n        cssText += \"\\n/*# sourceURL=ace/css/\" + id + \" */\";\r\n    \r\n    var style = exports.createElement(\"style\");\r\n    style.appendChild(doc.createTextNode(cssText));\r\n    if (id)\r\n        style.id = id;\r\n\r\n    if (container == doc)\r\n        container = exports.getDocumentHead(doc);\r\n    container.insertBefore(style, container.firstChild);\r\n};\r\n\r\nexports.importCssStylsheet = function(uri, doc) {\r\n    exports.buildDom([\"link\", {rel: \"stylesheet\", href: uri}], exports.getDocumentHead(doc));\r\n};\r\nexports.scrollbarWidth = function(document) {\r\n    var inner = exports.createElement(\"ace_inner\");\r\n    inner.style.width = \"100%\";\r\n    inner.style.minWidth = \"0px\";\r\n    inner.style.height = \"200px\";\r\n    inner.style.display = \"block\";\r\n\r\n    var outer = exports.createElement(\"ace_outer\");\r\n    var style = outer.style;\r\n\r\n    style.position = \"absolute\";\r\n    style.left = \"-10000px\";\r\n    style.overflow = \"hidden\";\r\n    style.width = \"200px\";\r\n    style.minWidth = \"0px\";\r\n    style.height = \"150px\";\r\n    style.display = \"block\";\r\n\r\n    outer.appendChild(inner);\r\n\r\n    var body = document.documentElement;\r\n    body.appendChild(outer);\r\n\r\n    var noScrollbar = inner.offsetWidth;\r\n\r\n    style.overflow = \"scroll\";\r\n    var withScrollbar = inner.offsetWidth;\r\n\r\n    if (noScrollbar == withScrollbar) {\r\n        withScrollbar = outer.clientWidth;\r\n    }\r\n\r\n    body.removeChild(outer);\r\n\r\n    return noScrollbar-withScrollbar;\r\n};\r\n\r\nif (typeof document == \"undefined\") {\r\n    exports.importCssString = function() {};\r\n}\r\n\r\nexports.computedStyle = function(element, style) {\r\n    return window.getComputedStyle(element, \"\") || {};\r\n};\r\n\r\nexports.setStyle = function(styles, property, value) {\r\n    if (styles[property] !== value) {\r\n        //console.log(\"set style\", property, styles[property], value);\r\n        styles[property] = value;\r\n    }\r\n};\r\n\r\nexports.HAS_CSS_ANIMATION = false;\r\nexports.HAS_CSS_TRANSFORMS = false;\r\nexports.HI_DPI = useragent.isWin\r\n    ? typeof window !== \"undefined\" && window.devicePixelRatio >= 1.5\r\n    : true;\r\n\r\nif (typeof document !== \"undefined\") {\r\n    // detect CSS transformation support\r\n    var div = document.createElement(\"div\");\r\n    if (exports.HI_DPI && div.style.transform  !== undefined)\r\n        exports.HAS_CSS_TRANSFORMS = true;\r\n    if (!useragent.isEdge && typeof div.style.animationName !== \"undefined\")\r\n        exports.HAS_CSS_ANIMATION = true;\r\n    div = null;\r\n}\r\n\r\nif (exports.HAS_CSS_TRANSFORMS) {\r\n    exports.translate = function(element, tx, ty) {\r\n        element.style.transform = \"translate(\" + Math.round(tx) + \"px, \" + Math.round(ty) +\"px)\";\r\n    };\r\n} else {\r\n    exports.translate = function(element, tx, ty) {\r\n        element.style.top = Math.round(ty) + \"px\";\r\n        element.style.left = Math.round(tx) + \"px\";\r\n    };\r\n}\r\n\r\n});\r\n"]}