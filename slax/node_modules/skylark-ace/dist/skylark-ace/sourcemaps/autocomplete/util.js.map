{"version":3,"sources":["autocomplete/util.js"],"names":["define","require","exports","module","parForEach","array","fn","callback","completed","arLength","length","i","result","err","ID_REGEX","retrievePrecedingIdentifier","text","pos","regex","buf","test","push","reverse","join","retrieveFollowingIdentifier","getCompletionPrefix","editor","prefix","getCursorPosition","line","session","getLine","row","completers","forEach","completer","identifierRegexps","identifierRegex","this","column","bind"],"mappings":";;;;;;;AA8BAA,OAAO,SAASC,EAASC,EAASC,GAClC,aAEAD,EAAQE,WAAa,SAASC,EAAOC,EAAIC,GACrC,IAAIC,EAAY,EACZC,EAAWJ,EAAMK,OACJ,IAAbD,GACAF,IACJ,IAAK,IAAII,EAAI,EAAGA,EAAIF,EAAUE,IAC1BL,EAAGD,EAAMM,GAAI,SAASC,EAAQC,KAC1BL,IACkBC,GACdF,EAASK,EAAQC,MAKjC,IAAIC,EAAW,gCAEfZ,EAAQa,4BAA8B,SAASC,EAAMC,EAAKC,GACtDA,EAAQA,GAASJ,EAEjB,IADA,IAAIK,KACKR,EAAIM,EAAI,EAAGN,GAAK,GACjBO,EAAME,KAAKJ,EAAKL,IADIA,IAEpBQ,EAAIE,KAAKL,EAAKL,IAItB,OAAOQ,EAAIG,UAAUC,KAAK,KAG9BrB,EAAQsB,4BAA8B,SAASR,EAAMC,EAAKC,GACtDA,EAAQA,GAASJ,EAEjB,IADA,IAAIK,KACKR,EAAIM,EAAKN,EAAIK,EAAKN,QACnBQ,EAAME,KAAKJ,EAAKL,IADWA,IAE3BQ,EAAIE,KAAKL,EAAKL,IAItB,OAAOQ,GAGXjB,EAAQuB,oBAAsB,SAAUC,GACpC,IAEIC,EAFAV,EAAMS,EAAOE,oBACbC,EAAOH,EAAOI,QAAQC,QAAQd,EAAIe,KAUtC,OARAN,EAAOO,WAAWC,QAAQ,SAASC,GAC3BA,EAAUC,mBACVD,EAAUC,kBAAkBF,QAAQ,SAASG,IACpCV,GAAUU,IACXV,EAASW,KAAKvB,4BAA4Bc,EAAMZ,EAAIsB,OAAQF,KAClEG,KAAKF,QAEbE,KAAKF,OACAX,GAAUW,KAAKvB,4BAA4Bc,EAAMZ,EAAIsB","file":"../../autocomplete/util.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\r\n * Distributed under the BSD license:\r\n *\r\n * Copyright (c) 2012, Ajax.org B.V.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *     * Redistributions of source code must retain the above copyright\r\n *       notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above copyright\r\n *       notice, this list of conditions and the following disclaimer in the\r\n *       documentation and/or other materials provided with the distribution.\r\n *     * Neither the name of Ajax.org B.V. nor the\r\n *       names of its contributors may be used to endorse or promote products\r\n *       derived from this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n * ***** END LICENSE BLOCK ***** */\r\n\r\ndefine(function(require, exports, module) {\r\n\"use strict\";\r\n\r\nexports.parForEach = function(array, fn, callback) {\r\n    var completed = 0;\r\n    var arLength = array.length;\r\n    if (arLength === 0)\r\n        callback();\r\n    for (var i = 0; i < arLength; i++) {\r\n        fn(array[i], function(result, err) {\r\n            completed++;\r\n            if (completed === arLength)\r\n                callback(result, err);\r\n        });\r\n    }\r\n};\r\n\r\nvar ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\uFFFF]/;\r\n\r\nexports.retrievePrecedingIdentifier = function(text, pos, regex) {\r\n    regex = regex || ID_REGEX;\r\n    var buf = [];\r\n    for (var i = pos-1; i >= 0; i--) {\r\n        if (regex.test(text[i]))\r\n            buf.push(text[i]);\r\n        else\r\n            break;\r\n    }\r\n    return buf.reverse().join(\"\");\r\n};\r\n\r\nexports.retrieveFollowingIdentifier = function(text, pos, regex) {\r\n    regex = regex || ID_REGEX;\r\n    var buf = [];\r\n    for (var i = pos; i < text.length; i++) {\r\n        if (regex.test(text[i]))\r\n            buf.push(text[i]);\r\n        else\r\n            break;\r\n    }\r\n    return buf;\r\n};\r\n\r\nexports.getCompletionPrefix = function (editor) {\r\n    var pos = editor.getCursorPosition();\r\n    var line = editor.session.getLine(pos.row);\r\n    var prefix;\r\n    editor.completers.forEach(function(completer) {\r\n        if (completer.identifierRegexps) {\r\n            completer.identifierRegexps.forEach(function(identifierRegex) {\r\n                if (!prefix && identifierRegex)\r\n                    prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\r\n            }.bind(this));\r\n        }\r\n    }.bind(this));\r\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\r\n};\r\n\r\n});\r\n"]}