/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,r,o){"use strict";var t=e("../line_widgets").LineWidgets,n=e("../lib/dom"),a=e("../range").Range;r.showErrorMarker=function(e,r){var o=e.session;o.widgetManager||(o.widgetManager=new t(o),o.widgetManager.attach(e));var i=e.getCursorPosition(),d=i.row,s=o.widgetManager.getWidgetsAtRow(d).filter(function(e){return"errorMarker"==e.type})[0];s?s.destroy():d-=r;var l,g=function(e,r,o){var t=e.getAnnotations().sort(a.comparePoints);if(t.length){var n=function(e,r,o){for(var t=0,n=e.length-1;t<=n;){var a=t+n>>1,i=o(r,e[a]);if(i>0)t=a+1;else{if(!(i<0))return a;n=a-1}}return-(t+1)}(t,{row:r,column:-1},a.comparePoints);n<0&&(n=-n-1),n>=t.length?n=o>0?0:t.length-1:0===n&&o<0&&(n=t.length-1);var i=t[n];if(i&&o){if(i.row===r){do{i=t[n+=o]}while(i&&i.row===r);if(!i)return t.slice()}var d=[];r=i.row;do{d[o<0?"unshift":"push"](i),i=t[n+=o]}while(i&&i.row==r);return d.length&&d}}}(o,d,r);if(g){var c=g[0];i.column=(c.pos&&"number"!=typeof c.column?c.pos.sc:c.column)||0,i.row=c.row,l=e.renderer.$gutterLayer.$annotations[i.row]}else{if(s)return;l={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(i.row),e.selection.moveToPosition(i);var w={row:i.row,fixedWidth:!0,coverGutter:!0,el:n.createElement("div"),type:"errorMarker"},p=w.el.appendChild(n.createElement("div")),u=w.el.appendChild(n.createElement("div"));u.className="error_widget_arrow "+l.className;var f=e.renderer.$cursorLayer.getPixelPosition(i).left;u.style.left=f+e.renderer.gutterWidth-5+"px",w.el.className="error_widget_wrapper",p.className="error_widget "+l.className,p.innerHTML=l.text.join("<br>"),p.appendChild(n.createElement("div"));var m=function(e,r,o){if(0===r&&("esc"===o||"return"===o))return w.destroy(),{command:"null"}};w.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(m),o.widgetManager.removeLineWidget(w),e.off("changeSelection",w.destroy),e.off("changeSession",w.destroy),e.off("mouseup",w.destroy),e.off("change",w.destroy))},e.keyBinding.addKeyboardHandler(m),e.on("changeSelection",w.destroy),e.on("changeSession",w.destroy),e.on("mouseup",w.destroy),e.on("change",w.destroy),e.session.widgetManager.addLineWidget(w),w.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:w.el.offsetHeight})},n.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")});
//# sourceMappingURL=../sourcemaps/ext/error_marker.js.map
