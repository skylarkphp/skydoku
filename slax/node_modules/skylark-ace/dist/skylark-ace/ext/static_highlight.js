/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){"use strict";var t=require("../edit_session").EditSession,e=require("../layer/text").Text,n=require("../requirejs/text!./static.css"),r=require("../config"),s=require("../lib/dom"),i=require("../lib/lang").escapeHTML;function o(t){this.type=t,this.style={},this.textContent=""}o.prototype.cloneNode=function(){return this},o.prototype.appendChild=function(t){this.textContent+=t.toString()},o.prototype.toString=function(){var t=[];if("fragment"!=this.type){t.push("<",this.type),this.className&&t.push(" class='",this.className,"'");var e=[];for(var n in this.style)e.push(n,":",this.style[n]);e.length&&t.push(" style='",e.join(""),"'"),t.push(">")}return this.textContent&&t.push(this.textContent),"fragment"!=this.type&&t.push("</",this.type,">"),t.join("")};var a={createTextNode:function(t,e){return i(t)},createElement:function(t){return new o(t)},createFragment:function(){return new o("fragment")}},c=function(){this.config={},this.dom=a};c.prototype=e.prototype;var h=function(t,e,n){var r=t.className.match(/lang-(\w+)/),i=e.mode||r&&"ace/mode/"+r[1];if(!i)return!1;var o=e.theme||"ace/theme/textmate",a="",c=[];if(t.firstElementChild)for(var l=0,d=0;d<t.childNodes.length;d++){var p=t.childNodes[d];3==p.nodeType?(l+=p.data.length,a+=p.data):c.push(l,p)}else a=t.textContent,e.trim&&(a=a.trim());h.render(a,i,o,e.firstLineNumber,!e.showGutter,function(e){s.importCssString(e.css,"ace_highlight"),t.innerHTML=e.html;for(var r=t.firstChild.firstChild,i=0;i<c.length;i+=2){var o=e.session.doc.indexToPosition(c[i]),a=c[i+1],h=r.children[o.row];h&&h.appendChild(a)}n&&n()})};h.render=function(e,n,s,i,o,a){var c,l=1,d=t.prototype.$modes;function p(){var t=h.renderSync(e,n,s,i,o);return a?a(t):t}return"string"==typeof s&&(l++,r.loadModule(["theme",s],function(t){s=t,--l||p()})),n&&"object"==typeof n&&!n.getTokenizer&&(n=(c=n).path),"string"==typeof n&&(l++,r.loadModule(["mode",n],function(t){d[n]&&!c||(d[n]=new t.Mode(c)),n=d[n],--l||p()})),--l||p()},h.renderSync=function(e,r,s,i,o){i=parseInt(i||1,10);var h=new t("");h.setUseWorker(!1),h.setMode(r);var l=new c;l.setSession(h),Object.keys(l.$tabStrings).forEach(function(t){if("string"==typeof l.$tabStrings[t]){var e=a.createFragment();e.textContent=l.$tabStrings[t],l.$tabStrings[t]=e}}),h.setValue(e);var d=h.getLength(),p=a.createElement("div");p.className=s.cssClass;var u=a.createElement("div");u.className="ace_static_highlight"+(o?"":" ace_show_gutter"),u.style["counter-reset"]="ace_line "+(i-1);for(var f=0;f<d;f++){var g=a.createElement("div");if(g.className="ace_line",!o){var m=a.createElement("span");m.className="ace_gutter ace_gutter-cell",m.textContent="",g.appendChild(m)}l.$renderLine(g,f,!1),g.textContent+="\n",u.appendChild(g)}return p.appendChild(u),{css:n+s.cssText,html:p.toString(),session:h}},module.exports=h,module.exports.highlight=h});
//# sourceMappingURL=../sourcemaps/ext/static_highlight.js.map
