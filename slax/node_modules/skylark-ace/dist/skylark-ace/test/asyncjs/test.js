/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){var t=require("ace/lib/oop"),e=require("asyncjs/async");require("asyncjs/utils"),exports.TestGenerator=function(t){e.Generator.call(this,t)},t.inherits(exports.TestGenerator,e.Generator),function(){this.exec=function(){this.run().report().summary(function(t,e){console.log("DONE")})},this.run=function(){return this.setupTest().each(function(t,e){t.setUpSuite?t.setUpSuite(e):e()}).each(function(t,e){t.test(function(n,o){t.err=n,t.passed=o,e()})}).each(function(t,e){t.tearDownSuite?t.tearDownSuite(e):e()})},this.report=function(){return this.each(function(t,e){var n=t.passed?"[32m":"[31m",o=t.name;t.suiteName&&(o=t.suiteName+": "+t.name),console.log(n+"["+t.count+"/"+t.index+"] "+o+" "+(t.passed?"OK":"FAIL")+"[0m"),t.passed||(t.err.stack?console.log(t.err.stack):console.log(t.err)),e()})},this.summary=function(t){var e=0,n=0;this.each(function(t){t.passed?e+=1:n+=1}).end(function(){console.log(""),console.log("Summary:"),console.log(""),console.log("Total number of tests: "+(e+n)),e&&console.log("[32mPassed tests:          "+e+"[0m"),n&&console.log("[31mFailed tests:          "+n+"[0m"),console.log(""),t(null,0==n)})},this.setupTest=function(){return this.each(function(t,n){var o=function(t){t()},s=t.context||this;if(t.setUp)var a=e.makeAsync(0,t.setUp,s);else a=o;if(tearDownCalled=!1,t.tearDown)var r=e.makeAsync(0,t.tearDown,s);else r=o;function i(e){tearDownCalled=!0,r.call(t.context,e)}var c=e.makeAsync(0,t.fn,s);t.test=function(n){var o;e.list([a,c,i]).delay(0).call(s).timeout(t.timeout).toArray(!1,function(t,e){if(!o){o=!0;var s=t[1];n(s,!s)}})},n()})}}.call(exports.TestGenerator.prototype),exports.testcase=function(t,n,o){var s=[];for(var a in t)s.push(a);var r,i=t.setUp||null,c=t.tearDown||null;s.forEach(function(t){">"==t.charAt(0)&&(r=t)}),r&&(s=[r]);var u=s.filter(function(e){return e.match(/^>?test/)&&"function"==typeof t[e]}),l=u.length,f=1;return tests=u.map(function(e){return{suiteName:n||t.name||"",name:e,setUp:i,tearDown:c,context:t,timeout:void 0===o?3e3:o,fn:t[e],count:l,index:f++}}),t.setUpSuite&&(tests[0].setUpSuite=e.makeAsync(0,t.setUpSuite,t)),t.tearDownSuite&&(tests[tests.length-1].tearDownSuite=e.makeAsync(0,t.tearDownSuite,t)),e.list(tests,exports.TestGenerator)}});
//# sourceMappingURL=../../sourcemaps/test/asyncjs/test.js.map
