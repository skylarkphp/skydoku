/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,t,n){"use strict";var i=e("./keys"),o=e("./useragent"),a=null,r=0;t.addListener=function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent){var i=function(){n.call(e,window.event)};n._wrapper=i,e.attachEvent("on"+t,i)}},t.removeListener=function(e,t,n){if(e.removeEventListener)return e.removeEventListener(t,n,!1);e.detachEvent&&e.detachEvent("on"+t,n._wrapper||n)},t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||o.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},t.capture=function(e,n,i){function o(e){n&&n(e),i&&i(e),t.removeListener(document,"mousemove",n,!0),t.removeListener(document,"mouseup",o,!0),t.removeListener(document,"dragstart",o,!0)}return t.addListener(document,"mousemove",n,!0),t.addListener(document,"mouseup",o,!0),t.addListener(document,"dragstart",o,!0),o},t.addTouchMoveListener=function(e,n){var i,o;t.addListener(e,"touchstart",function(e){var t=e.touches[0];i=t.clientX,o=t.clientY}),t.addListener(e,"touchmove",function(e){var t=e.touches;if(!(t.length>1)){var a=t[0];e.wheelX=i-a.clientX,e.wheelY=o-a.clientY,i=a.clientX,o=a.clientY,n(e)}})},t.addMouseWheelListener=function(e,n){"onmousewheel"in e?t.addListener(e,"mousewheel",function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),n(e)}):"onwheel"in e?t.addListener(e,"wheel",function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}n(e)}):t.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),n(e)})},t.addMultiMouseDownListener=function(e,n,i,a){var r,l,u,d=0,c={2:"dblclick",3:"tripleclick",4:"quadclick"};function s(e){if(0!==t.getButton(e)?d=0:e.detail>1?++d>4&&(d=1):d=1,o.isIE){var s=Math.abs(e.clientX-r)>5||Math.abs(e.clientY-l)>5;u&&!s||(d=1),u&&clearTimeout(u),u=setTimeout(function(){u=null},n[d-1]||600),1==d&&(r=e.clientX,l=e.clientY)}if(e._clicks=d,i[a]("mousedown",e),d>4)d=0;else if(d>1)return i[a](c[d],e)}function f(e){d=2,u&&clearTimeout(u),u=setTimeout(function(){u=null},n[d-1]||600),i[a]("mousedown",e),i[a](c[d],e)}Array.isArray(e)||(e=[e]),e.forEach(function(e){t.addListener(e,"mousedown",s),o.isOldIE&&t.addListener(e,"dblclick",f)})};var l=!o.isMac||!o.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};function u(e,t,n){var u=l(t);if(!o.isMac&&a){if(t.getModifierState&&(t.getModifierState("OS")||t.getModifierState("Win"))&&(u|=8),a.altGr){if(3==(3&u))return;a.altGr=0}if(18===n||17===n){var d="location"in t?t.location:t.keyLocation;if(17===n&&1===d)1==a[n]&&(r=t.timeStamp);else if(18===n&&3===u&&2===d){t.timeStamp-r<50&&(a.altGr=!0)}}}if((n in i.MODIFIER_KEYS&&(n=-1),8&u&&n>=91&&n<=93&&(n=-1),!u&&13===n)&&(3===(d="location"in t?t.location:t.keyLocation)&&(e(t,u,-n),t.defaultPrevented)))return;if(o.isChromeOS&&8&u){if(e(t,u,n),t.defaultPrevented)return;u&=-9}return!!(u||n in i.FUNCTION_KEYS||n in i.PRINTABLE_KEYS)&&e(t,u,n)}function d(){a=Object.create(null)}if(t.getModifierString=function(e){return i.KEY_MODS[l(e)]},t.addCommandKeyListener=function(e,n){var i=t.addListener;if(o.isOldGecko||o.isOpera&&!("KeyboardEvent"in window)){var r=null;i(e,"keydown",function(e){r=e.keyCode}),i(e,"keypress",function(e){return u(n,e,r)})}else{var l=null;i(e,"keydown",function(e){a[e.keyCode]=(a[e.keyCode]||0)+1;var t=u(n,e,e.keyCode);return l=e.defaultPrevented,t}),i(e,"keypress",function(e){l&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),l=null)}),i(e,"keyup",function(e){a[e.keyCode]=null}),a||(d(),i(window,"focus",d))}},"object"==typeof window&&window.postMessage&&!o.isOldIE){var c=1;t.nextTick=function(e,n){n=n||window;var i="zero-timeout-message-"+c++,o=function(a){a.data==i&&(t.stopPropagation(a),t.removeListener(n,"message",o),e())};t.addListener(n,"message",o),n.postMessage(i,"*")}}t.$idleBlocked=!1,t.onIdle=function(e,n){return setTimeout(function n(){t.$idleBlocked?setTimeout(n,100):e()},n)},t.$idleBlockId=null,t.blockIdle=function(e){t.$idleBlockId&&clearTimeout(t.$idleBlockId),t.$idleBlocked=!0,t.$idleBlockId=setTimeout(function(){t.$idleBlocked=!1},e||100)},t.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}});
//# sourceMappingURL=../sourcemaps/lib/event.js.map
