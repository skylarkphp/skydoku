/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){"use strict";var e=require("./keys"),t=require("./useragent"),n=null,i=0;exports.addListener=function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent){var i=function(){n.call(e,window.event)};n._wrapper=i,e.attachEvent("on"+t,i)}},exports.removeListener=function(e,t,n){if(e.removeEventListener)return e.removeEventListener(t,n,!1);e.detachEvent&&e.detachEvent("on"+t,n._wrapper||n)},exports.stopEvent=function(e){return exports.stopPropagation(e),exports.preventDefault(e),!1},exports.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},exports.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},exports.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||t.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},exports.capture=function(e,t,n){function i(e){t&&t(e),n&&n(e),exports.removeListener(document,"mousemove",t,!0),exports.removeListener(document,"mouseup",i,!0),exports.removeListener(document,"dragstart",i,!0)}return exports.addListener(document,"mousemove",t,!0),exports.addListener(document,"mouseup",i,!0),exports.addListener(document,"dragstart",i,!0),i},exports.addTouchMoveListener=function(e,t){var n,i;exports.addListener(e,"touchstart",function(e){var t=e.touches[0];n=t.clientX,i=t.clientY}),exports.addListener(e,"touchmove",function(e){var o=e.touches;if(!(o.length>1)){var a=o[0];e.wheelX=n-a.clientX,e.wheelY=i-a.clientY,n=a.clientX,i=a.clientY,t(e)}})},exports.addMouseWheelListener=function(e,t){"onmousewheel"in e?exports.addListener(e,"mousewheel",function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),t(e)}):"onwheel"in e?exports.addListener(e,"wheel",function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}t(e)}):exports.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),t(e)})},exports.addMultiMouseDownListener=function(e,n,i,o){var a,r,l,u=0,d={2:"dblclick",3:"tripleclick",4:"quadclick"};function c(e){if(0!==exports.getButton(e)?u=0:e.detail>1?++u>4&&(u=1):u=1,t.isIE){var c=Math.abs(e.clientX-a)>5||Math.abs(e.clientY-r)>5;l&&!c||(u=1),l&&clearTimeout(l),l=setTimeout(function(){l=null},n[u-1]||600),1==u&&(a=e.clientX,r=e.clientY)}if(e._clicks=u,i[o]("mousedown",e),u>4)u=0;else if(u>1)return i[o](d[u],e)}function s(e){u=2,l&&clearTimeout(l),l=setTimeout(function(){l=null},n[u-1]||600),i[o]("mousedown",e),i[o](d[u],e)}Array.isArray(e)||(e=[e]),e.forEach(function(e){exports.addListener(e,"mousedown",c),t.isOldIE&&exports.addListener(e,"dblclick",s)})};var o=!t.isMac||!t.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};function a(a,r,l){var u=o(r);if(!t.isMac&&n){if(r.getModifierState&&(r.getModifierState("OS")||r.getModifierState("Win"))&&(u|=8),n.altGr){if(3==(3&u))return;n.altGr=0}if(18===l||17===l){var d="location"in r?r.location:r.keyLocation;if(17===l&&1===d)1==n[l]&&(i=r.timeStamp);else if(18===l&&3===u&&2===d){r.timeStamp-i<50&&(n.altGr=!0)}}}if((l in e.MODIFIER_KEYS&&(l=-1),8&u&&l>=91&&l<=93&&(l=-1),!u&&13===l)&&(3===(d="location"in r?r.location:r.keyLocation)&&(a(r,u,-l),r.defaultPrevented)))return;if(t.isChromeOS&&8&u){if(a(r,u,l),r.defaultPrevented)return;u&=-9}return!!(u||l in e.FUNCTION_KEYS||l in e.PRINTABLE_KEYS)&&a(r,u,l)}function r(){n=Object.create(null)}if(exports.getModifierString=function(t){return e.KEY_MODS[o(t)]},exports.addCommandKeyListener=function(e,i){var o=exports.addListener;if(t.isOldGecko||t.isOpera&&!("KeyboardEvent"in window)){var l=null;o(e,"keydown",function(e){l=e.keyCode}),o(e,"keypress",function(e){return a(i,e,l)})}else{var u=null;o(e,"keydown",function(e){n[e.keyCode]=(n[e.keyCode]||0)+1;var t=a(i,e,e.keyCode);return u=e.defaultPrevented,t}),o(e,"keypress",function(e){u&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(exports.stopEvent(e),u=null)}),o(e,"keyup",function(e){n[e.keyCode]=null}),n||(r(),o(window,"focus",r))}},"object"==typeof window&&window.postMessage&&!t.isOldIE){var l=1;exports.nextTick=function(e,t){t=t||window;var n="zero-timeout-message-"+l++,i=function(o){o.data==n&&(exports.stopPropagation(o),exports.removeListener(t,"message",i),e())};exports.addListener(t,"message",i),t.postMessage(n,"*")}}exports.$idleBlocked=!1,exports.onIdle=function(e,t){return setTimeout(function t(){exports.$idleBlocked?setTimeout(t,100):e()},t)},exports.$idleBlockId=null,exports.blockIdle=function(e){exports.$idleBlockId&&clearTimeout(exports.$idleBlockId),exports.$idleBlocked=!0,exports.$idleBlockId=setTimeout(function(){exports.$idleBlocked=!1},e||100)},exports.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),exports.nextFrame?exports.nextFrame=exports.nextFrame.bind(window):exports.nextFrame=function(e){setTimeout(e,17)}});
//# sourceMappingURL=../sourcemaps/lib/event.js.map
