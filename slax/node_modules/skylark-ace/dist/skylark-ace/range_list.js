/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(n,t,r){"use strict";var o=n("./range").Range.comparePoints,s=function(){this.ranges=[]};(function(){this.comparePoints=o,this.pointIndex=function(n,t,r){for(var s=this.ranges,e=r||0;e<s.length;e++){var i=s[e],a=o(n,i.end);if(!(a>0)){var u=o(n,i.start);return 0===a?t&&0!==u?-e-2:e:u>0||0===u&&!t?e:-e-1}}return-e-1},this.add=function(n){var t=!n.isEmpty(),r=this.pointIndex(n.start,t);r<0&&(r=-r-1);var o=this.pointIndex(n.end,t,r);return o<0?o=-o-1:o++,this.ranges.splice(r,o-r,n)},this.addList=function(n){for(var t=[],r=n.length;r--;)t.push.apply(t,this.add(n[r]));return t},this.substractPoint=function(n){var t=this.pointIndex(n);if(t>=0)return this.ranges.splice(t,1)},this.merge=function(){for(var n,t=[],r=this.ranges,s=(r=r.sort(function(n,t){return o(n.start,t.start)}))[0],e=1;e<r.length;e++){n=s,s=r[e];var i=o(n.end,s.start);i<0||(0!=i||n.isEmpty()||s.isEmpty())&&(o(n.end,s.end)<0&&(n.end.row=s.end.row,n.end.column=s.end.column),r.splice(e,1),t.push(s),s=n,e--)}return this.ranges=r,t},this.contains=function(n,t){return this.pointIndex({row:n,column:t})>=0},this.containsPoint=function(n){return this.pointIndex(n)>=0},this.rangeAtPoint=function(n){var t=this.pointIndex(n);if(t>=0)return this.ranges[t]},this.clipRows=function(n,t){var r=this.ranges;if(r[0].start.row>t||r[r.length-1].start.row<n)return[];var o=this.pointIndex({row:n,column:0});o<0&&(o=-o-1);var s=this.pointIndex({row:t,column:0},o);s<0&&(s=-s-1);for(var e=[],i=o;i<s;i++)e.push(r[i]);return e},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(n){this.session&&this.detach(),this.session=n,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(n){for(var t=n.start,r=n.end,o=t.row,s=r.row,e=this.ranges,i=0,a=e.length;i<a;i++){if((h=e[i]).end.row>=o)break}if("insert"==n.action)for(var u=s-o,c=-t.column+r.column;i<a;i++){if((h=e[i]).start.row>o)break;if(h.start.row==o&&h.start.column>=t.column&&(h.start.column==t.column&&this.$insertRight||(h.start.column+=c,h.start.row+=u)),h.end.row==o&&h.end.column>=t.column){if(h.end.column==t.column&&this.$insertRight)continue;h.end.column==t.column&&c>0&&i<a-1&&h.end.column>h.start.column&&h.end.column==e[i+1].start.column&&(h.end.column-=c),h.end.column+=c,h.end.row+=u}}else for(u=o-s,c=t.column-r.column;i<a;i++){if((h=e[i]).start.row>s)break;h.end.row<s&&(o<h.end.row||o==h.end.row&&t.column<h.end.column)?(h.end.row=o,h.end.column=t.column):h.end.row==s?h.end.column<=r.column?(u||h.end.column>t.column)&&(h.end.column=t.column,h.end.row=t.row):(h.end.column+=c,h.end.row+=u):h.end.row>s&&(h.end.row+=u),h.start.row<s&&(o<h.start.row||o==h.start.row&&t.column<h.start.column)?(h.start.row=o,h.start.column=t.column):h.start.row==s?h.start.column<=r.column?(u||h.start.column>t.column)&&(h.start.column=t.column,h.start.row=t.row):(h.start.column+=c,h.start.row+=u):h.start.row>s&&(h.start.row+=u)}if(0!=u&&i<a)for(;i<a;i++){var h;(h=e[i]).start.row+=u,h.end.row+=u}}}).call(s.prototype),t.RangeList=s});
//# sourceMappingURL=sourcemaps/range_list.js.map
