/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(t,e,n){"use strict";var r=t("./config"),s=2e3,i=function(t){for(var e in this.states=t,this.regExps={},this.matchMappings={},this.states){for(var n=this.states[e],r=[],s=0,i=this.matchMappings[e]={defaultToken:"text"},a="g",o=[],h=0;h<n.length;h++){var p=n[h];if(p.defaultToken&&(i.defaultToken=p.defaultToken),p.caseInsensitive&&(a="gi"),null!=p.regex){p.regex instanceof RegExp&&(p.regex=p.regex.toString().slice(1,-1));var l=p.regex,u=new RegExp("(?:("+l+")|(.))").exec("a").length-2;Array.isArray(p.token)?1==p.token.length||1==u?p.token=p.token[0]:u-1!=p.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:p,groupCount:u-1}),p.token=p.token[0]):(p.tokenArray=p.token,p.token=null,p.onMatch=this.$arrayTokens):"function"!=typeof p.token||p.onMatch||(p.onMatch=u>1?this.$applyToken:p.token),u>1&&(/\\\d/.test(p.regex)?l=p.regex.replace(/\\([0-9]+)/g,function(t,e){return"\\"+(parseInt(e,10)+s+1)}):(u=1,l=this.removeCapturingGroups(p.regex)),p.splitRegex||"string"==typeof p.token||o.push(p)),i[s]=h,s+=u,r.push(l),p.onMatch||(p.onMatch=null)}}r.length||(i[0]=0,r.push("$")),o.forEach(function(t){t.splitRegex=this.createSplitterRegexp(t.regex,a)},this),this.regExps[e]=new RegExp("("+r.join(")|(")+")|($)",a)}};(function(){this.$setMaxTokenCount=function(t){s=0|t},this.$applyToken=function(t){var e=this.splitRegex.exec(t).slice(1),n=this.token.apply(this,e);if("string"==typeof n)return[{type:n,value:t}];for(var r=[],s=0,i=n.length;s<i;s++)e[s]&&(r[r.length]={type:n[s],value:e[s]});return r},this.$arrayTokens=function(t){if(!t)return[];var e=this.splitRegex.exec(t);if(!e)return"text";for(var n=[],r=this.tokenArray,s=0,i=r.length;s<i;s++)e[s+1]&&(n[n.length]={type:r[s],value:e[s+1]});return n},this.removeCapturingGroups=function(t){return t.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!]|(\()/g,function(t,e){return e?"(?:":t})},this.createSplitterRegexp=function(t,e){if(-1!=t.indexOf("(?=")){var n=0,r=!1,s={};t.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(t,e,i,a,o,h){return r?r="]"!=o:o?r=!0:a?(n==s.stack&&(s.end=h+1,s.stack=-1),n--):i&&(n++,1!=i.length&&(s.stack=n,s.start=h)),t}),null!=s.end&&/^\)*$/.test(t.substr(s.end))&&(t=t.substring(0,s.start)+t.substr(s.end))}return"^"!=t.charAt(0)&&(t="^"+t),"$"!=t.charAt(t.length-1)&&(t+="$"),new RegExp(t,(e||"").replace("g",""))},this.getLineTokens=function(t,e){if(e&&"string"!=typeof e)"#tmp"===(e=(n=e.slice(0))[0])&&(n.shift(),e=n.shift());else var n=[];var r=e||"start",i=this.states[r];i||(r="start",i=this.states[r]);var a=this.matchMappings[r],o=this.regExps[r];o.lastIndex=0;for(var h,p=[],l=0,u=0,g={type:null,value:""};h=o.exec(t);){var f=a.defaultToken,c=null,x=h[0],k=o.lastIndex;if(k-x.length>l){var v=t.substring(l,k-x.length);g.type==f?g.value+=v:(g.type&&p.push(g),g={type:f,value:v})}for(var y=0;y<h.length-2;y++)if(void 0!==h[y+1]){f=(c=i[a[y]]).onMatch?c.onMatch(x,r,n,t):c.token,c.next&&(r="string"==typeof c.next?c.next:c.next(r,n),(i=this.states[r])||(this.reportError("state doesn't exist",r),r="start",i=this.states[r]),a=this.matchMappings[r],l=k,(o=this.regExps[r]).lastIndex=k),c.consumeLineEnd&&(l=k);break}if(x)if("string"==typeof f)c&&!1===c.merge||g.type!==f?(g.type&&p.push(g),g={type:f,value:x}):g.value+=x;else if(f){g.type&&p.push(g),g={type:null,value:""};for(y=0;y<f.length;y++)p.push(f[y])}if(l==t.length)break;if(l=k,u++>s){for(u>2*t.length&&this.reportError("infinite loop with in ace tokenizer",{startState:e,line:t});l<t.length;)g.type&&p.push(g),g={value:t.substring(l,l+=2e3),type:"overflow"};r="start",n=[];break}}return g.type&&p.push(g),n.length>1&&n[0]!==r&&n.unshift("#tmp",r),{tokens:p,state:n.length?n:r}},this.reportError=r.reportError}).call(i.prototype),e.Tokenizer=i});
//# sourceMappingURL=sourcemaps/tokenizer.js.map
