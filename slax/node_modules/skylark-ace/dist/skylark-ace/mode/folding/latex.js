/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){"use strict";var e=require("../../lib/oop"),t=require("./fold_mode").FoldMode,n=require("../../range").Range,r=require("../../token_iterator").TokenIterator,a={"\\subparagraph":1,"\\paragraph":2,"\\subsubsubsection":3,"\\subsubsection":4,"\\subsection":5,"\\section":6,"\\chapter":7,"\\part":8,"\\begin":9,"\\end":10},o=exports.FoldMode=function(){};e.inherits(o,t),function(){this.foldingStartMarker=/^\s*\\(begin)|\s*\\(part|chapter|(?:sub)*(?:section|paragraph))\b|{\s*$/,this.foldingStopMarker=/^\s*\\(end)\b|^\s*}/,this.getFoldWidgetRange=function(e,t,n){var r,a=e.doc.getLine(n);return(r=this.foldingStartMarker.exec(a))?r[1]?this.latexBlock(e,n,r[0].length-1):r[2]?this.latexSection(e,n,r[0].length-1):this.openingBracketBlock(e,"{",n,r.index):(r=this.foldingStopMarker.exec(a))?r[1]?this.latexBlock(e,n,r[0].length-1):this.closingBracketBlock(e,"}",n,r.index+r[0].length):void 0},this.latexBlock=function(e,t,a,o){var i={"\\begin":1,"\\end":-1},s=new r(e,t,a),g=s.getCurrentToken();if(g&&("storage.type"==g.type||"constant.character.escape"==g.type)){var c=i[g.value],l=function(){var e="lparen"==s.stepForward().type?s.stepForward().value:"";return-1===c&&(s.stepBackward(),e&&s.stepBackward()),e},p=[l()],u=-1===c?s.getCurrentTokenColumn():e.getLine(t).length,h=t;for(s.step=-1===c?s.stepBackward:s.stepForward;g=s.step();)if(g&&("storage.type"==g.type||"constant.character.escape"==g.type)){var f=i[g.value];if(f){var d=l();if(f===c)p.unshift(d);else if(p.shift()!==d||!p.length)break}}if(!p.length){if(1==c&&(s.stepBackward(),s.stepBackward()),o)return s.getCurrentTokenRange();t=s.getCurrentTokenRow();return-1===c?new n(t,e.getLine(t).length,h,u):new n(h,u,t,s.getCurrentTokenColumn())}}},this.latexSection=function(e,t,o){var i=new r(e,t,o),s=i.getCurrentToken();if(s&&"storage.type"==s.type){for(var g=a[s.value]||0,c=0,l=t;s=i.stepForward();)if("storage.type"===s.type){var p=a[s.value]||0;if(p>=9){if(c||(l=i.getCurrentTokenRow()-1),(c+=9==p?1:-1)<0)break}else if(p>=g)break}for(c||(l=i.getCurrentTokenRow()-1);l>t&&!/\S/.test(e.getLine(l));)l--;return new n(t,e.getLine(t).length,l,e.getLine(l).length)}}}.call(o.prototype)});
//# sourceMappingURL=../../sourcemaps/mode/folding/latex.js.map
