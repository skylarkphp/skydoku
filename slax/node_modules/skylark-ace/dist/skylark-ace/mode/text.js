/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){"use strict";var t=require("../config"),e=require("../tokenizer").Tokenizer,n=require("./text_highlight_rules").TextHighlightRules,r=require("./behaviour/cstyle").CstyleBehaviour,i=require("../unicode"),o=require("../lib/lang"),s=require("../token_iterator").TokenIterator,h=require("../range").Range,a=function(){this.HighlightRules=n};(function(){this.$defaultBehaviour=new r,this.tokenRe=new RegExp("^["+i.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+i.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new e(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(t,e,n,r){var i=e.doc,s=!0,h=!0,a=1/0,l=e.getTabSize(),u=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))d=this.lineCommentStart.map(o.escapeRegExp).join("|"),m=this.lineCommentStart[0];else d=o.escapeRegExp(this.lineCommentStart),m=this.lineCommentStart;d=new RegExp("^(\\s*)(?:"+d+") ?"),u=e.getUseSoftTabs();k=function(t,e){var n=t.match(d);if(n){var r=n[1].length,o=n[0].length;c(t,r,o)||" "!=n[0][o-1]||o--,i.removeInLine(e,r,o)}};var g=m+" ",c=(p=function(t,e){s&&!/\S/.test(t)||(c(t,a,a)?i.insertInLine({row:e,column:a},g):i.insertInLine({row:e,column:a},m))},$=function(t,e){return d.test(t)},function(t,e,n){for(var r=0;e--&&" "==t.charAt(e);)r++;if(r%l!=0)return!1;for(r=0;" "==t.charAt(n++);)r++;return l>2?r%l!=l-1:r%l==0})}else{if(!this.blockComment)return!1;var m=this.blockComment.start,f=this.blockComment.end,d=new RegExp("^(\\s*)(?:"+o.escapeRegExp(m)+")"),v=new RegExp("(?:"+o.escapeRegExp(f)+")\\s*$"),p=function(t,e){$(t,e)||s&&!/\S/.test(t)||(i.insertInLine({row:e,column:t.length},f),i.insertInLine({row:e,column:a},m))},k=function(t,e){var n;(n=t.match(v))&&i.removeInLine(e,t.length-n[0].length,t.length),(n=t.match(d))&&i.removeInLine(e,n[1].length,n[0].length)},$=function(t,n){if(d.test(t))return!0;for(var r=e.getTokens(n),i=0;i<r.length;i++)if("comment"===r[i].type)return!0}}function w(t){for(var e=n;e<=r;e++)t(i.getLine(e),e)}var y=1/0;w(function(t,e){var n=t.search(/\S/);-1!==n?(n<a&&(a=n),h&&!$(t,e)&&(h=!1)):y>t.length&&(y=t.length)}),a==1/0&&(a=y,s=!1,h=!1),u&&a%l!=0&&(a=Math.floor(a/l)*l),w(h?k:p)},this.toggleBlockComment=function(t,e,n,r){var i=this.blockComment;if(i){!i.start&&i[0]&&(i=i[0]);var o,a,l=(d=new s(e,r.row,r.column)).getCurrentToken(),u=(e.selection,e.selection.toOrientedRange());if(l&&/comment/.test(l.type)){for(var g,c;l&&/comment/.test(l.type);){if(-1!=(v=l.value.indexOf(i.start))){var m=d.getCurrentTokenRow(),f=d.getCurrentTokenColumn()+v;g=new h(m,f,m,f+i.start.length);break}l=d.stepBackward()}var d;for(l=(d=new s(e,r.row,r.column)).getCurrentToken();l&&/comment/.test(l.type);){var v;if(-1!=(v=l.value.indexOf(i.end))){m=d.getCurrentTokenRow(),f=d.getCurrentTokenColumn()+v;c=new h(m,f,m,f+i.end.length);break}l=d.stepForward()}c&&e.remove(c),g&&(e.remove(g),o=g.start.row,a=-i.start.length)}else a=i.start.length,o=n.start.row,e.insert(n.end,i.end),e.insert(n.start,i.start);u.start.row==o&&(u.start.column+=a),u.end.row==o&&(u.end.column+=a),e.selection.fromOrientedRange(u)}},this.getNextLineIndent=function(t,e,n){return this.$getIndent(e)},this.checkOutdent=function(t,e,n){return!1},this.autoOutdent=function(t,e,n){},this.$getIndent=function(t){return t.match(/^\s*/)[0]},this.createWorker=function(t){return null},this.createModeDelegates=function(e){for(var n in this.$embeds=[],this.$modes={},e)if(e[n]){var r=e[n],i=r.prototype.$id,o=t.$modes[i];o||(t.$modes[i]=o=new r),t.$modes[n]||(t.$modes[n]=o),this.$embeds.push(n),this.$modes[n]=o}var s=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(n=0;n<s.length;n++)!function(t){var e=s[n],r=t[e];t[s[n]]=function(){return this.$delegator(e,arguments,r)}}(this)},this.$delegator=function(t,e,n){var r=e[0]||"start";if("string"!=typeof r){if(Array.isArray(r[2])){var i=r[2][r[2].length-1];if(s=this.$modes[i])return s[t].apply(s,[r[1]].concat([].slice.call(e,1)))}r=r[0]||"start"}for(var o=0;o<this.$embeds.length;o++)if(this.$modes[this.$embeds[o]]){var s,h=r.split(this.$embeds[o]);if(!h[0]&&h[1])return e[0]=h[1],(s=this.$modes[this.$embeds[o]])[t].apply(s,e)}var a=n.apply(this,e);return n?a:void 0},this.transformAction=function(t,e,n,r,i){if(this.$behaviour){var o=this.$behaviour.getBehaviours();for(var s in o)if(o[s][e]){var h=o[s][e].apply(this,arguments);if(h)return h}}},this.getKeywords=function(t){if(!this.completionKeywords){var e=this.$tokenizer.rules,n=[];for(var r in e)for(var i=e[r],o=0,s=i.length;o<s;o++)if("string"==typeof i[o].token)/keyword|support|storage/.test(i[o].token)&&n.push(i[o].regex);else if("object"==typeof i[o].token)for(var h=0,a=i[o].token.length;h<a;h++)if(/keyword|support|storage/.test(i[o].token[h])){r=i[o].regex.match(/\(.+?\)/g)[h];n.push(r.substr(1,r.length-2))}this.completionKeywords=n}return t?n.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(t,e,n,r){return(this.$keywordList||this.$createKeywordList()).map(function(t){return{name:t,value:t,score:0,meta:"keyword"}})},this.$id="ace/mode/text"}).call(a.prototype),exports.Mode=a});
//# sourceMappingURL=../sourcemaps/mode/text.js.map
