/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,n,t){!function(e){"use strict";var n,t,r;e.version="0.1.4";var a=e.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1},i=1,u=2,o=4,c=8,s=16,l=32,f=64,p=128,h=256;e.tokenTypes={EOF:i,StringLiteral:u,Keyword:o,Identifier:c,NumericLiteral:s,Punctuator:l,BooleanLiteral:f,NilLiteral:p,VarargLiteral:h};var d=e.errors={unexpected:"Unexpected %1 '%2' near '%3'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'"},m=e.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,n){return{type:"IfClause",condition:e,body:n}},elseifClause:function(e,n){return{type:"ElseifClause",condition:e,body:n}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,n){return{type:"WhileStatement",condition:e,body:n}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,n){return{type:"RepeatStatement",condition:e,body:n}},localStatement:function(e,n){return{type:"LocalStatement",variables:e,init:n}},assignmentStatement:function(e,n){return{type:"AssignmentStatement",variables:e,init:n}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,n,t,r){return{type:"FunctionDeclaration",identifier:e,isLocal:t,parameters:n,body:r}},forNumericStatement:function(e,n,t,r,a){return{type:"ForNumericStatement",variable:e,start:n,end:t,step:r,body:a}},forGenericStatement:function(e,n,t){return{type:"ForGenericStatement",variables:e,iterators:n,body:t}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,n,t){return{type:e=e===u?"StringLiteral":e===s?"NumericLiteral":e===f?"BooleanLiteral":e===p?"NilLiteral":"VarargLiteral",value:n,raw:t}},tableKey:function(e,n){return{type:"TableKey",key:e,value:n}},tableKeyString:function(e,n){return{type:"TableKeyString",key:e,value:n}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,n,t){var r="and"===e||"or"===e?"LogicalExpression":"BinaryExpression";return{type:r,operator:e,left:n,right:t}},unaryExpression:function(e,n){return{type:"UnaryExpression",operator:e,argument:n}},memberExpression:function(e,n,t){return{type:"MemberExpression",indexer:n,identifier:t,base:e}},indexExpression:function(e,n){return{type:"IndexExpression",base:e,index:n}},callExpression:function(e,n){return{type:"CallExpression",base:e,arguments:n}},tableCallExpression:function(e,n){return{type:"TableCallExpression",base:e,arguments:n}},stringCallExpression:function(e,n){return{type:"StringCallExpression",base:e,argument:n}},comment:function(e,n){return{type:"Comment",value:e,raw:n}}};function v(e){if(_){var n=ee.pop();n.complete(),t.locations&&(e.loc=n.loc),t.ranges&&(e.range=n.range)}return e}var y,b,g,x,S,C,A,E,w,k,L,O=Array.prototype.slice,N=(Object.prototype.toString,function(e,n){for(var t=0,r=e.length;t<r;t++)if(e[t]===n)return t;return-1});function T(e){var n=O.call(arguments,1);return e=e.replace(/%(\d)/g,function(e,t){return""+n[t-1]||""})}function I(e){var n,t,r=T.apply(null,O.call(arguments,1));throw void 0!==e.line?(t=e.range[0]-e.lineStart,(n=new SyntaxError(T("[%1:%2] %3",e.line,t,r))).line=e.line,n.index=e.range[0],n.column=t):(t=y-E+1,(n=new SyntaxError(T("[%1:%2] %3",A,t,r))).index=y,n.line=A,n.column=t),n}function K(e,n){I(n,d.expectedToken,e,n.value)}function V(e,n){if(void 0===n&&(n=x.value),void 0!==e.type){var t;switch(e.type){case u:t="string";break;case o:t="keyword";break;case c:t="identifier";break;case s:t="number";break;case l:t="symbol";break;case f:t="boolean";break;case p:return I(e,d.unexpected,"symbol","nil",n)}return I(e,d.unexpected,t,e.value,n)}return I(e,d.unexpected,"symbol",e,n)}function F(){for(B();45===n.charCodeAt(y)&&45===n.charCodeAt(y+1);)j(),B();if(y>=r)return{type:i,value:"<eof>",line:A,lineStart:E,range:[y,y]};var e,t=n.charCodeAt(y),a=n.charCodeAt(y+1);if(C=y,function(e){return e>=65&&e<=90||e>=97&&e<=122||95===e}(t))return function(){for(var e,t,r;(r=n.charCodeAt(++y))>=65&&r<=90||r>=97&&r<=122||95===r||r>=48&&r<=57;);return!function(e){switch(e.length){case 2:return"do"===e||"if"===e||"in"===e||"or"===e;case 3:return"and"===e||"end"===e||"for"===e||"not"===e;case 4:return"else"===e||"goto"===e||"then"===e;case 5:return"break"===e||"local"===e||"until"===e||"while"===e;case 6:return"elseif"===e||"repeat"===e||"return"===e;case 8:return"function"===e}return!1}(e=n.slice(C,y))?"true"===e||"false"===e?(t=f,e="true"===e):"nil"===e?(t=p,e=null):t=c:t=o,{type:t,value:e,line:A,lineStart:E,range:[C,y]}}();switch(t){case 39:case 34:return function(){for(var e,t=n.charCodeAt(y++),a=y,i="";y<r&&(e=n.charCodeAt(y++),t!==e);)92===e?(i+=n.slice(a,y-1)+P(),a=y):(y>=r||X(e))&&(i+=n.slice(a,y-1),I({},d.unfinishedString,i+String.fromCharCode(e)));return i+=n.slice(a,y-1),{type:u,value:i,line:A,lineStart:E,range:[C,y]}}();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return M();case 46:return q(a)?M():46===a?46===n.charCodeAt(y+2)?{type:h,value:"...",line:A,lineStart:E,range:[C,y+=3]}:G(".."):G(".");case 61:return G(61===a?"==":"=");case 62:return G(61===a?">=":">");case 60:return G(61===a?"<=":"<");case 126:return G(61===a?"~=":"~");case 58:return G(58===a?"::":":");case 91:return 91===a||61===a?(!1===(e=D())&&I(b,d.expected,"[",b.value),{type:u,value:e,line:A,lineStart:E,range:[C,y]}):G("[");case 42:case 47:case 94:case 37:case 44:case 123:case 125:case 93:case 40:case 41:case 59:case 35:case 45:case 43:case 38:case 124:return G(n.charAt(y))}return V(n.charAt(y))}function B(){for(;y<r;){var e=n.charCodeAt(y);if(W(e))y++;else{if(!X(e))break;A++,E=++y}}}function G(e){return y+=e.length,{type:l,value:e,line:A,lineStart:E,range:[C,y]}}function M(){var e=n.charAt(y),t=n.charAt(y+1),r="0"===e&&"xX".indexOf(t||null)>=0?function(){var e,t,r,a,i=0,u=1,o=1;for(a=y+=2,H(n.charCodeAt(y))||I({},d.malformedNumber,n.slice(C,y));H(n.charCodeAt(y));)y++;if(e=parseInt(n.slice(a,y),16),"."===n.charAt(y)){for(t=++y;H(n.charCodeAt(y));)y++;i=n.slice(t,y),i=t===y?0:parseInt(i,16)/Math.pow(16,y-t)}if("pP".indexOf(n.charAt(y)||null)>=0){for(y++,"+-".indexOf(n.charAt(y)||null)>=0&&(o="+"===n.charAt(y++)?1:-1),r=y,q(n.charCodeAt(y))||I({},d.malformedNumber,n.slice(C,y));q(n.charCodeAt(y));)y++;u=n.slice(r,y),u=Math.pow(2,u*o)}return(e+i)*u}():function(){for(;q(n.charCodeAt(y));)y++;if("."===n.charAt(y))for(y++;q(n.charCodeAt(y));)y++;if("eE".indexOf(n.charAt(y)||null)>=0)for(y++,"+-".indexOf(n.charAt(y)||null)>=0&&y++,q(n.charCodeAt(y))||I({},d.malformedNumber,n.slice(C,y));q(n.charCodeAt(y));)y++;return parseFloat(n.slice(C,y))}();return{type:s,value:r,line:A,lineStart:E,range:[C,y]}}function P(){var e=y;switch(n.charAt(y)){case"n":return y++,"\n";case"r":return y++,"\r";case"t":return y++,"\t";case"v":return y++,"\v";case"b":return y++,"\b";case"f":return y++,"\f";case"z":return y++,B(),"";case"x":return H(n.charCodeAt(y+1))&&H(n.charCodeAt(y+2))?(y+=3,"\\"+n.slice(e,y)):"\\"+n.charAt(y++);default:if(q(n.charCodeAt(y))){for(;q(n.charCodeAt(++y)););return"\\"+n.slice(e,y)}return n.charAt(y++)}}function j(){C=y,y+=2;var e=n.charAt(y),a="",i=!1,u=y,o=E,c=A;if("["===e&&(!1===(a=D())?a=e:i=!0),!i){for(;y<r&&!X(n.charCodeAt(y));)y++;t.comments&&(a=n.slice(u,y))}if(t.comments){var s=m.comment(a,n.slice(C,y));t.locations&&(s.loc={start:{line:c,column:C-o},end:{line:A,column:y-E}}),t.ranges&&(s.range=[C,y]),S.push(s)}}function D(){var e,t,a=0,i="",u=!1;for(y++;"="===n.charAt(y+a);)a++;if("["!==n.charAt(y+a))return!1;for(y+=a+1,X(n.charCodeAt(y))&&(A++,E=y++),t=y;y<r;){if(X((e=n.charAt(y++)).charCodeAt(0))&&(A++,E=y),"]"===e){u=!0;for(var o=0;o<a;o++)"="!==n.charAt(y+o)&&(u=!1);"]"!==n.charAt(y+a)&&(u=!1)}if(u)break}return i+=n.slice(t,y-1),y+=a+1,i}function R(){g=b,b=x,x=F()}function U(e){return e===b.value&&(R(),!0)}function z(e){e===b.value?R():I(b,d.expected,e,b.value)}function W(e){return 9===e||32===e||11===e||12===e}function X(e){return 10===e||13===e}function q(e){return e>=48&&e<=57}function H(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function J(e){if(i===e.type)return!0;if(o!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}function Q(e){-1===N(w[k],e)&&w[k].push(e)}function Y(e){Q(e.name),Z(e,!0)}function Z(e,n){n||-1!==function(e,n,t){for(var r=0,a=e.length;r<a;r++)if(e[r][n]===t)return r;return-1}(L,"name",e.name)||L.push(e),e.isLocal=n}function $(e){return-1!==N(w[k],e)}e.lex=F;var _,ee=[];function ne(){return new te(b)}function te(e){t.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),t.ranges&&(this.range=[e.range[0],0])}function re(){_&&ee.push(ne())}function ae(e){_&&ee.push(e)}function ie(e){var n,r=[];for(t.scope&&w.push(Array.apply(null,w[k++]));!J(b);){if("return"===b.value){r.push(ue());break}(n=ue())&&r.push(n)}return t.scope&&(w.pop(),k--),r}function ue(){if(re(),o===b.type)switch(b.value){case"local":return R(),function(){var e;if(c===b.type){var n=[],r=[];do{e=oe(),n.push(e)}while(U(","));if(U("="))do{var a=fe();r.push(a)}while(U(","));if(t.scope)for(var i=0,u=n.length;i<u;i++)Y(n[i]);return v(m.localStatement(n,r))}if(U("function"))return e=oe(),t.scope&&Y(e),ce(e,!0);K("<name>",b)}();case"if":return R(),function(){var e,n,t,r=[];for(_&&(t=ee[ee.length-1],ee.push(t)),e=fe(),z("then"),n=ie(),r.push(v(m.ifClause(e,n))),_&&(t=ne());U("elseif");)ae(t),e=fe(),z("then"),n=ie(),r.push(v(m.elseifClause(e,n))),_&&(t=ne());return U("else")&&(_&&(t=new te(g),ee.push(t)),n=ie(),r.push(v(m.elseClause(n)))),z("end"),v(m.ifStatement(r))}();case"return":return R(),function(){var e=[];if("end"!==b.value){var n=le();for(null!=n&&e.push(n);U(",");)n=fe(),e.push(n);U(";")}return v(m.returnStatement(e))}();case"function":R();var e=function(){var e,n,r;for(_&&(r=ne()),e=oe(),t.scope&&Z(e,!1);U(".");)ae(r),n=oe(),t.scope&&Z(n,!1),e=v(m.memberExpression(e,".",n));return U(":")&&(ae(r),n=oe(),t.scope&&Z(n,!1),e=v(m.memberExpression(e,":",n))),e}();return ce(e);case"while":return R(),function(){var e=fe();z("do");var n=ie();return z("end"),v(m.whileStatement(e,n))}();case"for":return R(),function(){var e,n=oe();if(t.scope&&Y(n),U("=")){var r=fe();z(",");var a=fe(),i=U(",")?fe():null;return z("do"),e=ie(),z("end"),v(m.forNumericStatement(n,r,a,i,e))}for(var u=[n];U(",");)n=oe(),t.scope&&Y(n),u.push(n);z("in");var o=[];do{var c=fe();o.push(c)}while(U(","));return z("do"),e=ie(),z("end"),v(m.forGenericStatement(u,o,e))}();case"repeat":return R(),function(){var e=ie();z("until");var n=fe();return v(m.repeatStatement(n,e))}();case"break":return R(),v(m.breakStatement());case"do":return R(),n=ie(),z("end"),v(m.doStatement(n));case"goto":return R(),function(){var e=b.value,n=oe();return t.scope&&(n.isLabel=$("::"+e+"::")),v(m.gotoStatement(n))}()}var n;return l===b.type&&U("::")?function(){var e=b.value,n=oe();return t.scope&&(Q("::"+e+"::"),Z(n,!0)),z("::"),v(m.labelStatement(n))}():(_&&ee.pop(),U(";")?void 0:function(){var e,n,t=b;if(_&&(n=ne()),null==(e=he()))return V(b);if(",=".indexOf(b.value)>=0){for(var r,a=[e],i=[];U(",");)null==(r=he())&&K("<expression>",b),a.push(r);z("=");do{r=fe(),i.push(r)}while(U(","));return ae(n),v(m.assignmentStatement(a,i))}return function(e){switch(e.type){case"CallExpression":case"TableCallExpression":case"StringCallExpression":return!0}return!1}(e)?(ae(n),v(m.callStatement(e))):V(t)}())}function oe(){re();var e=b.value;return c!==b.type&&K("<name>",b),R(),v(m.identifier(e))}function ce(e,n){var r=[];if(z("("),!U(")"))for(;;)if(c===b.type){var a=oe();if(t.scope&&Y(a),r.push(a),U(","))continue;if(U(")"))break}else{if(h===b.type){r.push(me()),z(")");break}K("<name> or '...'",b)}var i=ie();return z("end"),n=n||!1,v(m.functionStatement(e,r,n,i))}function se(){for(var e,n,t=[];;){if(re(),l===b.type&&U("["))e=fe(),z("]"),z("="),n=fe(),t.push(v(m.tableKey(e,n)));else if(c===b.type)e=fe(),U("=")?(n=fe(),t.push(v(m.tableKeyString(e,n)))):t.push(v(m.tableValue(e)));else{if(null==(n=le())){ee.pop();break}t.push(v(m.tableValue(n)))}if(",;".indexOf(b.value)>=0)R();else if("}"===b.value)break}return z("}"),v(m.tableConstructorExpression(t))}function le(){var e=function e(n){var t,r,a,i=b.value;if(_&&(r=ne()),function(e){return l===e.type?"#-~".indexOf(e.value)>=0:o===e.type&&"not"===e.value}(b)){re(),R();var u=e(8);null==u&&K("<expression>",b),t=v(m.unaryExpression(i,u))}if(null==t&&null==(t=me())&&(t=he()),null==t)return null;for(;i=b.value,!(0===(a=l===b.type||o===b.type?pe(i):0)||a<=n);){"^"!==i&&".."!==i||a--,R();var c=e(a);null==c&&K("<expression>",b),_&&ee.push(r),t=v(m.binaryExpression(i,t,c))}return t}(0);return e}function fe(){var e=le();if(null!=e)return e;K("<expression>",b)}function pe(e){var n=e.charCodeAt(0),t=e.length;if(1===t)switch(n){case 94:return 10;case 42:case 47:case 37:return 7;case 43:case 45:return 6;case 60:case 62:return 3;case 38:case 124:return 7}else if(2===t)switch(n){case 46:return 5;case 60:case 62:case 61:case 126:return 3;case 111:return 1}else if(97===n&&"and"===e)return 2;return 0}function he(){var e,n,r,a,i,o;if(_&&(r=ne()),c===b.type)n=b.value,e=oe(),t.scope&&Z(e,a=$(n));else{if(!U("("))return null;e=fe(),z(")"),t.scope&&(a=e.isLocal)}for(;;)if(l===b.type)switch(b.value){case"[":ae(r),R(),i=fe(),e=v(m.indexExpression(e,i)),z("]");break;case".":ae(r),R(),o=oe(),t.scope&&Z(o,a),e=v(m.memberExpression(e,".",o));break;case":":ae(r),R(),o=oe(),t.scope&&Z(o,a),e=v(m.memberExpression(e,":",o)),ae(r),e=de(e);break;case"(":case"{":ae(r),e=de(e);break;default:return e}else{if(u!==b.type)break;ae(r),e=de(e)}return e}function de(e){if(l===b.type)switch(b.value){case"(":R();var n=[],t=le();for(null!=t&&n.push(t);U(",");)t=fe(),n.push(t);return z(")"),v(m.callExpression(e,n));case"{":re(),R();var r=se();return v(m.tableCallExpression(e,r))}else if(u===b.type)return v(m.stringCallExpression(e,me()));K("function arguments",b)}function me(){var e,t=u|s|f|p|h,r=b.value,a=b.type;if(_&&(e=ne()),a&t){ae(e);var i=n.slice(b.range[0],b.range[1]);return R(),v(m.literal(a,r,i))}return o===a&&"function"===r?(ae(e),R(),ce(null)):U("{")?(ae(e),se()):void 0}function ve(t){return n+=String(t),r=n.length,e}function ye(e){void 0!==e&&ve(e),r=n.length,_=t.locations||t.ranges,x=F();var a=function(){R(),re();var e=ie();return i!==b.type&&V(b),_&&!e.length&&(g=b),v(m.chunk(e))}();if(t.comments&&(a.comments=S),t.scope&&(a.globals=L),ee.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return a}te.prototype.complete=function(){t.locations&&(this.loc.end.line=g.line,this.loc.end.column=g.range[1]-g.lineStart),t.ranges&&(this.range[1]=g.range[1])},e.parse=function(i,u){return void 0===u&&"object"==typeof i&&(u=i,i=void 0),u||(u={}),n=i||"",t=function(){for(var e,n,t=O.call(arguments),r={},a=0,i=t.length;a<i;a++)for(n in e=t[a])e.hasOwnProperty(n)&&(r[n]=e[n]);return r}(a,u),y=0,A=1,E=0,r=n.length,w=[[]],k=0,L=[],ee=[],t.comments&&(S=[]),t.wait?e:ye()},e.write=ve,e.end=ye}(n)});
//# sourceMappingURL=../../sourcemaps/mode/lua/luaparse.js.map
