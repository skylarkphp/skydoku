/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){!function(exports){"use strict";var e,n,t;exports.version="0.1.4";var r=exports.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1},a=1,i=2,u=4,o=8,c=16,s=32,l=64,f=128,p=256;exports.tokenTypes={EOF:a,StringLiteral:i,Keyword:u,Identifier:o,NumericLiteral:c,Punctuator:s,BooleanLiteral:l,NilLiteral:f,VarargLiteral:p};var h=exports.errors={unexpected:"Unexpected %1 '%2' near '%3'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'"},d=exports.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,n){return{type:"IfClause",condition:e,body:n}},elseifClause:function(e,n){return{type:"ElseifClause",condition:e,body:n}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,n){return{type:"WhileStatement",condition:e,body:n}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,n){return{type:"RepeatStatement",condition:e,body:n}},localStatement:function(e,n){return{type:"LocalStatement",variables:e,init:n}},assignmentStatement:function(e,n){return{type:"AssignmentStatement",variables:e,init:n}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,n,t,r){return{type:"FunctionDeclaration",identifier:e,isLocal:t,parameters:n,body:r}},forNumericStatement:function(e,n,t,r,a){return{type:"ForNumericStatement",variable:e,start:n,end:t,step:r,body:a}},forGenericStatement:function(e,n,t){return{type:"ForGenericStatement",variables:e,iterators:n,body:t}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,n,t){return{type:e=e===i?"StringLiteral":e===c?"NumericLiteral":e===l?"BooleanLiteral":e===f?"NilLiteral":"VarargLiteral",value:n,raw:t}},tableKey:function(e,n){return{type:"TableKey",key:e,value:n}},tableKeyString:function(e,n){return{type:"TableKeyString",key:e,value:n}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,n,t){var r="and"===e||"or"===e?"LogicalExpression":"BinaryExpression";return{type:r,operator:e,left:n,right:t}},unaryExpression:function(e,n){return{type:"UnaryExpression",operator:e,argument:n}},memberExpression:function(e,n,t){return{type:"MemberExpression",indexer:n,identifier:t,base:e}},indexExpression:function(e,n){return{type:"IndexExpression",base:e,index:n}},callExpression:function(e,n){return{type:"CallExpression",base:e,arguments:n}},tableCallExpression:function(e,n){return{type:"TableCallExpression",base:e,arguments:n}},stringCallExpression:function(e,n){return{type:"StringCallExpression",base:e,argument:n}},comment:function(e,n){return{type:"Comment",value:e,raw:n}}};function m(e){if($){var t=_.pop();t.complete(),n.locations&&(e.loc=t.loc),n.ranges&&(e.range=t.range)}return e}var v,y,b,g,x,S,C,A,E,w,k,L=Array.prototype.slice,O=(Object.prototype.toString,function(e,n){for(var t=0,r=e.length;t<r;t++)if(e[t]===n)return t;return-1});function N(e){var n=L.call(arguments,1);return e=e.replace(/%(\d)/g,function(e,t){return""+n[t-1]||""})}function T(e){var n,t,r=N.apply(null,L.call(arguments,1));throw void 0!==e.line?(t=e.range[0]-e.lineStart,(n=new SyntaxError(N("[%1:%2] %3",e.line,t,r))).line=e.line,n.index=e.range[0],n.column=t):(t=v-A+1,(n=new SyntaxError(N("[%1:%2] %3",C,t,r))).index=v,n.line=C,n.column=t),n}function I(e,n){T(n,h.expectedToken,e,n.value)}function K(e,n){if(void 0===n&&(n=g.value),void 0!==e.type){var t;switch(e.type){case i:t="string";break;case u:t="keyword";break;case o:t="identifier";break;case c:t="number";break;case s:t="symbol";break;case l:t="boolean";break;case f:return T(e,h.unexpected,"symbol","nil",n)}return T(e,h.unexpected,t,e.value,n)}return T(e,h.unexpected,"symbol",e,n)}function V(){for(F();45===e.charCodeAt(v)&&45===e.charCodeAt(v+1);)P(),F();if(v>=t)return{type:a,value:"<eof>",line:C,lineStart:A,range:[v,v]};var n,r=e.charCodeAt(v),c=e.charCodeAt(v+1);if(S=v,function(e){return e>=65&&e<=90||e>=97&&e<=122||95===e}(r))return function(){for(var n,t,r;(r=e.charCodeAt(++v))>=65&&r<=90||r>=97&&r<=122||95===r||r>=48&&r<=57;);return!function(e){switch(e.length){case 2:return"do"===e||"if"===e||"in"===e||"or"===e;case 3:return"and"===e||"end"===e||"for"===e||"not"===e;case 4:return"else"===e||"goto"===e||"then"===e;case 5:return"break"===e||"local"===e||"until"===e||"while"===e;case 6:return"elseif"===e||"repeat"===e||"return"===e;case 8:return"function"===e}return!1}(n=e.slice(S,v))?"true"===n||"false"===n?(t=l,n="true"===n):"nil"===n?(t=f,n=null):t=o:t=u,{type:t,value:n,line:C,lineStart:A,range:[S,v]}}();switch(r){case 39:case 34:return function(){for(var n,r=e.charCodeAt(v++),a=v,u="";v<t&&(n=e.charCodeAt(v++),r!==n);)92===n?(u+=e.slice(a,v-1)+M(),a=v):(v>=t||W(n))&&(u+=e.slice(a,v-1),T({},h.unfinishedString,u+String.fromCharCode(n)));return u+=e.slice(a,v-1),{type:i,value:u,line:C,lineStart:A,range:[S,v]}}();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return G();case 46:return X(c)?G():46===c?46===e.charCodeAt(v+2)?{type:p,value:"...",line:C,lineStart:A,range:[S,v+=3]}:B(".."):B(".");case 61:return B(61===c?"==":"=");case 62:return B(61===c?">=":">");case 60:return B(61===c?"<=":"<");case 126:return B(61===c?"~=":"~");case 58:return B(58===c?"::":":");case 91:return 91===c||61===c?(!1===(n=j())&&T(y,h.expected,"[",y.value),{type:i,value:n,line:C,lineStart:A,range:[S,v]}):B("[");case 42:case 47:case 94:case 37:case 44:case 123:case 125:case 93:case 40:case 41:case 59:case 35:case 45:case 43:case 38:case 124:return B(e.charAt(v))}return K(e.charAt(v))}function F(){for(;v<t;){var n=e.charCodeAt(v);if(z(n))v++;else{if(!W(n))break;C++,A=++v}}}function B(e){return v+=e.length,{type:s,value:e,line:C,lineStart:A,range:[S,v]}}function G(){var n=e.charAt(v),t=e.charAt(v+1),r="0"===n&&"xX".indexOf(t||null)>=0?function(){var n,t,r,a,i=0,u=1,o=1;for(a=v+=2,q(e.charCodeAt(v))||T({},h.malformedNumber,e.slice(S,v));q(e.charCodeAt(v));)v++;if(n=parseInt(e.slice(a,v),16),"."===e.charAt(v)){for(t=++v;q(e.charCodeAt(v));)v++;i=e.slice(t,v),i=t===v?0:parseInt(i,16)/Math.pow(16,v-t)}if("pP".indexOf(e.charAt(v)||null)>=0){for(v++,"+-".indexOf(e.charAt(v)||null)>=0&&(o="+"===e.charAt(v++)?1:-1),r=v,X(e.charCodeAt(v))||T({},h.malformedNumber,e.slice(S,v));X(e.charCodeAt(v));)v++;u=e.slice(r,v),u=Math.pow(2,u*o)}return(n+i)*u}():function(){for(;X(e.charCodeAt(v));)v++;if("."===e.charAt(v))for(v++;X(e.charCodeAt(v));)v++;if("eE".indexOf(e.charAt(v)||null)>=0)for(v++,"+-".indexOf(e.charAt(v)||null)>=0&&v++,X(e.charCodeAt(v))||T({},h.malformedNumber,e.slice(S,v));X(e.charCodeAt(v));)v++;return parseFloat(e.slice(S,v))}();return{type:c,value:r,line:C,lineStart:A,range:[S,v]}}function M(){var n=v;switch(e.charAt(v)){case"n":return v++,"\n";case"r":return v++,"\r";case"t":return v++,"\t";case"v":return v++,"\v";case"b":return v++,"\b";case"f":return v++,"\f";case"z":return v++,F(),"";case"x":return q(e.charCodeAt(v+1))&&q(e.charCodeAt(v+2))?(v+=3,"\\"+e.slice(n,v)):"\\"+e.charAt(v++);default:if(X(e.charCodeAt(v))){for(;X(e.charCodeAt(++v)););return"\\"+e.slice(n,v)}return e.charAt(v++)}}function P(){S=v,v+=2;var r=e.charAt(v),a="",i=!1,u=v,o=A,c=C;if("["===r&&(!1===(a=j())?a=r:i=!0),!i){for(;v<t&&!W(e.charCodeAt(v));)v++;n.comments&&(a=e.slice(u,v))}if(n.comments){var s=d.comment(a,e.slice(S,v));n.locations&&(s.loc={start:{line:c,column:S-o},end:{line:C,column:v-A}}),n.ranges&&(s.range=[S,v]),x.push(s)}}function j(){var n,r,a=0,i="",u=!1;for(v++;"="===e.charAt(v+a);)a++;if("["!==e.charAt(v+a))return!1;for(v+=a+1,W(e.charCodeAt(v))&&(C++,A=v++),r=v;v<t;){if(W((n=e.charAt(v++)).charCodeAt(0))&&(C++,A=v),"]"===n){u=!0;for(var o=0;o<a;o++)"="!==e.charAt(v+o)&&(u=!1);"]"!==e.charAt(v+a)&&(u=!1)}if(u)break}return i+=e.slice(r,v-1),v+=a+1,i}function D(){b=y,y=g,g=V()}function R(e){return e===y.value&&(D(),!0)}function U(e){e===y.value?D():T(y,h.expected,e,y.value)}function z(e){return 9===e||32===e||11===e||12===e}function W(e){return 10===e||13===e}function X(e){return e>=48&&e<=57}function q(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function H(e){if(a===e.type)return!0;if(u!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}function J(e){-1===O(E[w],e)&&E[w].push(e)}function Q(e){J(e.name),Y(e,!0)}function Y(e,n){n||-1!==function(e,n,t){for(var r=0,a=e.length;r<a;r++)if(e[r][n]===t)return r;return-1}(k,"name",e.name)||k.push(e),e.isLocal=n}function Z(e){return-1!==O(E[w],e)}exports.lex=V;var $,_=[];function ee(){return new ne(y)}function ne(e){n.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),n.ranges&&(this.range=[e.range[0],0])}function te(){$&&_.push(ee())}function re(e){$&&_.push(e)}function ae(e){var t,r=[];for(n.scope&&E.push(Array.apply(null,E[w++]));!H(y);){if("return"===y.value){r.push(ie());break}(t=ie())&&r.push(t)}return n.scope&&(E.pop(),w--),r}function ie(){if(te(),u===y.type)switch(y.value){case"local":return D(),function(){var e;if(o===y.type){var t=[],r=[];do{e=ue(),t.push(e)}while(R(","));if(R("="))do{var a=le();r.push(a)}while(R(","));if(n.scope)for(var i=0,u=t.length;i<u;i++)Q(t[i]);return m(d.localStatement(t,r))}if(R("function"))return e=ue(),n.scope&&Q(e),oe(e,!0);I("<name>",y)}();case"if":return D(),function(){var e,n,t,r=[];for($&&(t=_[_.length-1],_.push(t)),e=le(),U("then"),n=ae(),r.push(m(d.ifClause(e,n))),$&&(t=ee());R("elseif");)re(t),e=le(),U("then"),n=ae(),r.push(m(d.elseifClause(e,n))),$&&(t=ee());return R("else")&&($&&(t=new ne(b),_.push(t)),n=ae(),r.push(m(d.elseClause(n)))),U("end"),m(d.ifStatement(r))}();case"return":return D(),function(){var e=[];if("end"!==y.value){var n=se();for(null!=n&&e.push(n);R(",");)n=le(),e.push(n);R(";")}return m(d.returnStatement(e))}();case"function":D();var e=function(){var e,t,r;for($&&(r=ee()),e=ue(),n.scope&&Y(e,!1);R(".");)re(r),t=ue(),n.scope&&Y(t,!1),e=m(d.memberExpression(e,".",t));return R(":")&&(re(r),t=ue(),n.scope&&Y(t,!1),e=m(d.memberExpression(e,":",t))),e}();return oe(e);case"while":return D(),function(){var e=le();U("do");var n=ae();return U("end"),m(d.whileStatement(e,n))}();case"for":return D(),function(){var e,t=ue();if(n.scope&&Q(t),R("=")){var r=le();U(",");var a=le(),i=R(",")?le():null;return U("do"),e=ae(),U("end"),m(d.forNumericStatement(t,r,a,i,e))}for(var u=[t];R(",");)t=ue(),n.scope&&Q(t),u.push(t);U("in");var o=[];do{var c=le();o.push(c)}while(R(","));return U("do"),e=ae(),U("end"),m(d.forGenericStatement(u,o,e))}();case"repeat":return D(),function(){var e=ae();U("until");var n=le();return m(d.repeatStatement(n,e))}();case"break":return D(),m(d.breakStatement());case"do":return D(),t=ae(),U("end"),m(d.doStatement(t));case"goto":return D(),function(){var e=y.value,t=ue();return n.scope&&(t.isLabel=Z("::"+e+"::")),m(d.gotoStatement(t))}()}var t;return s===y.type&&R("::")?function(){var e=y.value,t=ue();return n.scope&&(J("::"+e+"::"),Y(t,!0)),U("::"),m(d.labelStatement(t))}():($&&_.pop(),R(";")?void 0:function(){var e,n,t=y;if($&&(n=ee()),null==(e=pe()))return K(y);if(",=".indexOf(y.value)>=0){for(var r,a=[e],i=[];R(",");)null==(r=pe())&&I("<expression>",y),a.push(r);U("=");do{r=le(),i.push(r)}while(R(","));return re(n),m(d.assignmentStatement(a,i))}return function(e){switch(e.type){case"CallExpression":case"TableCallExpression":case"StringCallExpression":return!0}return!1}(e)?(re(n),m(d.callStatement(e))):K(t)}())}function ue(){te();var e=y.value;return o!==y.type&&I("<name>",y),D(),m(d.identifier(e))}function oe(e,t){var r=[];if(U("("),!R(")"))for(;;)if(o===y.type){var a=ue();if(n.scope&&Q(a),r.push(a),R(","))continue;if(R(")"))break}else{if(p===y.type){r.push(de()),U(")");break}I("<name> or '...'",y)}var i=ae();return U("end"),t=t||!1,m(d.functionStatement(e,r,t,i))}function ce(){for(var e,n,t=[];;){if(te(),s===y.type&&R("["))e=le(),U("]"),U("="),n=le(),t.push(m(d.tableKey(e,n)));else if(o===y.type)e=le(),R("=")?(n=le(),t.push(m(d.tableKeyString(e,n)))):t.push(m(d.tableValue(e)));else{if(null==(n=se())){_.pop();break}t.push(m(d.tableValue(n)))}if(",;".indexOf(y.value)>=0)D();else if("}"===y.value)break}return U("}"),m(d.tableConstructorExpression(t))}function se(){var e=function e(n){var t,r,a,i=y.value;if($&&(r=ee()),function(e){return s===e.type?"#-~".indexOf(e.value)>=0:u===e.type&&"not"===e.value}(y)){te(),D();var o=e(8);null==o&&I("<expression>",y),t=m(d.unaryExpression(i,o))}if(null==t&&null==(t=de())&&(t=pe()),null==t)return null;for(;i=y.value,!(0===(a=s===y.type||u===y.type?fe(i):0)||a<=n);){"^"!==i&&".."!==i||a--,D();var c=e(a);null==c&&I("<expression>",y),$&&_.push(r),t=m(d.binaryExpression(i,t,c))}return t}(0);return e}function le(){var e=se();if(null!=e)return e;I("<expression>",y)}function fe(e){var n=e.charCodeAt(0),t=e.length;if(1===t)switch(n){case 94:return 10;case 42:case 47:case 37:return 7;case 43:case 45:return 6;case 60:case 62:return 3;case 38:case 124:return 7}else if(2===t)switch(n){case 46:return 5;case 60:case 62:case 61:case 126:return 3;case 111:return 1}else if(97===n&&"and"===e)return 2;return 0}function pe(){var e,t,r,a,u,c;if($&&(r=ee()),o===y.type)t=y.value,e=ue(),n.scope&&Y(e,a=Z(t));else{if(!R("("))return null;e=le(),U(")"),n.scope&&(a=e.isLocal)}for(;;)if(s===y.type)switch(y.value){case"[":re(r),D(),u=le(),e=m(d.indexExpression(e,u)),U("]");break;case".":re(r),D(),c=ue(),n.scope&&Y(c,a),e=m(d.memberExpression(e,".",c));break;case":":re(r),D(),c=ue(),n.scope&&Y(c,a),e=m(d.memberExpression(e,":",c)),re(r),e=he(e);break;case"(":case"{":re(r),e=he(e);break;default:return e}else{if(i!==y.type)break;re(r),e=he(e)}return e}function he(e){if(s===y.type)switch(y.value){case"(":D();var n=[],t=se();for(null!=t&&n.push(t);R(",");)t=le(),n.push(t);return U(")"),m(d.callExpression(e,n));case"{":te(),D();var r=ce();return m(d.tableCallExpression(e,r))}else if(i===y.type)return m(d.stringCallExpression(e,de()));I("function arguments",y)}function de(){var n,t=i|c|l|f|p,r=y.value,a=y.type;if($&&(n=ee()),a&t){re(n);var o=e.slice(y.range[0],y.range[1]);return D(),m(d.literal(a,r,o))}return u===a&&"function"===r?(re(n),D(),oe(null)):R("{")?(re(n),ce()):void 0}function me(n){return e+=String(n),t=e.length,exports}function ve(r){void 0!==r&&me(r),t=e.length,$=n.locations||n.ranges,g=V();var i=function(){D(),te();var e=ae();return a!==y.type&&K(y),$&&!e.length&&(b=y),m(d.chunk(e))}();if(n.comments&&(i.comments=x),n.scope&&(i.globals=k),_.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return i}ne.prototype.complete=function(){n.locations&&(this.loc.end.line=b.line,this.loc.end.column=b.range[1]-b.lineStart),n.ranges&&(this.range[1]=b.range[1])},exports.parse=function(a,i){return void 0===i&&"object"==typeof a&&(i=a,a=void 0),i||(i={}),e=a||"",n=function(){for(var e,n,t=L.call(arguments),r={},a=0,i=t.length;a<i;a++)for(n in e=t[a])e.hasOwnProperty(n)&&(r[n]=e[n]);return r}(r,i),v=0,C=1,A=0,t=e.length,E=[[]],w=0,k=[],_=[],n.comments&&(x=[]),n.wait?exports:ve()},exports.write=me,exports.end=ve}(exports)});
//# sourceMappingURL=../../sourcemaps/mode/lua/luaparse.js.map
