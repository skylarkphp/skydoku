/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,t,n){"use strict";var i=e("../lib/oop"),r=e("./text").Mode,o=e("./lua_highlight_rules").LuaHighlightRules,a=e("./folding/lua").FoldMode,s=e("../range").Range,l=e("../worker/worker_client").WorkerClient,u=function(){this.HighlightRules=o,this.foldingRules=new a,this.$behaviour=this.$defaultBehaviour};i.inherits(u,r),function(){this.lineCommentStart="--",this.blockComment={start:"--[",end:"]--"};var e={function:1,then:1,do:1,else:1,elseif:1,repeat:1,end:-1,until:-1},t=["else","elseif","end","until"];function n(t){for(var n=0,i=0;i<t.length;i++){var r=t[i];"keyword"==r.type?r.value in e&&(n+=e[r.value]):"paren.lparen"==r.type?n+=r.value.length:"paren.rparen"==r.type&&(n-=r.value.length)}return n<0?-1:n>0?1:0}this.getNextLineIndent=function(e,t,i){var r=this.$getIndent(t),o=0,a=this.getTokenizer().getLineTokens(t,e).tokens;return"start"==e&&(o=n(a)),o>0?r+i:o<0&&r.substr(r.length-i.length)==i&&!this.checkOutdent(e,t,"\n")?r.substr(0,r.length-i.length):r},this.checkOutdent=function(e,n,i){if("\n"!=i&&"\r"!=i&&"\r\n"!=i)return!1;if(n.match(/^\s*[\)\}\]]$/))return!0;var r=this.getTokenizer().getLineTokens(n.trim(),e).tokens;return!(!r||!r.length)&&("keyword"==r[0].type&&-1!=t.indexOf(r[0].value))},this.autoOutdent=function(e,t,i){var r=t.getLine(i-1),o=this.$getIndent(r).length,a=this.getTokenizer().getLineTokens(r,"start").tokens,l=o+t.getTabString().length*n(a);this.$getIndent(t.getLine(i)).length<=l||t.outdentRows(new s(i,0,i+2,0))},this.createWorker=function(e){var t=new l(["ace"],"ace/mode/lua_worker","Worker");return t.attachToDocument(e.getDocument()),t.on("annotate",function(t){e.setAnnotations(t.data)}),t.on("terminate",function(){e.clearAnnotations()}),t},this.$id="ace/mode/lua"}.call(u.prototype),t.Mode=u});
//# sourceMappingURL=../sourcemaps/mode/lua.js.map
