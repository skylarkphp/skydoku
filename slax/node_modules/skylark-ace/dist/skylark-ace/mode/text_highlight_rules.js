/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){"use strict";var e=require("../lib/lang"),t=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(t)for(var n in e){for(var r=e[n],s=0;s<r.length;s++){var i=r[s];(i.next||i.onMatch)&&("string"==typeof i.next&&0!==i.next.indexOf(t)&&(i.next=t+i.next),i.nextState&&0!==i.nextState.indexOf(t)&&(i.nextState=t+i.nextState))}this.$rules[t+n]=r}else for(var n in e)this.$rules[n]=e[n]},this.getRules=function(){return this.$rules},this.embedRules=function(t,n,r,s,i){var a="function"==typeof t?(new t).getRules():t;if(s)for(var o=0;o<s.length;o++)s[o]=n+s[o];else for(var u in s=[],a)s.push(n+u);if(this.addRules(a,n),r){var l=Array.prototype[i?"push":"unshift"];for(o=0;o<s.length;o++)l.apply(this.$rules[s[o]],e.deepCopy(r))}this.$embeds||(this.$embeds=[]),this.$embeds.push(n)},this.getEmbeds=function(){return this.$embeds};var t=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},n=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){var e=0,r=this.$rules;Object.keys(r).forEach(function s(i){var a=r[i];a.processed=!0;for(var o=0;o<a.length;o++){var u=a[o],l=null;Array.isArray(u)&&(l=u,u={}),!u.regex&&u.start&&(u.regex=u.start,u.next||(u.next=[]),u.next.push({defaultToken:u.token},{token:u.token+".end",regex:u.end||u.start,next:"pop"}),u.token=u.token+".start",u.push=!0);var f=u.next||u.push;if(f&&Array.isArray(f)){var h=u.stateName;h||("string"!=typeof(h=u.token)&&(h=h[0]||""),r[h]&&(h+=e++)),r[h]=f,u.next=h,s(h)}else"pop"==f&&(u.next=n);if(u.push&&(u.nextState=u.next||u.push,u.next=t,delete u.push),u.rules)for(var p in u.rules)r[p]?r[p].push&&r[p].push.apply(r[p],u.rules[p]):r[p]=u.rules[p];var c="string"==typeof u?u:u.include;if(c&&(l=Array.isArray(c)?c.map(function(e){return r[e]}):r[c]),l){var d=[o,1].concat(l);u.noEscape&&(d=d.filter(function(e){return!e.next})),a.splice.apply(a,d),o--}u.keywordMap&&(u.token=this.createKeywordMapper(u.keywordMap,u.defaultToken||"text",u.caseInsensitive),delete u.defaultToken)}},this)},this.createKeywordMapper=function(e,t,n,r){var s=Object.create(null);return Object.keys(e).forEach(function(t){var i=e[t];n&&(i=i.toLowerCase());for(var a=i.split(r||"|"),o=a.length;o--;)s[a[o]]=t}),Object.getPrototypeOf(s)&&(s.__proto__=null),this.$keywordList=Object.keys(s),e=null,n?function(e){return s[e.toLowerCase()]||t}:function(e){return s[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(t.prototype),exports.TextHighlightRules=t});
//# sourceMappingURL=../sourcemaps/mode/text_highlight_rules.js.map
