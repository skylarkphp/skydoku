/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(require,exports,module){"use strict";var e=require("../worker/worker_client").WorkerClient,n=require("../lib/oop"),t=require("./text").Mode,r=require("./text_highlight_rules").TextHighlightRules,o=require("./xquery/jsoniq_lexer").JSONiqLexer,s=require("../range").Range,a=require("./behaviour/xquery").XQueryBehaviour,i=require("./folding/cstyle").FoldMode,c=require("../anchor").Anchor,h=function(){this.$tokenizer=new o,this.$behaviour=new a,this.foldingRules=new i,this.$highlightRules=new r};n.inherits(h,t),function(){this.completer={getCompletions:function(e,n,t,r,o){if(!n.$worker)return o();n.$worker.emit("complete",{data:{pos:t,prefix:r}}),n.$worker.on("complete",function(e){o(null,e.data)})}},this.getNextLineIndent=function(e,n,t){var r=this.$getIndent(n);return n.match(/\s*(?:then|else|return|[{\(]|<\w+>)\s*$/)&&(r+=t),r},this.checkOutdent=function(e,n,t){return!!/^\s+$/.test(n)&&/^\s*[\}\)]/.test(t)},this.autoOutdent=function(e,n,t){var r=n.getLine(t).match(/^(\s*[\}\)])/);if(!r)return 0;var o=r[1].length,a=n.findMatchingBracket({row:t,column:o});if(!a||a.row==t)return 0;var i=this.$getIndent(n.getLine(a.row));n.replace(new s(t,0,t,o-1),i)},this.toggleCommentLines=function(e,n,t,r){var o,a,i=!0,c=/^\s*\(:(.*):\)/;for(o=t;o<=r;o++)if(!c.test(n.getLine(o))){i=!1;break}var h=new s(0,0,0,0);for(o=t;o<=r;o++)a=n.getLine(o),h.start.row=o,h.end.row=o,h.end.column=a.length,n.replace(h,i?a.match(c)[1]:"(:"+a+":)")},this.createWorker=function(n){var t=new e(["ace"],"ace/mode/xquery_worker","XQueryWorker"),r=this;return t.attachToDocument(n.getDocument()),t.on("ok",function(e){n.clearAnnotations()}),t.on("markers",function(e){n.clearAnnotations(),r.addMarkers(e.data,n)}),t},this.removeMarkers=function(e){var n=e.getMarkers(!1);for(var t in n)0===n[t].clazz.indexOf("language_highlight_")&&e.removeMarker(t);for(var r=0;r<e.markerAnchors.length;r++)e.markerAnchors[r].detach();e.markerAnchors=[]},this.addMarkers=function(e,n){n.markerAnchors||(n.markerAnchors=[]),this.removeMarkers(n),n.languageAnnos=[],e.forEach(function(e){var t,r=new c(n.getDocument(),e.pos.sl,e.pos.sc||0);n.markerAnchors.push(r);e.pos.ec,e.pos.sc,e.pos.el,e.pos.sl;var o={guttertext:e.message,type:e.level||"warning",text:e.message};function a(a){if(t&&n.removeMarker(t),o.row=r.row,void 0!==e.pos.sc&&void 0!==e.pos.ec){var i=new s(e.pos.sl,e.pos.sc,e.pos.el,e.pos.ec);t=n.addMarker(i,"language_highlight_"+(e.type?e.type:"default"))}a&&n.setAnnotations(n.languageAnnos)}a(),r.on("change",function(){a(!0)}),e.message&&n.languageAnnos.push(o)}),n.setAnnotations(n.languageAnnos)},this.$id="ace/mode/jsoniq"}.call(h.prototype),exports.Mode=h});
//# sourceMappingURL=../sourcemaps/mode/jsoniq.js.map
