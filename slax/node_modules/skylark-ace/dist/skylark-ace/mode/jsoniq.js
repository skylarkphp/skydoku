/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,n,t){"use strict";var r=e("../worker/worker_client").WorkerClient,o=e("../lib/oop"),s=e("./text").Mode,a=e("./text_highlight_rules").TextHighlightRules,i=e("./xquery/jsoniq_lexer").JSONiqLexer,c=e("../range").Range,h=e("./behaviour/xquery").XQueryBehaviour,u=e("./folding/cstyle").FoldMode,l=e("../anchor").Anchor,g=function(){this.$tokenizer=new i,this.$behaviour=new h,this.foldingRules=new u,this.$highlightRules=new a};o.inherits(g,s),function(){this.completer={getCompletions:function(e,n,t,r,o){if(!n.$worker)return o();n.$worker.emit("complete",{data:{pos:t,prefix:r}}),n.$worker.on("complete",function(e){o(null,e.data)})}},this.getNextLineIndent=function(e,n,t){var r=this.$getIndent(n);return n.match(/\s*(?:then|else|return|[{\(]|<\w+>)\s*$/)&&(r+=t),r},this.checkOutdent=function(e,n,t){return!!/^\s+$/.test(n)&&/^\s*[\}\)]/.test(t)},this.autoOutdent=function(e,n,t){var r=n.getLine(t).match(/^(\s*[\}\)])/);if(!r)return 0;var o=r[1].length,s=n.findMatchingBracket({row:t,column:o});if(!s||s.row==t)return 0;var a=this.$getIndent(n.getLine(s.row));n.replace(new c(t,0,t,o-1),a)},this.toggleCommentLines=function(e,n,t,r){var o,s,a=!0,i=/^\s*\(:(.*):\)/;for(o=t;o<=r;o++)if(!i.test(n.getLine(o))){a=!1;break}var h=new c(0,0,0,0);for(o=t;o<=r;o++)s=n.getLine(o),h.start.row=o,h.end.row=o,h.end.column=s.length,n.replace(h,a?s.match(i)[1]:"(:"+s+":)")},this.createWorker=function(e){var n=new r(["ace"],"ace/mode/xquery_worker","XQueryWorker"),t=this;return n.attachToDocument(e.getDocument()),n.on("ok",function(n){e.clearAnnotations()}),n.on("markers",function(n){e.clearAnnotations(),t.addMarkers(n.data,e)}),n},this.removeMarkers=function(e){var n=e.getMarkers(!1);for(var t in n)0===n[t].clazz.indexOf("language_highlight_")&&e.removeMarker(t);for(var r=0;r<e.markerAnchors.length;r++)e.markerAnchors[r].detach();e.markerAnchors=[]},this.addMarkers=function(e,n){n.markerAnchors||(n.markerAnchors=[]),this.removeMarkers(n),n.languageAnnos=[],e.forEach(function(e){var t,r=new l(n.getDocument(),e.pos.sl,e.pos.sc||0);n.markerAnchors.push(r);e.pos.ec,e.pos.sc,e.pos.el,e.pos.sl;var o={guttertext:e.message,type:e.level||"warning",text:e.message};function s(s){if(t&&n.removeMarker(t),o.row=r.row,void 0!==e.pos.sc&&void 0!==e.pos.ec){var a=new c(e.pos.sl,e.pos.sc,e.pos.el,e.pos.ec);t=n.addMarker(a,"language_highlight_"+(e.type?e.type:"default"))}s&&n.setAnnotations(n.languageAnnos)}s(),r.on("change",function(){s(!0)}),e.message&&n.languageAnnos.push(o)}),n.setAnnotations(n.languageAnnos)},this.$id="ace/mode/jsoniq"}.call(g.prototype),n.Mode=g});
//# sourceMappingURL=../sourcemaps/mode/jsoniq.js.map
