/**
 * skylark-domx-tables - The skylark tables library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-domx-query","skylark-domx-styler","skylark-domx-eventer","skylark-domx-fx","skylark-domx-data","skylark-domx-finder","skylark-domx-geom"],function(t,e,n){function r(){return r}function a(t,e){return t.find("td, th").each(function(t,r){var a;return(a=n(r)).replaceWith("<"+e+">"+a.html()+"</"+e+">")})}function d(t,e){var r,a;r=(a=n(t).closest(".simditor-table")).next("p"),a.remove(),e&&e(r)}function i(t){return setTimeout(function(){var e,r;return r=t.width(),e=t.find("col"),t.find("thead tr th").each(function(t,a){return e.eq(t).attr("width",n(a).outerWidth()/r*100+"%")})},0)}function o(t){var e=n(t);if(e.parent(".simditor-table").length>0)return e.parent().replaceWith(e)[0]}return e.mixin(r,{createTable:function(t,e,r){var a,d,i,o,l,s,f,h,p,u;for(a=n("<table/>"),o=n("<thead/>").appendTo(a),d=n("<tbody/>").appendTo(a),h=s=0,p=t;0<=p?s<p:s>p;h=0<=p?++s:--s)for((l=n("<tr/>")).appendTo(0===h?o:d),f=0,u=e;0<=u?f<u:f>u;0<=u?++f:--f)i=n(0===h?"<th/>":"<td/>").appendTo(l),r&&i.append(r);return a[0]},decorate:function(t,e){var r,d,l,s,f,h=n(t);return h.parent("."+e.tableDecorate).length>0&&o(t),h.wrap('<div class="'+e.tableDecorate+'"></div>'),f=h.parent("."+e.tableDecorate),r=h.find("colgroup"),h.find("thead").length<1&&(s=n("<thead />"),d=h.find("tr").first(),s.append(d),a(d,"th"),(l=h.find("tbody")).length>0?l.before(s):h.prepend(s)),r.length<1&&(r=n("<colgroup/>").prependTo(h),h.find("thead tr th").each(function(t,e){return n("<col/>").appendTo(r)}),i(h)),n("<div />",{class:e.resizeHandle,contenteditable:"false"}).appendTo(f),h.parent()},deleteCol:function(t,e){var r,a,o,l,s,f,h=n(t);if(f=(o=h.parent("tr")).closest("table").find("tr").length<2,s=h.siblings("td, th").length<1,f&&s)return d(t);l=o.find("td, th").index(h),(r=h.next("td, th")).length>0||(r=o.prev("td, th")),(a=o.closest("table")).find("col").eq(l).remove(),a.find("tr").each(function(t,e){return n(e).find("td, th").eq(l).remove()}),i(a),e&&e(r[0])},deleteRow:function(t,e){var r,i,o,l=n(t);if((i=l.parent("tr")).closest("table").find("tr").length<1)return d(t);(r=function(t){var e;return(e=t.next("tr")).length<1&&t.parent("thead").length>0&&(e=t.parent("thead").next("tbody").find("tr:first")),e}(i)).length>0||(r=function(t){var e;return(e=t.prev("tr")).length<1&&t.parent("tbody").length>0&&(e=t.parent("tbody").prev("thead").find("tr")),e}(i)),o=i.find("td, th").index(l),i.parent().is("thead")&&(r.appendTo(i.parent()),a(r,"th")),i.remove(),e&&e(r[0],o)},deleteTable:d,insertCol:function(t,e,r,a){var d,o,l,s,f,h,p,u,c=n(t);null==e&&(e="after"),f=c.parent("tr"),h=f.find("td, th").index(c),d=(s=c.closest("table")).find("col").eq(h),s.find("tr").each(function(t,a){var d,i;return i=n(a).parent().is("thead")?"th":"td",d=n("<"+i+"/>").append(r),n(a).find("td, th").eq(h)[e](d)}),o=n("<col/>"),d[e](o),p=s.width(),u=Math.max(parseFloat(d.attr("width"))/2,50/p*100),d.attr("width",u+"%"),o.attr("width",u+"%"),i(s),l="after"===e?c.next("td, th"):c.prev("td, th"),a&&a(l[0])},insertRow:function(t,e,r,d){var i,o,l,s,f,h,p,u,c=n(t);for(null==e&&(e="after"),o=(l=c.parent("tr")).closest("table"),f=0,o.find("tr").each(function(t,e){return f=Math.max(f,n(e).find("td").length)}),h=l.find("td, th").index(c),i=n("<tr/>"),s="td","after"===e&&l.parent().is("thead")?l.parent().next("tbody").prepend(i):"before"===e&&l.parent().is("thead")?(l.before(i),l.parent().next("tbody").prepend(l),a(l,"td"),s="th"):l[e](i),p=1,u=f;1<=u?p<=u:p>=u;1<=u?++p:--p)n("<"+s+"/>").append(r).appendTo(i);d&&d(i[0],h)},refreshTableWidth:i,resizable:function(t,e){var r=e.cssClasses,a=r.resizeHandle,d="."+r.wrapper,i="."+a;return n(t).on("mousemove.table",d+" td, "+d+" th",function(t){var e,r,a,o,l,s,f,h;if(a=(l=n(this).parents(d)).find(i),r=l.find("colgroup"),!l.hasClass("resizing"))if(o=n(t.currentTarget),t.pageX-n(t.currentTarget).offset().left<5&&o.prev().length>0&&(o=o.prev()),o.next("td, th").length<1)a.hide();else if(null!=(f=a.data("td"))&&f.is(o))a.show();else{if(s=o.parent().find("td, th").index(o),e=r.find("col").eq(s),null==(h=a.data("col"))||!h.is(e))return a.css("left",o.position().left+o.outerWidth()-5).data("td",o).data("col",e).show();a.show()}}),n(t).on("mouseleave"+d,d,function(t){return n(this).find(i).hide()}),n(t).on("mousedown"+i,i,function(e){var r,a,i,o,l,s,f,h,p,u,c;return s=n(this).parent(d),i=(r=n(e.currentTarget)).data("td"),a=r.data("col"),l=i.next("td, th"),o=a.next("col"),u=e.pageX,h=1*i.outerWidth(),p=1*l.outerWidth(),f=parseFloat(r.css("left")),c=i.closest(d).width(),n(t).on("mousemove.resize-table",function(t){var e,n,d;return e=t.pageX-u,d=p-e,(n=h+e)<50?(n=50,d=p-(e=50-h)):d<50&&(d=50,n=h+(e=p-50)),a.attr("width",n/c*100+"%"),o.attr("width",d/c*100+"%"),r.css("left",f+e)}),n(t).one("mouseup.resize-table",function(e){return n(t).off(".resize-table"),s.removeClass("resizing")}),s.addClass("resizing"),!1})},undecorate:o}),t.attach("domx.tables",r)});
//# sourceMappingURL=sourcemaps/tables.js.map
