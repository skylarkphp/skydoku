{"version":3,"sources":["widgets/spinner.js"],"names":["define","$","spinnerModifier","fn","previous","this","element","val","apply","arguments","_refresh","_trigger","widget","version","defaultElement","widgetEventPrefix","options","classes","ui-spinner","ui-spinner-down","ui-spinner-up","culture","icons","down","up","incremental","max","min","numberFormat","page","step","change","spin","start","stop","_create","_setOption","value","_value","_draw","_on","_events","window","beforeunload","removeAttr","_getCreateOptions","_super","each","i","option","attr","length","keydown","event","_start","_keydown","preventDefault","keyup","focus","blur","cancelBlur","_stop","mousewheel","delta","activeElement","ui","safeActiveElement","document","spinning","_spin","clearTimeout","mousewheelTimer","_delay","mousedown .ui-spinner-button","checkFocus","trigger","call","_repeat","currentTarget","hasClass","mouseup .ui-spinner-button","mouseenter .ui-spinner-button","mouseleave .ui-spinner-button","_enhance","uiSpinner","wrap","parent","append","_addClass","buttons","children","button","ui-button","_removeClass","first","last","icon","showLabel","height","Math","ceil","keyCode","UP","DOWN","PAGE_UP","PAGE_DOWN","counter","steps","timer","_adjustValue","_increment","isFunction","floor","_precision","precision","_precisionOf","num","str","toString","decimal","indexOf","base","aboveMin","round","parseFloat","toFixed","key","prevValue","_parse","_format","find","_setOptionDisabled","_toggleClass","prop","_setOptions","Globalize","isNaN","format","aria-valuemin","aria-valuemax","aria-valuenow","isValid","allowAny","parsed","_destroy","replaceWith","stepUp","_stepUp","stepDown","_stepDown","pageUp","pages","pageDown","newVal","uiBackCompat","spinner","_uiSpinnerHtml","_buttonHtml"],"mappings":"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","file":"../../widgets/spinner.js","sourcesContent":["define( [\r\n\t\"skylark-jquery\",\r\n\t\"./button\",\r\n\t\"../version\",\r\n\t\"../keycode\",\r\n\t\"../safe-active-element\",\r\n\t\"../widget\"\r\n],function( $ ) {\r\n\r\n\tfunction spinnerModifier( fn ) {\r\n\t\treturn function() {\r\n\t\t\tvar previous = this.element.val();\r\n\t\t\tfn.apply( this, arguments );\r\n\t\t\tthis._refresh();\r\n\t\t\tif ( previous !== this.element.val() ) {\r\n\t\t\t\tthis._trigger( \"change\" );\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\t$.widget( \"ui.spinner\", {\r\n\t\tversion: \"@VERSION\",\r\n\t\tdefaultElement: \"<input>\",\r\n\t\twidgetEventPrefix: \"spin\",\r\n\t\toptions: {\r\n\t\t\tclasses: {\r\n\t\t\t\t\"ui-spinner\": \"ui-corner-all\",\r\n\t\t\t\t\"ui-spinner-down\": \"ui-corner-br\",\r\n\t\t\t\t\"ui-spinner-up\": \"ui-corner-tr\"\r\n\t\t\t},\r\n\t\t\tculture: null,\r\n\t\t\ticons: {\r\n\t\t\t\tdown: \"ui-icon-triangle-1-s\",\r\n\t\t\t\tup: \"ui-icon-triangle-1-n\"\r\n\t\t\t},\r\n\t\t\tincremental: true,\r\n\t\t\tmax: null,\r\n\t\t\tmin: null,\r\n\t\t\tnumberFormat: null,\r\n\t\t\tpage: 10,\r\n\t\t\tstep: 1,\r\n\r\n\t\t\tchange: null,\r\n\t\t\tspin: null,\r\n\t\t\tstart: null,\r\n\t\t\tstop: null\r\n\t\t},\r\n\r\n\t\t_create: function() {\r\n\r\n\t\t\t// handle string values that need to be parsed\r\n\t\t\tthis._setOption( \"max\", this.options.max );\r\n\t\t\tthis._setOption( \"min\", this.options.min );\r\n\t\t\tthis._setOption( \"step\", this.options.step );\r\n\r\n\t\t\t// Only format if there is a value, prevents the field from being marked\r\n\t\t\t// as invalid in Firefox, see #9573.\r\n\t\t\tif ( this.value() !== \"\" ) {\r\n\r\n\t\t\t\t// Format the value, but don't constrain.\r\n\t\t\t\tthis._value( this.element.val(), true );\r\n\t\t\t}\r\n\r\n\t\t\tthis._draw();\r\n\t\t\tthis._on( this._events );\r\n\t\t\tthis._refresh();\r\n\r\n\t\t\t// Turning off autocomplete prevents the browser from remembering the\r\n\t\t\t// value when navigating through history, so we re-enable autocomplete\r\n\t\t\t// if the page is unloaded before the widget is destroyed. #7790\r\n\t\t\tthis._on( this.window, {\r\n\t\t\t\tbeforeunload: function() {\r\n\t\t\t\t\tthis.element.removeAttr( \"autocomplete\" );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_getCreateOptions: function() {\r\n\t\t\tvar options = this._super();\r\n\t\t\tvar element = this.element;\r\n\r\n\t\t\t$.each( [ \"min\", \"max\", \"step\" ], function( i, option ) {\r\n\t\t\t\tvar value = element.attr( option );\r\n\t\t\t\tif ( value != null && value.length ) {\r\n\t\t\t\t\toptions[ option ] = value;\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\treturn options;\r\n\t\t},\r\n\r\n\t\t_events: {\r\n\t\t\tkeydown: function( event ) {\r\n\t\t\t\tif ( this._start( event ) && this._keydown( event ) ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tkeyup: \"_stop\",\r\n\t\t\tfocus: function() {\r\n\t\t\t\tthis.previous = this.element.val();\r\n\t\t\t},\r\n\t\t\tblur: function( event ) {\r\n\t\t\t\tif ( this.cancelBlur ) {\r\n\t\t\t\t\tdelete this.cancelBlur;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._stop();\r\n\t\t\t\tthis._refresh();\r\n\t\t\t\tif ( this.previous !== this.element.val() ) {\r\n\t\t\t\t\tthis._trigger( \"change\", event );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmousewheel: function( event, delta ) {\r\n\t\t\t\tvar activeElement = $.ui.safeActiveElement( this.document[ 0 ] );\r\n\t\t\t\tvar isActive = this.element[ 0 ] === activeElement;\r\n\r\n\t\t\t\tif ( !isActive || !delta ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !this.spinning && !this._start( event ) ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._spin( ( delta > 0 ? 1 : -1 ) * this.options.step, event );\r\n\t\t\t\tclearTimeout( this.mousewheelTimer );\r\n\t\t\t\tthis.mousewheelTimer = this._delay( function() {\r\n\t\t\t\t\tif ( this.spinning ) {\r\n\t\t\t\t\t\tthis._stop( event );\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 100 );\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t},\r\n\t\t\t\"mousedown .ui-spinner-button\": function( event ) {\r\n\t\t\t\tvar previous;\r\n\r\n\t\t\t\t// We never want the buttons to have focus; whenever the user is\r\n\t\t\t\t// interacting with the spinner, the focus should be on the input.\r\n\t\t\t\t// If the input is focused then this.previous is properly set from\r\n\t\t\t\t// when the input first received focus. If the input is not focused\r\n\t\t\t\t// then we need to set this.previous based on the value before spinning.\r\n\t\t\t\tprevious = this.element[ 0 ] === $.ui.safeActiveElement( this.document[ 0 ] ) ?\r\n\t\t\t\t\tthis.previous : this.element.val();\r\n\t\t\t\tfunction checkFocus() {\r\n\t\t\t\t\tvar isActive = this.element[ 0 ] === $.ui.safeActiveElement( this.document[ 0 ] );\r\n\t\t\t\t\tif ( !isActive ) {\r\n\t\t\t\t\t\tthis.element.trigger( \"focus\" );\r\n\t\t\t\t\t\tthis.previous = previous;\r\n\r\n\t\t\t\t\t\t// support: IE\r\n\t\t\t\t\t\t// IE sets focus asynchronously, so we need to check if focus\r\n\t\t\t\t\t\t// moved off of the input because the user clicked on the button.\r\n\t\t\t\t\t\tthis._delay( function() {\r\n\t\t\t\t\t\t\tthis.previous = previous;\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Ensure focus is on (or stays on) the text field\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tcheckFocus.call( this );\r\n\r\n\t\t\t\t// Support: IE\r\n\t\t\t\t// IE doesn't prevent moving focus even with event.preventDefault()\r\n\t\t\t\t// so we set a flag to know when we should ignore the blur event\r\n\t\t\t\t// and check (again) if focus moved off of the input.\r\n\t\t\t\tthis.cancelBlur = true;\r\n\t\t\t\tthis._delay( function() {\r\n\t\t\t\t\tdelete this.cancelBlur;\r\n\t\t\t\t\tcheckFocus.call( this );\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tif ( this._start( event ) === false ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._repeat( null, $( event.currentTarget )\r\n\t\t\t\t\t.hasClass( \"ui-spinner-up\" ) ? 1 : -1, event );\r\n\t\t\t},\r\n\t\t\t\"mouseup .ui-spinner-button\": \"_stop\",\r\n\t\t\t\"mouseenter .ui-spinner-button\": function( event ) {\r\n\r\n\t\t\t\t// button will add ui-state-active if mouse was down while mouseleave and kept down\r\n\t\t\t\tif ( !$( event.currentTarget ).hasClass( \"ui-state-active\" ) ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( this._start( event ) === false ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthis._repeat( null, $( event.currentTarget )\r\n\t\t\t\t\t.hasClass( \"ui-spinner-up\" ) ? 1 : -1, event );\r\n\t\t\t},\r\n\r\n\t\t\t// TODO: do we really want to consider this a stop?\r\n\t\t\t// shouldn't we just stop the repeater and wait until mouseup before\r\n\t\t\t// we trigger the stop event?\r\n\t\t\t\"mouseleave .ui-spinner-button\": \"_stop\"\r\n\t\t},\r\n\r\n\t\t// Support mobile enhanced option and make backcompat more sane\r\n\t\t_enhance: function() {\r\n\t\t\tthis.uiSpinner = this.element\r\n\t\t\t\t.attr( \"autocomplete\", \"off\" )\r\n\t\t\t\t.wrap( \"<span>\" )\r\n\t\t\t\t.parent()\r\n\r\n\t\t\t\t\t// Add buttons\r\n\t\t\t\t\t.append(\r\n\t\t\t\t\t\t\"<a></a><a></a>\"\r\n\t\t\t\t\t);\r\n\t\t},\r\n\r\n\t\t_draw: function() {\r\n\t\t\tthis._enhance();\r\n\r\n\t\t\tthis._addClass( this.uiSpinner, \"ui-spinner\", \"ui-widget ui-widget-content\" );\r\n\t\t\tthis._addClass( \"ui-spinner-input\" );\r\n\r\n\t\t\tthis.element.attr( \"role\", \"spinbutton\" );\r\n\r\n\t\t\t// Button bindings\r\n\t\t\tthis.buttons = this.uiSpinner.children( \"a\" )\r\n\t\t\t\t.attr( \"tabIndex\", -1 )\r\n\t\t\t\t.attr( \"aria-hidden\", true )\r\n\t\t\t\t.button( {\r\n\t\t\t\t\tclasses: {\r\n\t\t\t\t\t\t\"ui-button\": \"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\r\n\t\t\t// TODO: Right now button does not support classes this is already updated in button PR\r\n\t\t\tthis._removeClass( this.buttons, \"ui-corner-all\" );\r\n\r\n\t\t\tthis._addClass( this.buttons.first(), \"ui-spinner-button ui-spinner-up\" );\r\n\t\t\tthis._addClass( this.buttons.last(), \"ui-spinner-button ui-spinner-down\" );\r\n\t\t\tthis.buttons.first().button( {\r\n\t\t\t\t\"icon\": this.options.icons.up,\r\n\t\t\t\t\"showLabel\": false\r\n\t\t\t} );\r\n\t\t\tthis.buttons.last().button( {\r\n\t\t\t\t\"icon\": this.options.icons.down,\r\n\t\t\t\t\"showLabel\": false\r\n\t\t\t} );\r\n\r\n\t\t\t// IE 6 doesn't understand height: 50% for the buttons\r\n\t\t\t// unless the wrapper has an explicit height\r\n\t\t\tif ( this.buttons.height() > Math.ceil( this.uiSpinner.height() * 0.5 ) &&\r\n\t\t\t\t\tthis.uiSpinner.height() > 0 ) {\r\n\t\t\t\tthis.uiSpinner.height( this.uiSpinner.height() );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_keydown: function( event ) {\r\n\t\t\tvar options = this.options,\r\n\t\t\t\tkeyCode = $.ui.keyCode;\r\n\r\n\t\t\tswitch ( event.keyCode ) {\r\n\t\t\tcase keyCode.UP:\r\n\t\t\t\tthis._repeat( null, 1, event );\r\n\t\t\t\treturn true;\r\n\t\t\tcase keyCode.DOWN:\r\n\t\t\t\tthis._repeat( null, -1, event );\r\n\t\t\t\treturn true;\r\n\t\t\tcase keyCode.PAGE_UP:\r\n\t\t\t\tthis._repeat( null, options.page, event );\r\n\t\t\t\treturn true;\r\n\t\t\tcase keyCode.PAGE_DOWN:\r\n\t\t\t\tthis._repeat( null, -options.page, event );\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t_start: function( event ) {\r\n\t\t\tif ( !this.spinning && this._trigger( \"start\", event ) === false ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif ( !this.counter ) {\r\n\t\t\t\tthis.counter = 1;\r\n\t\t\t}\r\n\t\t\tthis.spinning = true;\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t_repeat: function( i, steps, event ) {\r\n\t\t\ti = i || 500;\r\n\r\n\t\t\tclearTimeout( this.timer );\r\n\t\t\tthis.timer = this._delay( function() {\r\n\t\t\t\tthis._repeat( 40, steps, event );\r\n\t\t\t}, i );\r\n\r\n\t\t\tthis._spin( steps * this.options.step, event );\r\n\t\t},\r\n\r\n\t\t_spin: function( step, event ) {\r\n\t\t\tvar value = this.value() || 0;\r\n\r\n\t\t\tif ( !this.counter ) {\r\n\t\t\t\tthis.counter = 1;\r\n\t\t\t}\r\n\r\n\t\t\tvalue = this._adjustValue( value + step * this._increment( this.counter ) );\r\n\r\n\t\t\tif ( !this.spinning || this._trigger( \"spin\", event, { value: value } ) !== false ) {\r\n\t\t\t\tthis._value( value );\r\n\t\t\t\tthis.counter++;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_increment: function( i ) {\r\n\t\t\tvar incremental = this.options.incremental;\r\n\r\n\t\t\tif ( incremental ) {\r\n\t\t\t\treturn $.isFunction( incremental ) ?\r\n\t\t\t\t\tincremental( i ) :\r\n\t\t\t\t\tMath.floor( i * i * i / 50000 - i * i / 500 + 17 * i / 200 + 1 );\r\n\t\t\t}\r\n\r\n\t\t\treturn 1;\r\n\t\t},\r\n\r\n\t\t_precision: function() {\r\n\t\t\tvar precision = this._precisionOf( this.options.step );\r\n\t\t\tif ( this.options.min !== null ) {\r\n\t\t\t\tprecision = Math.max( precision, this._precisionOf( this.options.min ) );\r\n\t\t\t}\r\n\t\t\treturn precision;\r\n\t\t},\r\n\r\n\t\t_precisionOf: function( num ) {\r\n\t\t\tvar str = num.toString(),\r\n\t\t\t\tdecimal = str.indexOf( \".\" );\r\n\t\t\treturn decimal === -1 ? 0 : str.length - decimal - 1;\r\n\t\t},\r\n\r\n\t\t_adjustValue: function( value ) {\r\n\t\t\tvar base, aboveMin,\r\n\t\t\t\toptions = this.options;\r\n\r\n\t\t\t// Make sure we're at a valid step\r\n\t\t\t// - find out where we are relative to the base (min or 0)\r\n\t\t\tbase = options.min !== null ? options.min : 0;\r\n\t\t\taboveMin = value - base;\r\n\r\n\t\t\t// - round to the nearest step\r\n\t\t\taboveMin = Math.round( aboveMin / options.step ) * options.step;\r\n\r\n\t\t\t// - rounding is based on 0, so adjust back to our base\r\n\t\t\tvalue = base + aboveMin;\r\n\r\n\t\t\t// Fix precision from bad JS floating point math\r\n\t\t\tvalue = parseFloat( value.toFixed( this._precision() ) );\r\n\r\n\t\t\t// Clamp the value\r\n\t\t\tif ( options.max !== null && value > options.max ) {\r\n\t\t\t\treturn options.max;\r\n\t\t\t}\r\n\t\t\tif ( options.min !== null && value < options.min ) {\r\n\t\t\t\treturn options.min;\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t},\r\n\r\n\t\t_stop: function( event ) {\r\n\t\t\tif ( !this.spinning ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tclearTimeout( this.timer );\r\n\t\t\tclearTimeout( this.mousewheelTimer );\r\n\t\t\tthis.counter = 0;\r\n\t\t\tthis.spinning = false;\r\n\t\t\tthis._trigger( \"stop\", event );\r\n\t\t},\r\n\r\n\t\t_setOption: function( key, value ) {\r\n\t\t\tvar prevValue, first, last;\r\n\r\n\t\t\tif ( key === \"culture\" || key === \"numberFormat\" ) {\r\n\t\t\t\tprevValue = this._parse( this.element.val() );\r\n\t\t\t\tthis.options[ key ] = value;\r\n\t\t\t\tthis.element.val( this._format( prevValue ) );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( key === \"max\" || key === \"min\" || key === \"step\" ) {\r\n\t\t\t\tif ( typeof value === \"string\" ) {\r\n\t\t\t\t\tvalue = this._parse( value );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif ( key === \"icons\" ) {\r\n\t\t\t\tfirst = this.buttons.first().find( \".ui-icon\" );\r\n\t\t\t\tthis._removeClass( first, null, this.options.icons.up );\r\n\t\t\t\tthis._addClass( first, null, value.up );\r\n\t\t\t\tlast = this.buttons.last().find( \".ui-icon\" );\r\n\t\t\t\tthis._removeClass( last, null, this.options.icons.down );\r\n\t\t\t\tthis._addClass( last, null, value.down );\r\n\t\t\t}\r\n\r\n\t\t\tthis._super( key, value );\r\n\t\t},\r\n\r\n\t\t_setOptionDisabled: function( value ) {\r\n\t\t\tthis._super( value );\r\n\r\n\t\t\tthis._toggleClass( this.uiSpinner, null, \"ui-state-disabled\", !!value );\r\n\t\t\tthis.element.prop( \"disabled\", !!value );\r\n\t\t\tthis.buttons.button( value ? \"disable\" : \"enable\" );\r\n\t\t},\r\n\r\n\t\t_setOptions: spinnerModifier( function( options ) {\r\n\t\t\tthis._super( options );\r\n\t\t} ),\r\n\r\n\t\t_parse: function( val ) {\r\n\t\t\tif ( typeof val === \"string\" && val !== \"\" ) {\r\n\t\t\t\tval = window.Globalize && this.options.numberFormat ?\r\n\t\t\t\t\tGlobalize.parseFloat( val, 10, this.options.culture ) : +val;\r\n\t\t\t}\r\n\t\t\treturn val === \"\" || isNaN( val ) ? null : val;\r\n\t\t},\r\n\r\n\t\t_format: function( value ) {\r\n\t\t\tif ( value === \"\" ) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t\treturn window.Globalize && this.options.numberFormat ?\r\n\t\t\t\tGlobalize.format( value, this.options.numberFormat, this.options.culture ) :\r\n\t\t\t\tvalue;\r\n\t\t},\r\n\r\n\t\t_refresh: function() {\r\n\t\t\tthis.element.attr( {\r\n\t\t\t\t\"aria-valuemin\": this.options.min,\r\n\t\t\t\t\"aria-valuemax\": this.options.max,\r\n\r\n\t\t\t\t// TODO: what should we do with values that can't be parsed?\r\n\t\t\t\t\"aria-valuenow\": this._parse( this.element.val() )\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\tisValid: function() {\r\n\t\t\tvar value = this.value();\r\n\r\n\t\t\t// Null is invalid\r\n\t\t\tif ( value === null ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// If value gets adjusted, it's invalid\r\n\t\t\treturn value === this._adjustValue( value );\r\n\t\t},\r\n\r\n\t\t// Update the value without triggering change\r\n\t\t_value: function( value, allowAny ) {\r\n\t\t\tvar parsed;\r\n\t\t\tif ( value !== \"\" ) {\r\n\t\t\t\tparsed = this._parse( value );\r\n\t\t\t\tif ( parsed !== null ) {\r\n\t\t\t\t\tif ( !allowAny ) {\r\n\t\t\t\t\t\tparsed = this._adjustValue( parsed );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue = this._format( parsed );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.element.val( value );\r\n\t\t\tthis._refresh();\r\n\t\t},\r\n\r\n\t\t_destroy: function() {\r\n\t\t\tthis.element\r\n\t\t\t\t.prop( \"disabled\", false )\r\n\t\t\t\t.removeAttr( \"autocomplete role aria-valuemin aria-valuemax aria-valuenow\" );\r\n\r\n\t\t\tthis.uiSpinner.replaceWith( this.element );\r\n\t\t},\r\n\r\n\t\tstepUp: spinnerModifier( function( steps ) {\r\n\t\t\tthis._stepUp( steps );\r\n\t\t} ),\r\n\t\t_stepUp: function( steps ) {\r\n\t\t\tif ( this._start() ) {\r\n\t\t\t\tthis._spin( ( steps || 1 ) * this.options.step );\r\n\t\t\t\tthis._stop();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstepDown: spinnerModifier( function( steps ) {\r\n\t\t\tthis._stepDown( steps );\r\n\t\t} ),\r\n\t\t_stepDown: function( steps ) {\r\n\t\t\tif ( this._start() ) {\r\n\t\t\t\tthis._spin( ( steps || 1 ) * -this.options.step );\r\n\t\t\t\tthis._stop();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tpageUp: spinnerModifier( function( pages ) {\r\n\t\t\tthis._stepUp( ( pages || 1 ) * this.options.page );\r\n\t\t} ),\r\n\r\n\t\tpageDown: spinnerModifier( function( pages ) {\r\n\t\t\tthis._stepDown( ( pages || 1 ) * this.options.page );\r\n\t\t} ),\r\n\r\n\t\tvalue: function( newVal ) {\r\n\t\t\tif ( !arguments.length ) {\r\n\t\t\t\treturn this._parse( this.element.val() );\r\n\t\t\t}\r\n\t\t\tspinnerModifier( this._value ).call( this, newVal );\r\n\t\t},\r\n\r\n\t\twidget: function() {\r\n\t\t\treturn this.uiSpinner;\r\n\t\t}\r\n\t} );\r\n\r\n\t// DEPRECATED\r\n\t// TODO: switch return back to widget declaration at top of file when this is removed\r\n\tif ( $.uiBackCompat !== false ) {\r\n\r\n\t\t// Backcompat for spinner html extension points\r\n\t\t$.widget( \"ui.spinner\", $.ui.spinner, {\r\n\t\t\t_enhance: function() {\r\n\t\t\t\tthis.uiSpinner = this.element\r\n\t\t\t\t\t.attr( \"autocomplete\", \"off\" )\r\n\t\t\t\t\t.wrap( this._uiSpinnerHtml() )\r\n\t\t\t\t\t.parent()\r\n\r\n\t\t\t\t\t\t// Add buttons\r\n\t\t\t\t\t\t.append( this._buttonHtml() );\r\n\t\t\t},\r\n\t\t\t_uiSpinnerHtml: function() {\r\n\t\t\t\treturn \"<span>\";\r\n\t\t\t},\r\n\r\n\t\t\t_buttonHtml: function() {\r\n\t\t\t\treturn \"<a></a><a></a>\";\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\r\n\treturn $.ui.spinner;\r\n\r\n});\r\n"]}