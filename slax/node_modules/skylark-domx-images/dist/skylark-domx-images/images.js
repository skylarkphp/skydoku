/**
 * skylark-domx-images - The skylark image library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-domx-eventer","skylark-domx-noder","skylark-domx-finder","skylark-domx-geom","skylark-domx-styler","skylark-domx-data","skylark-domx-transforms","skylark-domx-query"],function(o,e,r,n,i,t,a,s,l,u){function f(o){e.isArray(o)||(o=[o]);var n=o.length,i=0,t=0,a=0,s=new e.Deferred;function l(){s.resolve({total:n,successed:t,failered:a,imgs:o})}function u(e,r){i++,r?t++:a++,s.progress({img:e,isLoaded:r,progressed:i,total:n,imgs:o}),i==n&&l()}return e.defer(function(){o.length?o.forEach(function(o){d(o)?u(o,c(o)):r.on(o,{load:function(){u(o,!0)},error:function(){u(o,!1)}})}):l()}),s.promise.totalCount=n,s.promise}function d(o){return o.complete&&void 0!==o.naturalWidth}function c(o){return o.complete&&0!==o.naturalWidth}function m(o,e){var r=[];function n(o){var e=/url\((['"])?(.*?)\1\)/gi.exec(a.css(o,"background-image")),n=e&&e[2];if(n){var i=new Image;i.src=n,r.push(i)}}if(e=e||{},"IMG"==o.nodeName)r.push(o);else{for(var t=i.findAll(o,"img"),s=0;s<t.length;s++)r.push(t[s]);if(!0===e.background)n(o);else if("string"==typeof e.background){var l=i.findAll(o,e.background);for(s=0;s<l.length;s++)n(l[s])}}return f(r)}function g(o,r){var i,s={},u=t.clientSize(o),f=r.loaded;r.failered;function d(){a.css(i,{top:(u.height-i.offsetHeight)/2+"px",left:(u.width-i.offsetWidth)/2+"px"}),l.reset(i),a.css(i,{visibility:"visible"}),f&&f()}function c(){}function m(o){i.style.visibility="hidden",i.src=o}"relative"!=(s=a.css(o,["position","overflow"])).position&&"absolute"!=s.position&&a.css(o,"position","relative"),a.css(o,"overflow","hidden"),i=new Image,a.css(i,{position:"absolute",border:0,padding:0,margin:0,width:"auto",height:"auto",visibility:"hidden"}),i.onload=d,i.onerror=c,n.append(o,i),r.url&&m(r.url);var g={load:m,dispose:function(){n.remove(i),a.css(o,s),i=i.onload=i.onerror=null}};return["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout","reset"].forEach(function(o){g[o]=function(){var r=e.makeArray(arguments);r.unshift(i),l[o].apply(null,r)}}),g}function h(){return h}return u.fn.imagesLoaded=function(o){return m(this,o)},u.fn.imagesViewer=function(o){return g(this,o)},h.transform=function(o,e){},["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout","reset"].forEach(function(o){h.transform[o]=l[o]}),e.mixin(h,{isCompleted:d,isLoaded:c,loaded:m,preload:function(o,r){e.isString(o)&&(o=[o]);var n=[];return o.forEach(function(o){var e=new Image;e.src=o,n.push(e)}),f(n)},viewer:g}),o.attach("domx.images",h)});
//# sourceMappingURL=sourcemaps/images.js.map
