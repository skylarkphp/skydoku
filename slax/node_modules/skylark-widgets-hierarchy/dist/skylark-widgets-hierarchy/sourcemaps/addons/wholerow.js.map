{"version":3,"sources":["addons/wholerow.js"],"names":["define","langx","browser","eventer","noder","geom","$","jstree","plugins","wholerow","div","document","createElement","setAttribute","className","innerHTML","options","parent","this","bind","call","element","on","proxy","hide_dots","get_container_ul","addClass","e","data","find","removeClass","i","j","tmp","selected","length","get_node","children","node","type","is_disabled","_data","contextmenu","preventDefault","Event","metaKey","ctrlKey","altKey","shiftKey","pageX","pageY","currentTarget","closest","first","trigger","stopImmediatePropagation","focus","hover_node","dehover_node","teardown","settings","remove","redraw_node","obj","deep","callback","force_render","apply","arguments","cloneNode","inArray","id","core","focused","insertBefore","childNodes"],"mappings":"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","file":"../../addons/wholerow.js","sourcesContent":["define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\",\r\n  \"../Hierarchy\"\r\n],function(langx,browser,eventer,noder,geom,$,jstree){\r\n\t\"use strict\";\r\n\r\n\tif($.jstree.plugins.wholerow) { return; }\r\n\r\n\tvar div = document.createElement('DIV');\r\n\tdiv.setAttribute('unselectable','on');\r\n\tdiv.setAttribute('role','presentation');\r\n\tdiv.className = 'jstree-wholerow';\r\n\tdiv.innerHTML = '&#160;';\r\n\t$.jstree.plugins.wholerow = function (options, parent) {\r\n\t\tthis.bind = function () {\r\n\t\t\tparent.bind.call(this);\r\n\r\n\t\t\tthis.element\r\n\t\t\t\t.on('ready.jstree set_state.jstree', langx.proxy(function () {\r\n\t\t\t\t\t\tthis.hide_dots();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"init.jstree loading.jstree ready.jstree\", langx.proxy(function () {\r\n\t\t\t\t\t\t//div.style.height = this._data.core.li_height + 'px';\r\n\t\t\t\t\t\tthis.get_container_ul().addClass('jstree-wholerow-ul');\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"deselect_all.jstree\", langx.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.element.find('.jstree-wholerow-clicked').removeClass('jstree-wholerow-clicked');\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"changed.jstree\", langx.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.element.find('.jstree-wholerow-clicked').removeClass('jstree-wholerow-clicked');\r\n\t\t\t\t\t\tvar tmp = false, i, j;\r\n\t\t\t\t\t\tfor(i = 0, j = data.selected.length; i < j; i++) {\r\n\t\t\t\t\t\t\ttmp = this.get_node(data.selected[i], true);\r\n\t\t\t\t\t\t\tif(tmp && tmp.length) {\r\n\t\t\t\t\t\t\t\ttmp.children('.jstree-wholerow').addClass('jstree-wholerow-clicked');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"open_node.jstree\", langx.proxy(function (e, data) {\r\n\t\t\t\t\t\tthis.get_node(data.node, true).find('.jstree-clicked').parent().children('.jstree-wholerow').addClass('jstree-wholerow-clicked');\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"hover_node.jstree dehover_node.jstree\", langx.proxy(function (e, data) {\r\n\t\t\t\t\t\tif(e.type === \"hover_node\" && this.is_disabled(data.node)) { return; }\r\n\t\t\t\t\t\tthis.get_node(data.node, true).children('.jstree-wholerow')[e.type === \"hover_node\"?\"addClass\":\"removeClass\"]('jstree-wholerow-hovered');\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"contextmenu.jstree\", \".jstree-wholerow\", langx.proxy(function (e) {\r\n\t\t\t\t\t\tif (this._data.contextmenu) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\tvar tmp = $.Event('contextmenu', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey, pageX : e.pageX, pageY : e.pageY });\r\n\t\t\t\t\t\t\t$(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t/*!\r\n\t\t\t\t.on(\"mousedown.jstree touchstart.jstree\", \".jstree-wholerow\", function (e) {\r\n\t\t\t\t\t\tif(e.target === e.currentTarget) {\r\n\t\t\t\t\t\t\tvar a = $(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\");\r\n\t\t\t\t\t\t\te.target = a[0];\r\n\t\t\t\t\t\t\ta.trigger(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t*/\r\n\t\t\t\t.on(\"click.jstree\", \".jstree-wholerow\", function (e) {\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\tvar tmp = $.Event('click', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });\r\n\t\t\t\t\t\t$(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp).focus();\r\n\t\t\t\t\t})\r\n\t\t\t\t.on(\"dblclick.jstree\", \".jstree-wholerow\", function (e) {\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\tvar tmp = $.Event('dblclick', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });\r\n\t\t\t\t\t\t$(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp).focus();\r\n\t\t\t\t\t})\r\n\t\t\t\t.on(\"click.jstree\", \".jstree-leaf > .jstree-ocl\", langx.proxy(function (e) {\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\tvar tmp = $.Event('click', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });\r\n\t\t\t\t\t\t$(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp).focus();\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"mouseover.jstree\", \".jstree-wholerow, .jstree-icon\", langx.proxy(function (e) {\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t\tif(!this.is_disabled(e.currentTarget)) {\r\n\t\t\t\t\t\t\tthis.hover_node(e.currentTarget);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}, this))\r\n\t\t\t\t.on(\"mouseleave.jstree\", \".jstree-node\", langx.proxy(function (e) {\r\n\t\t\t\t\t\tthis.dehover_node(e.currentTarget);\r\n\t\t\t\t\t}, this));\r\n\t\t};\r\n\t\tthis.teardown = function () {\r\n\t\t\tif(this.settings.wholerow) {\r\n\t\t\t\tthis.element.find(\".jstree-wholerow\").remove();\r\n\t\t\t}\r\n\t\t\tparent.teardown.call(this);\r\n\t\t};\r\n\t\tthis.redraw_node = function(obj, deep, callback, force_render) {\r\n\t\t\tobj = parent.redraw_node.apply(this, arguments);\r\n\t\t\tif(obj) {\r\n\t\t\t\tvar tmp = div.cloneNode(true);\r\n\t\t\t\t//tmp.style.height = this._data.core.li_height + 'px';\r\n\t\t\t\tif(langx.inArray(obj.id, this._data.core.selected) !== -1) { tmp.className += ' jstree-wholerow-clicked'; }\r\n\t\t\t\tif(this._data.core.focused && this._data.core.focused === obj.id) { tmp.className += ' jstree-wholerow-hovered'; }\r\n\t\t\t\tobj.insertBefore(tmp, obj.childNodes[0]);\r\n\t\t\t}\r\n\t\t\treturn obj;\r\n\t\t};\r\n\t};\r\n\t// include the wholerow plugin by default\r\n\t// $.jstree.defaults.plugins.push(\"wholerow\");\r\n\r\n\treturn $;\r\n\r\n});\r\n"]}