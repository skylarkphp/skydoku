/**
 * skylark-domx-contents - A dom plugin for  editing  the content of html element.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,n){var r=n.define,require=n.require,o="function"==typeof r&&r.amd,a=!o&&"undefined"!=typeof exports;if(!o&&!r){var s={};r=n.define=function(t,e,n){"function"==typeof n?(s[t]={factory:n,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var n=e.split("/"),r=t.split("/");n.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?n.pop():n.push(r[i]));return n.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):s[t]={factory:null,resolved:!0,exports:n}},require=n.require=function(t){if(!s.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=s[t];if(!module.resolved){var e=[];module.deps.forEach(function(t){e.push(require(t))}),module.exports=module.factory.apply(n,e)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-langx-ns/_attach",[],function(){return function(t,e,n){"string"==typeof e&&(e=e.split("."));for(var r=e.length,i=t,o=0,a=e[o++];o<r;)i=i[a]=i[a]||{},a=e[o++];return i[a]=n}}),t("skylark-langx-ns/ns",["./_attach"],function(t){var e={attach:function(n,r){return t(e,n,r)}};return e}),t("skylark-langx-ns/main",["./ns"],function(t){return t}),t("skylark-langx-ns",["skylark-langx-ns/main"],function(t){return t}),t("skylark-langx/skylark",["skylark-langx-ns"],function(t){return t}),t("skylark-langx-types/types",["skylark-langx-ns"],function(t){var e,n=Array.isArray,r={}.toString,i=(e={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t){e["[object "+t+"]"]=t.toLowerCase()}),function(t){return null==t?String(t):e[r.call(t)]||"object"}),o=n||function(t){return object&&object.constructor===Array};function a(t){var e;for(e in t)if(null!==t[e])return!1;return!0}function s(t){return"function"==i(t)}function l(t){return t&&t.nodeType}function u(t){return"number"==typeof t}function c(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function d(t){return"string"==typeof t}function f(t){return t&&t==t.window}return t.attach("langx.types",{isArray:o,isArrayLike:function(t){return!d(t)&&!l(t)&&"number"==typeof t.length&&!s(t)},isBoolean:function(t){return!0===t||!1===t||"[object Boolean]"===r.call(t)},isDefined:function(t){return void 0!==t},isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isElement:function(t){return!(!t||1!==t.nodeType)},isEmpty:a,isEmptyObject:a,isFunction:s,isHtmlNode:l,isNaN:function(t){return isNaN(t)},isNull:function(t){return null===t},isNumber:u,isNumeric:u,isObject:c,isPlainObject:function(t){return c(t)&&!f(t)&&Object.getPrototypeOf(t)==Object.prototype},isString:d,isSameOrigin:function(t){if(t){var e=location.protocol+"//"+location.hostname;return location.port&&(e+=":"+location.port),t.startsWith(e)}},isSymbol:function(t){return"symbol"==typeof t||isObjectLike(t)&&objectToString.call(t)==symbolTag},isUndefined:function(t){return void 0===t},isWindow:f,type:i})}),t("skylark-langx-types/main",["./types"],function(t){return t}),t("skylark-langx-types",["skylark-langx-types/main"],function(t){return t}),t("skylark-langx-numbers/numbers",["skylark-langx-ns","skylark-langx-types"],function(t,e){var n=e.isObject,r=e.isSymbol,i=1/0,o=1.7976931348623157e308,a=NaN,s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,d=parseInt;function f(t){if(!t)return 0===t?t:0;if((t=h(t))===i||t===-i){var e=t<0?-1:1;return e*o}return t==t?t:0}function h(t){if("number"==typeof t)return t;if(r(t))return a;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var i=u.test(t);return i||c.test(t)?d(t.slice(2),i?2:8):l.test(t)?a:+t}return t.attach("langx.numbers",{toFinite:f,toNumber:h,toInteger:function(t){var e=f(t),n=e%1;return e==e?n?e-n:e:0}})}),t("skylark-langx-numbers/main",["./numbers"],function(t){return t}),t("skylark-langx-numbers",["skylark-langx-numbers/main"],function(t){return t}),t("skylark-langx-objects/objects",["skylark-langx-ns/ns","skylark-langx-ns/_attach","skylark-langx-types","skylark-langx-numbers"],function(t,e,n,r){var i,o,a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,l=n.isBoolean,u=n.isFunction,c=n.isObject,d=n.isPlainObject,f=n.isArray,h=n.isArrayLike,p=n.isString,g=r.toInteger;var y,m,b="undefined"!=typeof Symbol?Symbol.prototype:null;function v(t){if(!c(t))return[];var e=[];for(var n in t)e.push(n);return e}function k(t,e){if(!f(e))return null!=t&&a.call(t,e);for(var n=e.length,r=0;r<n;r++){var i=e[r];if(null==t||!a.call(t,i))return!1;t=t[i]}return!!n}function x(t,e,n,r){for(var i in e)r&&void 0!==t[i]||(n&&(d(e[i])||f(e[i]))?(d(e[i])&&!d(t[i])&&(t[i]={}),f(e[i])&&!f(t[i])&&(t[i]=[]),x(t[i],e[i],n,r)):void 0!==e[i]&&(t[i]=e[i]));return t}function _(t){var e=s.call(arguments,0),n=e.shift(),r=!1;return l(e[e.length-1])&&(r=e.pop()),{target:n,sources:e,deep:r}}function w(){var t=_.apply(this,arguments);return t.sources.forEach(function(e){x(t.target,e,t.deep,!1)}),t.target}function N(t){for(var e=v(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r}return i=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&o(t,e,n,r)},o=function(t,e,n,r){var o=toString.call(t);if(o!==toString.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return b.valueOf.call(t)===b.valueOf.call(e)}var a="[object Array]"===o;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,l=e.constructor;if(s!==l&&!(u(s)&&s instanceof s&&u(l)&&l instanceof l)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var c=n.length;c--;)if(n[c]===t)return r[c]===e;if(n.push(t),r.push(e),a){if((c=t.length)!==e.length)return!1;for(;c--;)if(!i(t[c],e[c],n,r))return!1}else{var d,f=Object.keys(t);if(c=f.length,Object.keys(e).length!==c)return!1;for(;c--;)if(d=f[c],void 0===e[d]||!i(t[d],e[d],n,r))return!1}return n.pop(),r.pop(),!0},t.attach("langx.objects",{allKeys:v,attach:e,clone:function t(e,n){var r;if(void 0===e||null===e)r=e;else if(n&&e.clone)r=e.clone();else if(f(e)){r=[];for(var i=0;i<e.length;i++)r.push(t(e[i]))}else if(d(e))for(var o in r={},e)r[o]=t(e[o]);else r=e;return r},defaults:(y=v,m=!0,function(t){var e=arguments.length;if(m&&(t=Object(t)),e<2||null==t)return t;for(var n=1;n<e;n++)for(var r=arguments[n],i=y(r),o=i.length,a=0;a<o;a++){var s=i[a];m&&void 0!==t[s]||(t[s]=r[s])}return t}),each:function(t,e){var n,r,i,o;if(t)if(void 0===(n=t.length)){for(r in t)if(t.hasOwnProperty(r)&&(o=t[r],!1===e.call(o,r,o)))break}else for(i=0;i<n&&(o=t[i],!1!==e.call(o,i,o));i++);return this},extend:function(t){var e,n=s.call(arguments,1);"boolean"==typeof t&&(e=t,t=n.shift());0==n.length&&(n=[t],t=this);return n.forEach(function(n){w(t,n,e)}),t},has:k,isEqual:function(t,e){return i(t,e)},includes:function(t,e,n,r){t=h(t)?t:N(t),n=n&&!r?g(n):0;var i=t.length;n<0&&(n=nativeMax(i+n,0));return p(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&baseIndexOf(t,e,n)>-1},isMatch:function(t,e){var n=n(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0},keys:function(t){if(c(t))return[];var e=[];for(var n in t)k(t,n)&&e.push(n);return e},mixin:w,omit:function(t,e,n){if(!t)return null;for(var r=w({},t),i=1;i<arguments.length;i++){var o=arguments[i];o in t&&delete r[o]}return r},pick:function(t,e,n){if(!t)return null;for(var r={},i=1;i<arguments.length;i++){var o=arguments[i];o in t&&(r[o]=t[o])}return r},removeItem:function(t,e){if(f(t)){var n=t.indexOf(e);-1!=n&&t.splice(n,1)}else if(d(t))for(var r in t)if(t[r]==e){delete t[r];break}return this},result:function(t,e,n){f(e)||(e=e.split("."));var r=e.length;if(!r)return u(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=u(o)?o.call(t):o}return t},safeMixin:function(){var t=_.apply(this,arguments);return t.sources.forEach(function(e){x(t.target,e,t.deep,!0)}),t.target},values:N})}),t("skylark-langx-objects/main",["./objects"],function(t){return t}),t("skylark-langx-objects",["skylark-langx-objects/main"],function(t){return t}),t("skylark-langx-arrays/arrays",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(t,e,n){var r=Array.prototype.filter,i=Array.prototype.find,o=e.isArrayLike;function a(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function s(t){return t!=t}function l(t){if(o(t)){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(o(r))for(var i=0;i<r.length;i++)e.push(r[i]);else e.push(r)}return e}return t}return t.attach("langx.arrays",{baseFindIndex:a,baseIndexOf:function(t,e,n){if(e!=e)return a(t,s,n);var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1},compact:function(t){return r.call(t,function(t){return null!=t})},first:function(t,e){return e?t.slice(0,e):t[0]},filter:function(t,e){return r.call(t,e)},find:function(t,e){return i.call(t,e)},flatten:l,grep:function(t,e){var r=[];return n.each(t,function(t,n){e(n,t)&&r.push(n)}),r},inArray:function(t,e){if(!e)return-1;var n;if(e.indexOf)return e.indexOf(t);n=e.length;for(;n--;)if(e[n]===t)return n;return-1},makeArray:function(t,e,n){if(o(t))return(n||[]).concat(Array.prototype.slice.call(t,e||0));return[t]},merge:function(t,e){var n=e.length,r=t.length,i=0;if("number"==typeof n)for(;i<n;i++)t[r++]=e[i];else for(;void 0!==e[i];)t[r++]=e[i++];return t.length=r,t},forEach:function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n)},map:function(t,e){var n,r,i,a=[];if(o(t))for(r=0;r<t.length;r++)null!=(n=e.call(t[r],t[r],r))&&a.push(n);else for(i in t)null!=(n=e.call(t[i],t[i],i))&&a.push(n);return l(a)},reduce:function(t,e,n){return Array.prototype.reduce.call(t,e,n)},uniq:function(t){return r.call(t,function(e,n){return t.indexOf(e)==n})}})}),t("skylark-langx-arrays/main",["./arrays"],function(t){return t}),t("skylark-langx-arrays",["skylark-langx-arrays/main"],function(t){return t}),t("skylark-langx/arrays",["skylark-langx-arrays"],function(t){return t}),t("skylark-langx-klass/klass",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays"],function(t,e,n,r){var i=r.uniq,o=n.has,a=n.mixin,s=e.isArray,l=e.isDefined;var u=function(){function t(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function n(r,u,c,d){s(u)&&(d=c,c=u,u=null),u=u||Object,l(c)&&!s(c)&&(d=c,c=!1);var f=u;c&&(c=function(t,e){var n=[];return e.forEach(function(t){if(o(t,"__mixins__"))throw new Error("nested mixins");for(var e=[];t;)e.unshift(t),t=t.superclass;n=n.concat(e)}),(n=(n=i(n)).filter(function(e){for(var n=t;n;){if(e===n)return!1;if(o(n,"__mixins__"))for(var r=n.__mixins__,i=0;i<r.length;i++)if(r[i]===e)return!1;n=n.superclass}return!0})).length>0&&n}(f,c)),c&&(f=function(t,e){for(var n=t,r=0;r<e.length;r++){var i=new Function;i.prototype=Object.create(n.prototype),i.__proto__=n,i.superclass=null,a(i.prototype,e[r].prototype),i.prototype.__mixin__=e[r],n=i}return n}(f,c));var h=r.klassName||"",p=new Function("return function "+h+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return p.prototype=Object.create(f.prototype),p.prototype.constructor=p,p.superclass=u,p.__proto__=f,p._constructor||(p._constructor=t),c&&(p.__mixins__=c),p.partial||(p.partial=function(t,n){return function(t,n,r){var i=t.prototype,o=t.superclass.prototype,a=r&&r.noOverrided;r&&r.overrides;for(var s in n)if("constructor"!==s){var l=n[s];"function"==typeof n[s]?i[s]=l._constructor||a||"function"!=typeof o[s]?l:function(t,e,n){return function(){var t=this.overrided;this.overrided=n;var r=e.apply(this,arguments);return this.overrided=t,r}}(0,l,o[s]):e.isPlainObject(l)&&null!==l&&l.get?Object.defineProperty(i,s,l):i[s]=l}return t}(this,t,n)}),p.inherit||(p.inherit=function(t,e,r){return n(t,this,e,r)}),p.partial(r,d),p}}();return t.attach("langx.klass",u)}),t("skylark-langx-klass/main",["./klass"],function(t){return t}),t("skylark-langx-klass",["skylark-langx-klass/main"],function(t){return t}),t("skylark-langx/klass",["skylark-langx-klass"],function(t){return t}),t("skylark-langx/ArrayStore",["./klass"],function(t){var e=function(t){if(!t)return t;var n=!!t.then;function r(r){t[r]=function(){var i=arguments,o=Deferred.when(t,function(t){return e(Array.prototype[r].apply(t,i))});if("forEach"!==r||n)return o}}return n&&(t=Object.delegate(t)),r("forEach"),r("filter"),r("map"),null==t.total&&(t.total=Deferred.when(t,function(t){return t.length})),t},n=t({klassName:"ArrayStore",queryEngine:function(t,e){switch(typeof t){default:throw new Error("Can not query with a "+typeof t);case"object":case"undefined":var n=t;t=function(t){for(var e in n){var r=n[e];if(r&&r.test){if(!r.test(t[e],t))return!1}else if(r!=t[e])return!1}return!0};break;case"string":if(!this[t])throw new Error("No filter function "+t+" was found in store");t=this[t];case"function":}function r(n){var r=function(t,e,n){var r,i=0,o=t&&t.length||0,a=[];o&&"string"==typeof t&&(t=t.split(""));"string"==typeof e&&(e=cache[e]||buildFn(e));if(n)for(;i<o;++i)r=t[i],e.call(n,r,i,t)&&a.push(r);else for(;i<o;++i)r=t[i],e(r,i,t)&&a.push(r);return a}(n,t),i=e&&e.sort;if(i&&r.sort("function"==typeof i?i:function(t,e){for(var n,r=0;n=i[r];r++){var o=t[n.attribute],a=e[n.attribute];if(o=null!=o?o.valueOf():o,a=null!=a?a.valueOf():a,o!=a)return!!n.descending==(null==o||o>a)?-1:1}return 0}),e&&(e.start||e.count)){var o=r.length;(r=r.slice(e.start||0,(e.start||0)+(e.count||1/0))).total=o}return r}return r.matches=t,r},idProperty:"id",get:function(t){return this.data[this.index[t]]},getIdentity:function(t){return t[this.idProperty]},put:function(t,e){var n=this.data,r=this.index,i=this.idProperty,o=t[i]=e&&"id"in e?e.id:i in t?t[i]:Math.random();if(o in r){if(e&&!1===e.overwrite)throw new Error("Object already exists");n[r[o]]=t}else r[o]=n.push(t)-1;return o},add:function(t,e){return(e=e||{}).overwrite=!1,this.put(t,e)},remove:function(t){var e=this.index,n=this.data;if(t in e)return n.splice(e[t],1),this.setData(n),!0},query:function(t,n){return e(this.queryEngine(t,n)(this.data))},setData:function(t){t.items?(this.idProperty=t.identifier||this.idProperty,t=this.data=t.items):this.data=t,this.index={};for(var e=0,n=t.length;e<n;e++)this.index[t[e][this.idProperty]]=e},init:function(t){for(var e in t)this[e]=t[e];this.setData(this.data||[])}});return n}),t("skylark-langx-aspect/aspect",["skylark-langx-ns"],function(t){var e,n=0;function r(t){return function(r,i,o,a){var s,l=r[i];l&&l.target==r||(r[i]=s=function(){for(var t=n,r=arguments,i=s.before;i;)r=i.advice.apply(this,r)||r,i=i.next;if(s.around)var o=s.around.advice(this,r);for(var a=s.after;a&&a.id<t;){if(a.receiveArguments){var l=a.advice.apply(this,r);o=l===e?o:l}else o=a.advice.call(this,o,r);a=a.next}return o},l&&(s.around={advice:function(t,e){return l.apply(t,e)}}),s.target=r);var u=function(t,e,r,i){var o,a=t[e],s="around"==e;if(s){var l=r(function(){return a.advice(this,arguments)});o={remove:function(){l&&(l=t=r=null)},advice:function(t,e){return l?l.apply(t,e):a.advice(t,e)}}}else o={remove:function(){if(o.advice){var n=o.previous,i=o.next;i||n?(n?n.next=i:t[e]=i,i&&(i.previous=n)):delete t[e],t=r=o.advice=null}},id:n++,advice:r,receiveArguments:i};if(a&&!s)if("after"==e){for(;a.next&&(a=a.next););a.next=o,o.previous=a}else"before"==e&&(t[e]=o,o.next=a,a.previous=o);else t[e]=o;return o}(s||l,t,o,a);return o=null,u}}return t.attach("langx.aspect",{after:r("after"),around:r("around"),before:r("before")})}),t("skylark-langx-aspect/main",["./aspect"],function(t){return t}),t("skylark-langx-aspect",["skylark-langx-aspect/main"],function(t){return t}),t("skylark-langx/aspect",["skylark-langx-aspect"],function(t){return t}),t("skylark-langx-funcs/funcs",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(t,e,n){var r=n.mixin,i=Array.prototype.slice,o=e.isFunction,a=e.isString;function s(t,e){var n=2 in arguments&&i.call(arguments,2);if(o(t)){return function(){return t.apply(e,n?n.concat(i.call(arguments)):arguments)}}if(a(e))return n?(n.unshift(t[e],t),s.apply(null,n)):s(t[e],t);throw new TypeError("expected function")}var l=function(){function t(){}return function(e,n){t.prototype=e;var i=new t;return t.prototype=null,n&&r(i,n),i}}(),u={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},c=/(.)^/,d={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},f=/\\|'|\r|\n|\t|\u2028|\u2029/g;return t.attach("langx.funcs",{bind:s,debounce:function(t,e){var n;return function(){var r=this,i=arguments;n&&clearTimeout(n),n=setTimeout(function(){n=null,t.apply(r,i)},e)}},delegate:l,defer:function(t){requestAnimationFrame?requestAnimationFrame(t):setTimeoutout(t);return this},negate:function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(...e){return!t.apply(this,e)}},noop:function(){},proxy:s,returnTrue:function(){return!0},returnFalse:function(){return!1},templateSettings:u,template:function(t,e,r){var i;r=n.defaults({},r,u);var o=RegExp([(r.escape||c).source,(r.interpolate||c).source,(r.evaluate||c).source].join("|")+"|$","g"),a=0,l="__p+='";t.replace(o,function(e,n,r,i,o){return l+=t.slice(a,o).replace(f,function(t){return"\\"+d[t]}),n&&(l+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(l+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(l+="';\n"+i+"\n__p+='"),a=o+e.length,e}),l+="';\n",r.variable||(l="with(obj||{}){\n"+l+"}\n");l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{i=new Function(r.variable||"obj","_",l)}catch(t){throw t.source=l,t}if(e)return i(e,this);var h=s(function(t){return i.call(this,t,this)},this),p=r.variable||"obj";return h.source="function("+p+"){\n"+l+"}",h}})}),t("skylark-langx-funcs/main",["./funcs"],function(t){return t}),t("skylark-langx-funcs",["skylark-langx-funcs/main"],function(t){return t}),t("skylark-langx-async/Deferred",["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(t,e,n){"use strict";var r=Array.prototype.slice,i=e.proxy,o=t.makeArray,a=n.result,s=n.mixin;s(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(){for(var t=0;t<arguments.length;t++)this.then(arguments[t]);return this},fail:function(t){return this.catch(t),this}});var l=function(){var t=this;this.promise=u(new Promise(function(e,n){t._resolve=e,t._reject=n}))};function u(t){if(t.isResolved)return t;var e=!0,n=!1,r=!1,i=t.then(function(t){return r=!0,e=!1,t},function(t){throw n=!0,e=!1,t});i.isResolved=function(){return r},i.isPending=function(){return e},i.isRejected=function(){return n},i.state=function(){return r?"resolved":n?"rejected":"pending"};var o=[],a=[];return i.then=function(t,e,n){return n&&this.progress(n),u(Promise.prototype.then.call(this,t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)},e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)}))},i.progress=function(t){return o.forEach(function(e){t(e)}),a.push(t),this},i.pipe=i.then,i.notify=function(t){try{return o.push(t),a.forEach(function(e){return e(t)})}catch(t){this.reject(t)}return this},i}return l.prototype.resolve=function(t){var e=r.call(arguments);return this.resolveWith(null,e)},l.prototype.resolveWith=function(t,e){return(e=e?o(e):[]).__ctx__=t,this._resolve(e),this._resolved=!0,this},l.prototype.notify=function(t){var e=a(this,"promise");return e.notify(t),this},l.prototype.reject=function(t){var e=r.call(arguments);return this.rejectWith(null,e)},l.prototype.rejectWith=function(t,e){return(e=e?o(e):[]).__ctx__=t,this._reject(e),this._rejected=!0,this},l.prototype.isResolved=function(){var t=a(this,"promise");return t.isResolved()},l.prototype.isRejected=function(){var t=a(this,"promise");return t.isRejected()},l.prototype.state=function(){var t=a(this,"promise");return t.state()},l.prototype.then=function(t,e,n){var r=a(this,"promise");return r.then(t,e,n)},l.prototype.progress=function(t){var e=a(this,"promise");return e.progress(t)},l.prototype.catch=function(t){var e=a(this,"promise");return e.catch(t)},l.prototype.always=function(){var t=a(this,"promise");return t.always.apply(t,arguments),this},l.prototype.done=function(){var t=a(this,"promise");return t.done.apply(t,arguments),this},l.prototype.fail=function(t){var e=a(this,"promise");return e.fail(t),this},l.all=function(t){var e=new l;return Promise.all(t).then(e.resolve.bind(e),e.reject.bind(e)),a(e,"promise")},l.first=function(t){return u(Promise.race(t))},l.when=function(t,e,n,r){var o=t&&"function"==typeof t.then,a=o&&t instanceof Promise;if(!o)return arguments.length>1?e?e(t):t:(new l).resolve(t);if(!a){var s=new l(t.cancel);t.then(i(s.resolve,s),i(s.reject,s),s.notify),t=s.promise}return e||n||r?t.then(e,n,r):t},l.reject=function(t){var e=new l;return e.reject(t),e.promise},l.immediate=l.resolve=function(t){var e=new l;return e.resolve.apply(e,arguments),e.promise},l.promise=function(t){var e=new l;return t(e.resolve.bind(e),e.reject.bind(e),e.progress.bind(e)),e.promise},l}),t("skylark-langx-async/async",["skylark-langx-ns","skylark-langx-objects","./Deferred"],function(t,e,n){var r=e.each,i={Deferred:n,parallel:function(t,e,i){var o=[];return i=i||null,e=e||[],r(t,function(t,n){o.push(n.apply(i,e))}),n.all(o)},series:function(t,e,i){var o=[],a=new n,s=a.promise;return i=i||null,e=e||[],a.resolve(),r(t,function(t,n){s=s.then(function(){return n.apply(i,e)}),o.push(s)}),n.all(o)},waterful:function(t,e,i){var o=new n,a=o.promise;return i=i||null,e=e||[],o.resolveWith(i,e),r(t,function(t,e){a=a.then(e)}),a}};return t.attach("langx.async",i)}),t("skylark-langx-async/main",["./async"],function(t){return t}),t("skylark-langx-async",["skylark-langx-async/main"],function(t){return t}),t("skylark-langx/async",["skylark-langx-async"],function(t){return t}),t("skylark-langx-datetimes/datetimes",["skylark-langx-ns"],function(t){return t.attach("langx.datetimes",{parseMilliSeconds:function(t){var e=t.split(" "),n=parseInt(e[0]);if(isNaN(n))return 0;switch(e[1].trim().replace(/\./g,"")){case"minutes":case"minute":case"min":case"mm":case"m":return 6e4*n;case"hours":case"hour":case"HH":case"hh":case"h":case"H":return 36e5*n;case"seconds":case"second":case"sec":case"ss":case"s":return 1e3*n;case"days":case"day":case"DD":case"dd":case"d":return 864e5*n;case"months":case"month":case"MM":case"M":return 24192e5*n;case"weeks":case"week":case"W":case"w":return 6048e5*n;case"years":case"year":case"yyyy":case"yy":case"y":return 31536e6*n;default:return 0}}})}),t("skylark-langx-datetimes/main",["./datetimes"],function(t){return t}),t("skylark-langx-datetimes",["skylark-langx-datetimes/main"],function(t){return t}),t("skylark-langx/datetimes",["skylark-langx-datetimes"],function(t){return t}),t("skylark-langx/Deferred",["skylark-langx-async/Deferred"],function(t){return t}),t("skylark-langx-emitter/Event",["skylark-langx-objects","skylark-langx-funcs","skylark-langx-klass"],function(t,e,n){var r={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function i(n,i){return!i&&n.isDefaultPrevented||(i||(i=n),t.each(r,function(t,r){var o=i[t];n[t]=function(){return this[r]=e.returnTrue,o&&o.apply(i,arguments)},n[r]=e.returnFalse})),n}class o extends CustomEvent{constructor(e,n){super(e,n),t.safeMixin(this,n),i(this)}}return o.compatible=i,o}),t("skylark-langx-emitter/Emitter",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./Event"],function(t,e,n,r,i,o){var a=Array.prototype.slice,s=r.compact,l=e.isDefined,u=e.isPlainObject,c=e.isFunction,d=e.isString,f=e.isEmptyObject,h=n.mixin;n.safeMixin;function p(t){var e=(""+t).split(".");return{name:e[0],ns:e.slice(1).join(" ")}}var g=i({on:function(t,e,n,r,i,o){var a=this,s=this._hub||(this._hub={});return u(t)?(i=r,each(t,function(t,r){a.on(t,e,n,r,i,o)}),this):(d(e)||c(r)||(i=r,r=n,n=e,e=void 0),c(n)&&(i=r,r=n,n=null),d(t)&&(t=t.split(/\s/)),t.forEach(function(t){var a=p(t),l=a.name,u=a.ns;(s[l]||(s[l]=[])).push({fn:r,selector:e,data:n,ctx:i,ns:u,one:o})}),this)},one:function(t,e,n,r,i){return this.on(t,e,n,r,i,1)},emit:function(t){if(!this._hub)return this;var e=this;d(t)&&(t=new o(t)),Object.defineProperty(t,"target",{value:this});var n=a.call(arguments,1);return n=l(n)?[t].concat(n):[t],[t.type||t.name,"all"].forEach(function(r){var i=p(r),o=i.name,a=i.ns,l=e._hub[o];if(l){for(var u=l.length,c=!1,d=0;d<u;d++){if(t.isImmediatePropagationStopped&&t.isImmediatePropagationStopped())return this;var f=l[d];(!a||f.ns&&f.ns.startsWith(a))&&(t.data?f.data&&(t.data=h({},f.data,t.data)):t.data=f.data||null,f.fn.apply(f.ctx,n),f.one&&(l[d]=null,c=!0))}c&&(e._hub[r]=s(l))}}),this},listened:function(t){var e=(this._hub||(this._events={}))[t]||[];return e.length>0},listenTo:function(t,e,n,r){if(!t)return this;d(n)&&(n=this[n]),r?t.one(e,n,this):t.on(e,n,this);for(var i,o=this._listeningTo||(this._listeningTo=[]),a=0;a<o.length;a++)if(o[a].obj==t){i=o[a];break}i||o.push(i={obj:t,events:{}});var s=i.events,l=s[e]=s[e]||[];return-1==l.indexOf(n)&&l.push(n),this},listenToOnce:function(t,e,n){return this.listenTo(t,e,n,1)},off:function(t,e){var n=this._hub||(this._hub={});return d(t)&&(t=t.split(/\s/)),t.forEach(function(t){var r=p(t),i=r.name,o=r.ns,a=n[i];if(a){var s=[];if(e||o)for(var l=0,u=a.length;l<u;l++)e&&a[l].fn!==e&&a[l].fn._!==e?s.push(a[l]):!o||a[l].ns&&0==a[l].ns.indexOf(o)||s.push(a[l]);s.length?n[i]=s:delete n[i]}}),this},unlistenTo:function(t,e,n){var r=this._listeningTo;if(!r)return this;for(var i=0;i<r.length;i++){var o=r[i];if(!t||t==o.obj){var a=o.events;for(var l in a)if(!e||e==l){for(var u=a[l],c=0;c<u.length;c++)n&&n!=u[i]||(o.obj.off(l,u[i],this),u[i]=null);u=a[l]=s(u),f(u)&&(a[l]=null)}f(a)&&(r[i]=null)}}return r=this._listeningTo=s(r),f(r)&&(this._listeningTo=null),this},trigger:function(){return this.emit.apply(this,arguments)}});return g.createEvent=function(t,e){return new o(t,e)},g.Event=o,t.attach("langx.Emitter",g)}),t("skylark-langx-emitter/Evented",["skylark-langx-ns/ns","./Emitter"],function(t,e){return t.attach("langx.Evented",e)}),t("skylark-langx-emitter/main",["./Emitter","./Evented"],function(t){return t}),t("skylark-langx-emitter",["skylark-langx-emitter/main"],function(t){return t}),t("skylark-langx/Emitter",["skylark-langx-emitter"],function(t){return t}),t("skylark-langx/Evented",["skylark-langx-emitter"],function(t){return t}),t("skylark-langx/funcs",["skylark-langx-funcs"],function(t){return t}),t("skylark-langx-hoster/hoster",["skylark-langx-ns"],function(t){var e={isBrowser:!0,isNode:null,global:this,browser:null,node:null};"object"==typeof process&&process.versions&&process.versions.node&&process.versions.v8&&(e.isNode=!0,e.isBrowser=!1),e.global=function(){return"undefined"!=typeof global&&"function"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}();var n=null;if(Object.defineProperty(e,"document",function(){if(!n){var t="undefined"==typeof window?require("html-element"):window;n=t.document}return n}),e.isBrowser){var r=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(navigator.userAgent),i=e.browser={};r.browser&&(i[r.browser]=!0,i.version=r.version),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0)}return t.attach("langx.hoster",e)}),t("skylark-langx-hoster/main",["./hoster"],function(t){return t}),t("skylark-langx-hoster",["skylark-langx-hoster/main"],function(t){return t}),t("skylark-langx/hoster",["skylark-langx-hoster"],function(t){return t}),t("skylark-langx/numbers",["skylark-langx-numbers"],function(t){return t}),t("skylark-langx/objects",["skylark-langx-objects"],function(t){return t}),t("skylark-langx-strings/strings",["skylark-langx-ns"],function(t){var e=Object.freeze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"});function n(t){return e[t]}var r=/[&<>"'`=]/g;var i=0;function o(t,e){var n,r,i,o,a,s,l,u=arguments.callee;return u.cache[t]||(u.cache[t]=(n=t,r=/^[\w\-]+$/.test(t)?u.get(t):(n="template(string)",t),i=1,o=("try { "+(u.variable?"var "+u.variable+" = this.stash;":"with (this.stash) { ")+"this.ret += '"+r.replace(/<%/g,"").replace(/%>/g,"").replace(/'(?![^\x11\x13]+?\x13)/g,"\\x27").replace(/^\s*|\s*$/g,"").replace(/\n|\r\n/g,function(){return"';\nthis.line = "+ ++i+"; this.ret += '\\n"}).replace(/\x11=raw(.+?)\x13/g,"' + ($1) + '").replace(/\x11=(.+?)\x13/g,"' + this.escapeHTML($1) + '").replace(/\x11(.+?)\x13/g,"'; $1; this.ret += '")+"'; "+(u.variable?"":"}")+"return this.ret;} catch (e) { throw 'TemplateError: ' + e + ' (on "+n+"' + ' line ' + this.line + ')'; } //@ sourceURL="+n+"\n").replace(/this\.ret \+= '';/g,""),a=new Function(o),s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#x22;","'":"&#x27;"},l=function(t){return(""+t).replace(/[&<>\'\"]/g,function(t){return s[t]})},function(t){return a.call(u.context={escapeHTML:l,line:1,ret:"",stash:t})})),e?u.cache[t](e):u.cache[t]}return o.cache={},o.get=function(t){return document.getElementById(t).innerHTML},t.attach("langx.strings",{camelCase:function(t){return t.replace(/-([\da-z])/g,function(t){return t.toUpperCase().replace("-","")})},dasherize:function(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},deserializeValue:function(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?JSON.parse(t):t):t}catch(e){return t}},escapeHTML:function(t){if(null==t)return"";if(!t)return String(t);return t.toString().replace(r,n)},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})},lowerFirst:function(t){return t.charAt(0).toLowerCase()+t.slice(1)},rtrim:function(t){return t.replace(/\s+$/g,"")},serializeValue:function(t){return JSON.stringify(t)},substitute:function(t,e,n,r){function i(t,e){if(t.match(/\./)){var n,r=function(t,e){var i=t.pop();return i?e[i]?r(t,n=e[i]):null:n};return r(t.split(".").reverse(),e)}return e[t]}return r=r||window,n=n?proxy(r,n):function(t){return t},t.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(t,o,a){var s=i(o,e);return a&&(s=i(a,r).call(r,s,o)),n(s,o).toString()})},slugify:function(t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var e="ÁÄÂÀÃÅČÇĆĎÉĚËÈÊẼĔȆÍÌÎÏŇÑÓÖÒÔÕØŘŔŠŤÚŮÜÙÛÝŸŽáäâàãåčçćďéěëèêẽĕȇíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",n=0,r=e.length;n<r;n++)t=t.replace(new RegExp(e.charAt(n),"g"),"AAAAAACCCDEEEEEEEEIIIINNOOOOOORRSTUUUUUYYZaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbBDdBAa------".charAt(n));return t=t.replace(/\s+/g,"-").replace(/-+/g,"-")},trim:function(t){return null==t?"":String.prototype.trim.call(t)},uniqueId:function(t){var e=++i+"";return t?t+e:e},upperFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}})}),t("skylark-langx-strings/base64",["./strings"],function(t){return t.base64={decode:function(t,e){e=null!=e&&e;var n,r,i,o,a,s,l,u="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(;c<t.length;)o=this._keyStr.indexOf(t.charAt(c++)),a=this._keyStr.indexOf(t.charAt(c++)),s=this._keyStr.indexOf(t.charAt(c++)),l=this._keyStr.indexOf(t.charAt(c++)),n=o<<2|a>>4,r=(15&a)<<4|s>>2,i=(3&s)<<6|l,u+=String.fromCharCode(n),64!=s&&(u+=String.fromCharCode(r)),64!=l&&(u+=String.fromCharCode(i));e||(u=function(t){var e="",n=0,r=c1=c2=0;for(;n<t.length;)(r=t.charCodeAt(n))<128?(e+=String.fromCharCode(r),n++):r>191&&r<224?(c2=t.charCodeAt(n+1),e+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return e}(u));return u},encode:function(t,e){var n,r,i,o,a,s,l,u="",c=0;(e=null!=e&&e)||(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}(t));for(;c<t.length;)n=t.charCodeAt(c++),r=t.charCodeAt(c++),i=t.charCodeAt(c++),o=n>>2,a=(3&n)<<4|r>>4,s=(15&r)<<2|i>>6,l=63&i,isNaN(r)?s=l=64:isNaN(i)&&(l=64),u=u+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return u}}}),t("skylark-langx-strings/main",["./strings","./base64"],function(t){return t}),t("skylark-langx-strings",["skylark-langx-strings/main"],function(t){return t}),t("skylark-langx/strings",["skylark-langx-strings"],function(t){return t}),t("skylark-langx/Stateful",["./Evented","./strings","./objects"],function(t,e,n){var r=n.isEqual,i=n.mixin,o=n.result,a=n.isEmptyObject,s=n.clone,l=e.uniqueId,u=t.inherit({_construct:function(t,e){var n=t||{};e||(e={}),this.cid=l(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var r=o(this,"defaults");n=i({},r,n),this.set(n,e),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(t){return s(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return null!=this.get(t)},set:function(t,e,n){if(null==t)return this;var i;if("object"==typeof t?(i=t,n=e):(i={})[t]=e,n||(n={}),!this._validate(i,n))return!1;var o=n.unset,a=n.silent,l=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=s(this.attributes),this.changed={});var c=this.attributes,d=this.changed,f=this._previousAttributes;for(var h in i)e=i[h],r(c[h],e)||l.push(h),r(f[h],e)?delete d[h]:d[h]=e,o?delete c[h]:c[h]=e;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!a){l.length&&(this._pending=n);for(var p=0;p<l.length;p++)this.trigger("change:"+l[p],this,c[l[p]],n)}if(u)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i({},t,{unset:!0}))},hasChanged:function(t){return null==t?!a(this.changed):void 0!==this.changed[t]},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&s(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var i in t){var o=t[i];r(e[i],o)||(n[i]=o)}return!a(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i(e,{validationError:n})),!1)}});return u}),t("skylark-langx-topic/topic",["skylark-langx-ns","skylark-langx-emitter/Evented"],function(t,e){var n=new e;return t.attach("langx.topic",{publish:function(t,e,r){var i=[].slice.call(arguments,1);return n.trigger({type:t,data:i})},subscribe:function(t,e,r){var i=function(t){e.apply(r,t.data)};return n.on(t,i),{remove:function(){n.off(t,i)}}}})}),t("skylark-langx-topic/main",["./topic"],function(t){return t}),t("skylark-langx-topic",["skylark-langx-topic/main"],function(t){return t}),t("skylark-langx/topic",["skylark-langx-topic"],function(t){return t}),t("skylark-langx/types",["skylark-langx-types"],function(t){return t}),t("skylark-langx/langx",["./skylark","./arrays","./ArrayStore","./aspect","./async","./datetimes","./Deferred","./Emitter","./Evented","./funcs","./hoster","./klass","./numbers","./objects","./Stateful","./strings","./topic","./types"],function(t,e,n,r,i,o,a,s,l,u,c,d,f,h,p,g,y,m){"use strict";Array.prototype.concat,Array.prototype.indexOf,Array.prototype.slice,Array.prototype.filter;var b=h.mixin,v=(h.safeMixin,m.isFunction);var k=1;function x(){return x}return b(x,{createEvent:s.createEvent,funcArg:function(t,e,n,r){return v(e)?e.call(t,n,r):e},getQueryParams:function(t){var e=(t=t||window.location.href).split("?"),n={};e.length>1&&e[1].split("&").forEach(function(t){var e=t.split("=");n[e[0]]=e[1]});return n},toPixel:function(t){return parseFloat(t)||0},uid:function(t){return t._uid||(t._uid=k++)},URL:"undefined"!=typeof window?window.URL||window.webkitURL:null}),b(x,e,r,o,u,f,h,g,m,{ArrayStore:n,async:i,Deferred:a,Emitter:s,Evented:l,hoster:c,klass:d,Stateful:p,topic:y}),t.langx=x}),t("skylark-domx-browser/browser",["skylark-langx/skylark","skylark-langx/langx"],function(t,e){"use strict";var n,r,i=e.hoster.browser,o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},a=null,s="",l="",u={},c={},d=/^(Webkit|webkit|O|Moz|moz|ms)(.*)$/,f=window.document,h=f.createElement("div"),p=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.matchesSelector,g=h.requestFullscreen||h.webkitRequestFullscreen||h.mozRequestFullScreen||h.msRequestFullscreen,y=(f.exitFullscreen||f.webkitCancelFullScreen||f.mozCancelFullScreen||f.msExitFullscreen,h.style);for(var m in y){var b=m.match(r||d);if(b){r||(n=b[1],r=new RegExp("^("+n+")(.*)$"),n,s="-"+n.toLowerCase()+"-",l=n.toLowerCase()),u[e.lowerFirst(b[2])]=m;var v=e.dasherize(b[2]);c[v]=s+v,o[m]&&(a=o[m])}}return a||void 0!==y.transition&&(a=o.transition),e.mixin(i,{css3PropPrefix:s,isIE:!!/msie/i.exec(window.navigator.userAgent),normalizeStyleProperty:function(t){return u[t]||t},normalizeCssProperty:function(t){return c[t]||t},normalizeCssEvent:function(t){return l?l+t:t.toLowerCase()},matchesSelector:p,requestFullScreen:g,exitFullscreen:g,location:function(){return window.location},support:{}}),a&&(i.support.transition={end:a}),h=null,t.attach("domx.browser",i)}),t("skylark-domx-browser/main",["./browser"],function(t){return t}),t("skylark-domx-browser",["skylark-domx-browser/main"],function(t){return t}),t("skylark-domx-noder/noder",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser"],function(t,e,n){var r=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),i=/^\s*<(\w+|!)[^>]*>/,o=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,a=document.createElement("div"),s=document.createElement("table"),l=document.createElement("tbody"),u=document.createElement("tr"),c={tr:l,tbody:s,thead:s,tfoot:s,td:u,th:u,"*":a},d=/^(?:body|html)$/i,f=Array.prototype.map,h=Array.prototype.slice;function p(t,n){return e.isArrayLike(t)||(t=[t]),n&&(t=f.call(t,function(t){return t.cloneNode(!0)})),e.flatten(t)}function g(t,e){var n=t.nodeName&&t.nodeName.toLowerCase();return void 0!==e?n===e.toLowerCase():n}function y(t,n){if(e.isFunction(t))return t.apply(n,[]);if(e.isArrayLike(t)){for(var r,i=0;i<t.length;i++)e.isFunction(t[i])&&(t[i]=t[i].apply(n,[]),e.isArrayLike(t[i])&&(r=!0));r&&(t=e.flatten(t))}return t}function m(t,e,n){e=y(e,t);for(var r=t,i=p(e,n),o=0;o<i.length;o++)r.appendChild(i[o]);return this}function b(t,e,n){var r;if(r=/svg/i.test(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t),e)for(var i in e)r.setAttribute(i,e[i]);return n&&m(n,r),r}var v=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;function k(t,e,n){if(n)return t.parentNode===e;if(document.documentElement.contains)return e.contains(t);for(;t;){if(e===t)return!0;t=t.parentNode}return!1}function x(t){return t?9==t.nodeType?t:t.ownerDocument:document}function _(){return _}return e.mixin(_,{active:function(t){var e;t=t||document;try{e=t.activeElement}catch(n){e=t.body}e||(e=t.body);e.nodeName||(e=t.body);return e},after:function(t,e,n){e=y(e,t);var r=(o=t).parentNode;if(r)for(var i=p(e,n),o=o.nextSibling,a=0;a<i.length;a++)o?r.insertBefore(i[a],o):r.appendChild(i[a]);return this},append:m,before:function(t,e,n){e=y(e,t);var r=t,i=r.parentNode;if(i)for(var o=p(e,n),a=0;a<o.length;a++)i.insertBefore(o[a],r);return this},blur:function(t){t.blur()},body:function(){return document.body},clone:function(t,e){var n,i=this;if(!r||1!==t.nodeType||e)return t.cloneNode(e);if(!e)return n=document.createElement(t.nodeName),each(i.getAttribs(t),function(e){i.setAttrib(n,e.nodeName,i.getAttrib(t,e.nodeName))}),n},contains:function(t,e){return k(e,t)},contents:function(t){if(g(t,"iframe"))return t.contentDocument;return t.childNodes},createElement:b,createFragment:function(t){if(t=e.trim(t),o.test(t))return[b(RegExp.$1)];var n=i.test(t)&&RegExp.$1;n in c||(n="*");var r=c[n];return r.innerHTML=function(t){for(var e=t.split("/>"),n="",r=0;r<e.length-1;r++){var i=e[r].split("<");n+=e[r]+"></"+i[i.length-1].split(" ")[0]+">"}return n+e[e.length-1]}(""+t),dom=h.call(r.childNodes),dom.forEach(function(t){r.removeChild(t)}),dom},createTextNode:function(t){return document.createTextNode(t)},doc:function(){return document},empty:function(t){for(;t.hasChildNodes();){var e=t.firstChild;t.removeChild(e)}return this},fullScreen:function(t){if(!1===t)n.exitFullScreen.apply(document);else{if(!t)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n.requestFullScreen.apply(t),t}},focusable:function(t,e){var n,r,i,o,a,s=t.nodeName.toLowerCase();if("area"===s)return n=t.parentNode,r=n.name,!(!t.href||!r||"map"!==n.nodeName.toLowerCase())&&((i=$("img[usemap='#"+r+"']")).length>0&&i.is(":visible"));/^(input|select|textarea|button|object)$/.test(s)?(o=!t.disabled)&&(a=$(t).closest("fieldset")[0])&&(o=!a.disabled):o="a"===s&&t.href||e;return o&&$(t).is(":visible")&&visible($(t))},html:function(t,n){if(void 0===n)return t.innerHTML;if(this.empty(t),n=n||"",e.isString(n)&&(n=n.replace(v,"<$1></$2>")),e.isString(n)||e.isNumber(n))t.innerHTML=n;else if(e.isArrayLike(n))for(var r=0;r<n.length;r++)t.appendChild(n[r]);else t.appendChild(n);return this},isActive:function(t){return t===document.activeElement&&(t.type||t.href)},isChildOf:k,isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isInDocument:function(t){return t===document.body||document.body.contains(t)},isWindow:e.isWindow,nodeName:g,offsetParent:function(t){var e=t.offsetParent||document.body;for(;e&&!d.test(e.nodeName)&&"static"==document.defaultView.getComputedStyle(e).position;)e=e.offsetParent;return e},ownerDoc:x,ownerWindow:function(t){var e=x(t);return e.defaultView||e.parentWindow},prepend:function(t,e,n){for(var r=t,i=r.firstChild,o=p(e,n),a=0;a<o.length;a++)i?r.insertBefore(o[a],i):r.appendChild(o[a]);return this},reflow:function(t){null==el&&(t=document);return t.offsetHeight,this},remove:function(t){if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch(t){console.warn("The node is already removed",t)}return this},removeChild:function(t,n){e.isArrayLike(n)||(n=[n]);for(var r=0;r<n.length;r++)t.removeChild(n[r]);return this},replace:function(t,e){return e.parentNode.replaceChild(t,e),this},selectable:function(t,e){if(void 0===t||void 0===t.style)return;t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off"},traverse:function t(e,n){n(e);for(var r=0,i=e.childNodes.length;r<i;r++)t(e.childNodes[r],n);return this},reverse:function(t){for(var e=t.firstChild,n=t.children.length-1;n>0;n--)if(n>0){var r=t.children[n];t.insertBefore(r,e)}},wrapper:function(t,n){e.isString(n)&&(n=this.createFragment(n).firstChild);t.parentNode.insertBefore(n,t),n.appendChild(t)},wrapperInner:function(t,e){var n=h.call(t.childNodes);t.appendChild(e);for(var r=0;r<n.length;r++)e.appendChild(n[r]);return this},unwrap:function(t){var e=t.parentNode;if(e){if(this.isDoc(e.parentNode))return;e.parentNode.insertBefore(t,e)}}}),t.attach("domx.noder",_)}),t("skylark-domx-noder/main",["./noder"],function(t){return t}),t("skylark-domx-noder",["skylark-domx-noder/main"],function(t){return t}),t("skylark-domx-finder/finder",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder"],function(t,e,n,r){var o={},a=Array.prototype.filter,s=Array.prototype.slice,l=n.matchesSelector;(function(){var t,e,n,r,i,o={},a={},s=/\\/g,l=function(n,i){if(null==n)return null;if(!0===n.Slick)return n;n=(""+n).replace(/^\s+|\s+$/g,"");var s=(r=!!i)?a:o;if(s[n])return s[n];for(t={Slick:!0,expressions:[],raw:n,reverse:function(){return l(this.raw,!0)}},e=-1;n!=(n=n.replace(f,h)););return t.length=t.expressions.length,s[t.raw]=r?c(t):t},u=function(t){return"!"===t?" ":" "===t?"!":/^!/.test(t)?t.replace(/^!/,""):"!"+t},c=function(t){for(var e=t.expressions,n=0;n<e.length;n++){for(var r=e[n],i={parts:[],tag:"*",combinator:u(r[0].combinator)},o=0;o<r.length;o++){var a=r[o];a.reverseCombinator||(a.reverseCombinator=" "),a.combinator=a.reverseCombinator,delete a.reverseCombinator}r.reverse().push(i)}return t},d=(i=/(?=[\-\[\]{}()*+?.\\\^$|,#\s])/g,function(t){return t.replace(i,"\\")}),f=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+d(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function h(i,o,a,l,c,f,h,p,g,y,m,b,v,k,x,_){if((o||-1===e)&&(t.expressions[++e]=[],n=-1,o))return"";if(a||l||-1===n){a=a||" ";var w=t.expressions[e];r&&w[n]&&(w[n].reverseCombinator=u(a)),w[++n]={combinator:a,tag:"*"}}var N=t.expressions[e][n];if(c)N.tag=c.replace(s,"");else if(f)N.id=f.replace(s,"");else if(h)h=h.replace(s,""),N.classList||(N.classList=[]),N.classes||(N.classes=[]),N.classList.push(h),N.classes.push({value:h,regexp:new RegExp("(^|\\s)"+d(h)+"(\\s|$)")});else if(v)_=(_=_||x)?_.replace(s,""):null,N.pseudos||(N.pseudos=[]),N.pseudos.push({key:v.replace(s,""),value:_,type:1==b.length?"class":"element"});else if(p){var A,S;switch(p=p.replace(s,""),m=(m||"").replace(s,""),g){case"^=":S=new RegExp("^"+d(m));break;case"$=":S=new RegExp(d(m)+"$");break;case"~=":S=new RegExp("(^|\\s)"+d(m)+"(\\s|$)");break;case"|=":S=new RegExp("^"+d(m)+"(-|$)");break;case"=":A=function(t){return m==t};break;case"*=":A=function(t){return t&&t.indexOf(m)>-1};break;case"!=":A=function(t){return m!=t};break;default:A=function(t){return!!t}}""==m&&/^[*$^]=$/.test(g)&&(A=function(){return!1}),A||(A=function(t){return t&&S.test(t)}),N.attributes||(N.attributes=[]),N.attributes.push({key:p,operator:g,value:m,test:A})}return""}var p=this.Slick||{};p.parse=function(t){return l(t)},p.escapeRegExp=d,this.Slick||(this.Slick=p)}).apply(o);var u=/^(?:input|select|textarea|button)$/i,c=/^h\d$/i,s=Array.prototype.slice;o.parseSelector=o.Slick.parse;var d=o.pseudos={button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},checked:function(t){return!!t.checked},contains:function(t,e,n,r){if($(this).text().indexOf(r)>-1)return this},disabled:function(t){return!!t.disabled},enabled:function(t){return!t.disabled},eq:function(t,e,n,r){return e==r},even:function(t,e,n,r){return e%2==0},focus:function(t){return document.activeElement===t&&(t.href||t.type||t.tabindex)},focusable:function(t){return r.focusable(t,null!=t.tabindex)},first:function(t,e){return 0===e},gt:function(t,e,n,r){return e>r},has:function(t,e,n,r){return b(t,r)},header:function(t){return c.test(t.nodeName)},hidden:function(t){return!o.pseudos.visible(t)},input:function(t){return u.test(t.nodeName)},last:function(t,e,n){return e===n.length-1},lt:function(t,e,n,r){return e<r},not:function(t,e,n,r){return!x(t,r)},odd:function(t,e,n,r){return e%2==1},parent:function(t){return!!t.parentNode},selected:function(t){return!!t.selected},tabbable:function(t){var e=t.tabindex,n=null!=e;return(!n||e>=0)&&r.focusable(element,n)},text:function(t){return"text"===t.type},visible:function(t){return t.offsetWidth&&t.offsetWidth},empty:function(t){return!t.hasChildNodes()}};function f(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function h(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}for(i in["first","eq","last"].forEach(function(t){d[t].isArrayFilter=!0}),d.nth=d.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d[i]=f(i);for(i in{submit:!0,reset:!0})d[i]=h(i);function p(t,n,r){for(var i=[],o=r&&e.isString(r);(t=t.parentNode)&&9!==t.nodeType;){if(r)if(o){if(x(t,r))break}else if(e.isArrayLike(r)){if(e.inArray(t,r)>-1)break}else if(t==r)break;n&&!x(t,n)||i.push(t)}return i}function g(t,e){for(var n=t.childNodes,r=[],i=0;i<n.length;i++){var t=n[i];1==t.nodeType&&r.push(t)}return e&&(r=o.filter(r,e)),r}function y(t,e){try{return s.call(t.querySelectorAll(e))}catch(t){}return o.query(t,e)}function m(t,e){try{return t.querySelector(e)}catch(t){}var n=o.query(t,e);return n.length>0?n[0]:null}function b(t,e){return e||(e=t,t=document.body),x(t,e)?t:m(t,e)}function v(t,e,n){for(var r=t.childNodes,i=r[0];i;){if(1==i.nodeType){if(!e||x(i,e))return i;if(n)break}i=i.nextSibling}return null}function k(t,e,n){for(var r=t.childNodes,i=r[r.length-1];i;){if(1==i.nodeType){if(!e||x(i,e))return i;if(n)break}i=i.previousSibling}return null}function x(t,n){if(!n||!t||1!==t.nodeType)return!1;if(e.isString(n)){try{return l.call(t,n.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(t){}return o.match(t,n)}return e.isArrayLike(n)?e.inArray(t,n)>-1:e.isPlainObject(n)?o.check(t,n):t===n}function _(t,e,n){for(var r=t.nextSibling;r;){if(1==r.nodeType){if(!e||x(r,e))return r;if(n)break}r=r.nextSibling}return null}function w(t,e){for(var n=t.nextSibling,r=[];n;)1==n.nodeType&&(e&&!x(n,e)||r.push(n)),n=n.nextSibling;return r}function N(t,e){var n=t.parentNode;return!n||e&&!x(n,e)?null:n}function A(t,e,n){for(var r=t.previousSibling;r;){if(1==r.nodeType){if(!e||x(r,e))return r;if(n)break}r=r.previousSibling}return null}function S(t,e){for(var n=t.previousSibling,r=[];n;)1==n.nodeType&&(e&&!x(n,e)||r.push(n)),n=n.previousSibling;return r}function E(t,e){for(var n=t.parentNode.firstChild,r=[];n;)1==n.nodeType&&n!==t&&(e&&!x(n,e)||r.push(n)),n=n.nextSibling;return r}o.divide=function(t){var e,n,r,i,o,a="",s=[];if((n=t.id)&&(a+="#"+n),r=t.classes)for(var l=r.length;l--;)a+="."+r[l].value;if(i=t.attributes)for(var l=0;l<i.length;l++)i[l].operator?a+="["+i[l].key+i[l].operator+JSON.stringify(i[l].value)+"]":a+="["+i[l].key+"]";if(o=t.pseudos)for(l=o.length;l--;)part=o[l],this.pseudos[part.key]?s.push(part):void 0!==part.value&&(a+=":"+part.key+"("+JSON.stringify(part));return(e=t.tag)&&"*"!==e&&(a=e.toUpperCase()+a),a||(a="*"),{nativeSelector:a,customPseudos:s}},o.check=function(t,e,n,r,i){var o,a,s,u,c,d,f,h,p;if(!i){if(o=e.tag){var g=t.nodeName.toUpperCase();if("*"==o){if(g<"@")return!1}else if(g!=(o||"").toUpperCase())return!1}if((a=e.id)&&t.getAttribute("id")!=a)return!1;if(s=e.classes)for(d=s.length;d--;)if(!(h=t.getAttribute("class"))||!s[d].regexp.test(h))return!1;if(u=e.attributes)for(d=u.length;d--;)if((f=u[d]).operator?!f.test(t.getAttribute(f.key)):!t.hasAttribute(f.key))return!1}if(c=e.pseudos)for(d=c.length;d--;)if(f=c[d],p=this.pseudos[f.key]){if((i&&p.isArrayFilter||!i&&!p.isArrayFilter)&&!p(t,n,r,f.value))return!1}else if(!i&&!l.call(t,f.key))return!1;return!0},o.match=function(t,n){var r;if(!(r=e.isString(n)?o.Slick.parse(n):n))return!0;var i,a,s=r.expressions,l=0;for(i=0;a=s[i];i++)if(1==a.length){var u=a[0];if(this.check(t,u))return!0;l++}if(l==r.length)return!1;var c,d=this.query(document,r);for(i=0;c=d[i++];)if(c===t)return!0;return!1},o.filterSingle=function(t,e){var n=a.call(t,function(n,r){return o.check(n,e,r,t,!1)});return n=a.call(n,function(t,r){return o.check(t,e,r,n,!0)})},o.filter=function(t,n){if(!e.isString(n))return o.filterSingle(t,n);var r,i,a=o.Slick.parse(n).expressions,s=[];for(r=0;i=a[r];r++){if(1!=i.length)throw new Error("not supported selector:"+n);var l=i[0],u=o.filterSingle(t,l);s=e.uniq(s.concat(u))}return s},o.combine=function(t,e){var n,r=e.combinator,i=e,l=[];switch(r){case">":l=g(t,i);break;case"+":(n=_(t,i,!0))&&l.push(n);break;case"^":(n=v(t,i,!0))&&l.push(n);break;case"~":l=w(t,i);break;case"++":var u=A(t,i,!0),c=_(t,i,!0);u&&l.push(u),c&&l.push(c);break;case"~~":l=E(t,i);break;case"!":l=p(t,i);break;case"!>":(n=N(t,i))&&l.push(n);break;case"!+":l=A(t,i,!0);break;case"!^":(n=k(t,i,!0))&&l.push(n);break;case"!~":l=S(t,i);break;default:var d=this.divide(e);if(l=s.call(t.querySelectorAll(d.nativeSelector)),d.customPseudos)for(var f=d.customPseudos.length-1;f>=0;f--)l=a.call(l,function(t,e){return o.check(t,{pseudos:[d.customPseudos[f]]},e,l,!1)}),l=a.call(l,function(t,e){return o.check(t,{pseudos:[d.customPseudos[f]]},e,l,!0)})}return l},o.query=function(t,n,r){for(var i,a,s=this.Slick.parse(n),l=[],u=s.expressions,c=0;i=u[c];c++){for(var d,f=[t],h=0;a=i[h];h++)(d=e.map(f,function(t,e){return o.combine(t,a)}))&&(f=d);d&&(l=l.concat(d))}return l};var C=function(){return C};return e.mixin(C,{ancestor:function(t,n,r){var i=r&&e.isString(r);for(;t=t.parentNode;){if(x(t,n))return t;if(r)if(i){if(x(t,r))break}else if(t==r)break}return null},ancestors:p,byId:function(t,e){return(e=e||r.doc()).getElementById(t)},children:g,closest:function(t,e){for(;t&&!x(t,e);)t=t.parentNode;return t},descendant:m,descendants:y,find:b,findAll:function(t,e){e||(e=t,t=document.body);return y(t,e)},firstChild:v,lastChild:k,matches:x,nextSibling:_,nextSiblings:w,parent:N,previousSibling:A,previousSiblings:S,pseudos:o.pseudos,siblings:E}),t.attach("domx.finder",C)}),t("skylark-domx-finder/main",["./finder"],function(t){return t}),t("skylark-domx-finder",["skylark-domx-finder/main"],function(t){return t}),t("skylark-domx-data/data",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-finder","skylark-domx-noder"],function(t,e,n,r){var i=Array.prototype.map,o=(Array.prototype.filter,e.camelCase),a=e.deserializeValue,s=/([A-Z])/g,l={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};var u={option:{get:function(t){var e=t.getAttribute("value");return null!=e?e:(g(t).match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")}},select:{get:function(t){var e,n,i,o=t.options,a=t.selectedIndex,s="select-one"===t.type,l=s?null:[],u=s?a+1:o.length;for(i=a<0?u:s?a:0;i<u;i++)if((n=o[i]).selected&&!n.disabled&&(!n.parentNode.disabled||!r.nodeName(n.parentNode,"optgroup"))){if(e=y(n),s)return e;l.push(e)}return l},set:function(t,n){for(var r,i,o=t.options,a=e.makeArray(n),s=o.length;s--;)((i=o[s]).selected=e.inArray(u.option.get(i),a)>-1)&&(r=!0);return r||(t.selectedIndex=-1),a}}};function c(t,e,n){if(void 0===n){if("object"==typeof e){for(var r in e)c(t,r,e[r]);return this}return t.getAttribute?t.getAttribute(e):t[e]}return t.setAttribute?t.setAttribute(e,n):t[e]=n,this}function d(t,n){var r=t._$_store;return!r&&n&&(r=t._$_store=function(t){var n={};return e.each(t.attributes||[],function(t,e){0==e.name.indexOf("data-")&&(n[o(e.name.replace("data-",""))]=a(e.value))}),n}(t)),r}function f(t,e,n){var r=d(t,!0);r[o(e)]=n}function h(t,e,n){if(void 0===n){if("object"==typeof e){for(var r in e)f(t,r,e[r]);return this}return function(t,e){if(void 0===e)return d(t,!0);var n=d(t);if(n){if(e in n)return n[e];var r=o(e);if(r in n)return n[r]}var i="data-"+e.replace(s,"-$1").toLowerCase();return c(t,i)}(t,e)}return f(t,e,n),this}function p(t){t._$_store&&delete t._$_store}function g(t,e){return void 0===e?t.textContent:(t.textContent=null==e?"":""+e,this)}function y(t,n){var r=u[t.type]||u[t.nodeName.toLowerCase()];if(void 0===n)return r&&"get"in r&&void 0!==(ret=r.get(t,"value"))?ret:(ret=t.value,"string"==typeof ret?ret.replace(/\r/g,""):null==ret?"":ret);null==n?n="":"number"==typeof n?n+="":e.isArray(n)&&(n=e.map(n,function(t){return null==t?"":t+""})),r&&"set"in r&&void 0!==r.set(t,n,"value")||(t.value=n)}function m(){return m}return e.each(["radio","checkbox"],function(){u[this]={set:function(t,n){if(e.isArray(n))return t.checked=e.inArray(y(t),n)>-1}}}),n.pseudos.data=function(t,e,n,r){return!!h(t,r||n[3])},e.mixin(m,{aria:function(t,e,n){return this.attr(t,"aria-"+e,n)},attr:c,cleanData:p,data:h,pluck:function(t,e){return i.call(t,function(t){return t[e]})},prop:function(t,e,n){return e=l[e]||e,void 0===n?t[e]:(t[e]=n,this)},removeAttr:function(t,e){return e.split(" ").forEach(function(e){!function(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}(t,e)}),this},removeData:function(t,n){if(n){e.isString(n)&&(n=n.split(/\s+/));var r=d(t,!0);n.forEach(function(t){delete r[t]})}else p(t);return this},removeProp:function(t,e){return e.split(" ").forEach(function(e){delete t[e]}),this},text:g,val:y,valHooks:u}),t.attach("domx.data",m)}),t("skylark-domx-query/query",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder"],function(t,e,n,r){var i,o=Array.prototype.some,a=Array.prototype.push,s=(Array.prototype.every,Array.prototype.concat,Array.prototype.slice),l=(Array.prototype.map,Array.prototype.filter),u=Array.prototype.forEach,c=Array.prototype.indexOf,d=Array.prototype.sort,f=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,h=e.funcArg,p=e.isArrayLike,g=e.isString,y=e.uniq,m=e.isFunction,b=e.type,v=(e.isArray,e.isWindow,e.isDocument,e.isObject);e.isPlainObject,e.compact,e.flatten,e.camelCase,e.dasherize,r.children;function k(t,r,i){return function(i){var o,a=e.map(arguments,function(t){return"function"==(o=b(t))||"object"==o||"array"==o||null==t?t:n.createFragment(t)});return a.length<1?this:(this.each(function(e){t.apply(r,[this,a,e>0])}),this)}}function x(t,n){return function(){var r=s.call(arguments),i=e.map(this,function(e,i){return t.apply(n,[e].concat(r))});return C(y(i))}}function _(t,e,n){return function(r){s.call(arguments);var i=this.map(function(i,o){return o.querySelector?t.apply(e,n?[o]:[o,r]):[]});return n&&r?i.filter(r):i}}function w(t,e,n){return function(r,i){s.call(arguments);var o=this.map(function(o,a){return t.apply(e,n?[a,r]:[a,i,r])});return n&&i?o.filter(i):o}}function N(t,e){return function(){var n=s.call(arguments);return this.each(function(r,i){t.apply(e,[this].concat(n))}),this}}function A(t,n,r){return function(i){return e.isDefined(i)?(u.call(this,function(e,o){var a;a=r?h(e,i,o,r(e)):i,t.apply(n,[e,a])}),this):this[0]?t.apply(n,[this[0]]):void 0}}var S,E=e.klass({klassName:"SkNodeList",init:function(t,i){var o,s,l,u;if(t&&(this.context=i=i||n.doc(),g(t)?(this.selector=t,(o="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:f.exec(t))?o[1]?(s=n.createFragment(t),e.isPlainObject(i)&&(u=i)):(l=r.byId(o[2],n.ownerDoc(i)))&&(s=[l]):(e.isString(i)&&(i=r.find(i)),s=r.descendants(i,t))):s=t!==window&&p(t)?t:[t]),s&&(a.apply(this,s),u))for(var c in u)e.isFunction(this[c])?this[c](u[c]):this.attr(c,u[c]);return this}}),C=function(){i=function(t){return t instanceof E},init=function(t,e){return new E(t,e)};var t=function(e,n){return m(e)?(t.ready(function(){e(t)}),f):i(e)?e:n&&i(n)&&g(e)?n.find(e):init(e,n)},f=t(document);t.fn=E.prototype,e.mixin(t.fn,{length:0,map:function(n){return t(y(e.map(this,function(t,e){return n.call(t,e,t)})))},slice:function(){return t(s.apply(this,arguments))},forEach:function(){return u.apply(this,arguments)},get:function(t){return void 0===t?s.call(this):this[t>=0?t:t+this.length]},indexOf:function(){return c.apply(this,arguments)},sort:function(){return d.apply(this,arguments)},toArray:function(){return s.call(this)},size:function(){return this.length},remove:function(t){return t?this.find(t).remove():(this.each(function(t,e){n.remove(e)}),this)},each:function(t){return e.each(this,t),this},filter:function(e){return m(e)?this.not(this.not(e)):t(l.call(this,function(t){return r.matches(t,e)}))},add:function(e,n){return t(y(this.toArray().concat(t(e,n).toArray())))},is:function(t){if(this.length>0){if(e.isString(t))return o.call(this,function(e){return r.matches(e,t)});if(e.isArrayLike(t))return o.call(this,function(n){return e.inArray(n,t)>-1});if(e.isHtmlNode(t))return o.call(this,function(e){return e==t})}return!1},not:function(e){var n=[];if(m(e)&&void 0!==e.call)this.each(function(t,r){e.call(this,t,r)||n.push(this)});else{var r="string"==typeof e?this.filter(e):p(e)&&m(e.item)?s.call(e):t(e);this.forEach(function(t){r.indexOf(t)<0&&n.push(t)})}return t(n)},has:function(e){return this.filter(function(){return v(e)?n.contains(this,e):t(this).find(e).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:_(r.descendants,r),closest:_(r.closest,r),parents:_(r.ancestors,r),parentsUntil:w(r.ancestors,r),parent:_(r.parent,r),children:_(r.children,r),contents:x(n.contents,n),empty:N(n.empty,n),html:A(n.html,n),pluck:function(t){return e.map(this,function(e){return e[t]})},pushStack:function(e){var n=t(e);return n.prevObject=this,n},replaceWith:function(t){return this.before(t).remove()},wrap:function(e){var n="function"==typeof e;return this.each(function(r){t(this).wrapAll(n?e.call(this,r):e)})},wrapAll:function(e){var n;return this[0]&&("function"==typeof e&&(e=e.call(this[0])),n=t(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&n.insertBefore(this[0]),n.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(e){return"function"==typeof e?this.each(function(n){t(this).wrapInner(e.call(this,n))}):this.each(function(){var n=t(this),r=n.contents();r.length?r.wrapAll(e):n.append(e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){t(this).replaceWith(this.childNodes)}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},toggle:function(e){return this.each(function(){var n=t(this);(void 0===e?"none"==n.css("display"):e)?n.show():n.hide()})},prev:function(e){return t(this.pluck("previousElementSibling")).filter(e||"*")},prevAll:_(r.previousSiblings,r),next:function(e){return t(this.pluck("nextElementSibling")).filter(e||"*")},nextAll:_(r.nextSiblings,r),siblings:_(r.siblings,r),index:function(e){return e?this.indexOf(t(e)[0]):this.parent().children().indexOf(this[0])}}),t.fn.detach=t.fn.remove,t.fn.hover=function(t,e){return this.mouseenter(t).mouseleave(e||t)};n.traverse;return t.fn.after=k(n.after,n),t.fn.prepend=k(n.prepend,n),t.fn.before=k(n.before,n),t.fn.append=k(n.append,n),e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,n){t.fn[e]=function(e){for(var r,i=[],o=t(e),s=o.length-1,l=0;l<=s;l++)r=l===s?this:this.clone(!0),t(o[l])[n](r),a.apply(i,r.get());return this.pushStack(i)}}),t}();return(S=C).fn.scrollParent=function(t){var e=this.css("position"),n="absolute"===e,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,i=this.parents().filter(function(){var t=S(this);return(!n||"static"!==t.css("position"))&&r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&i.length?i:S(this[0].ownerDocument||document)},function(t){t.fn.end=function(){return this.prevObject||t()},t.fn.andSelf=function(){return this.add(this.prevObject||t())},t.fn.addBack=function(t){return this.prevObject?t?this.add(this.prevObject.filter(t)):this.add(this.prevObject):this},"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings,prev,prevAll,next,nextAll".split(",").forEach(function(e){var n=t.fn[e];t.fn[e]=function(){var t=n.apply(this,arguments);return t.prevObject=this,t}})}(C),function(t){var o;t.fn.query=t.fn.find,t.fn.place=function(t,o){return e.isString(t)?t=r.descendant(t):i(t)&&(t=t[0]),this.each(function(e,r){switch(o){case"before":n.before(t,r);break;case"after":n.after(t,r);break;case"replace":n.replace(t,r);break;case"only":n.empty(t),n.append(t,r);break;case"first":n.prepend(t,r);break;default:n.append(t,r)}})},t.fn.addContent=function(t,n){return t.template&&(t=e.substitute(t.template,t)),this.append(t)},t.fn.disableSelection=(o="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(o+".ui-disableSelection",function(t){t.preventDefault()})}),t.fn.enableSelection=function(){return this.off(".ui-disableSelection")},t.fn.reflow=function(){return n.flow(this[0])},t.fn.isBlockNode=function(){return n.isBlockNode(this[0])}}(C),C.fn.plugin=function(t,e){var n=s.call(arguments,1),r=this,i=this;return this.each(function(){i=plugins.instantiate.apply(r,[this,t].concat(n))}),i},C.wraps={wrapper_node_operation:k,wrapper_map:x,wrapper_value:A,wrapper_selector:_,wrapper_some_chk:function(t,e){return function(){var n=s.call(arguments);return o.call(this,function(r){return t.apply(e,[r].concat(n))})}},wrapper_selector_until:w,wrapper_every_act_firstArgFunc:function(t,e,n){return function(r){var i=s.call(arguments);return u.call(this,function(o,a){var s=h(o,r,a,n(o));t.apply(e,[o,s].concat(i.slice(1)))}),this}},wrapper_every_act:N,wrapper_name_value:function(t,n,r){return function(i,o){return e.isPlainObject(i)||e.isDefined(o)?(u.call(this,function(e,a){var s;s=r?h(e,o,a,r(e,i)):o,t.apply(n,[e,i,s])}),this):this[0]?t.apply(n,[this[0],i]):void 0}}},t.attach("domx.query",C)}),t("skylark-domx-query/main",["./query"],function(t){return t}),t("skylark-domx-query",["skylark-domx-query/main"],function(t){return t}),t("skylark-domx-velm/velm",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder","skylark-domx-query"],function(t,e,n,r,i){var o=Array.prototype.map,a=Array.prototype.slice,s=e.klass({klassName:"VisualElement",_construct:function(t){e.isString(t)&&(t="<"===t.charAt(0)?n.createFragment(t)[0]:document.getElementById(t)),this._elm=t}});s.prototype.$=s.prototype.query=function(t){return i(t,this._elm)},s.prototype.elm=function(){return this._elm};var l=new s(document.body),u=function(t){return t?new s(t):l};return e.mixin(u,{batch:function(t,e,n){return t.forEach(function(t){var r=t instanceof s?t:u(t);r[e].apply(r,n)}),this},root:new s(document.body),VisualElement:s,partial:function(t,e){var n={};n[t]=e,s.partial(n)},delegate:function(t,n){var r={};t.forEach(function(t){r[t]=function(t,n){return function(){var r=this._elm,i=t.apply(n,[r].concat(a.call(arguments)));if(i){if(i===n)return this;i instanceof HTMLElement?i=new s(i):e.isArrayLike(i)&&(i=o.call(i,function(t){return t instanceof HTMLElement?new s(t):t}))}return i}}(n[t],n)}),s.partial(r)}}),u.delegate(["ancestor","ancestors","children","descendant","find","findAll","firstChild","lastChild","matches","nextSibling","nextSiblings","parent","previousSibling","previousSiblings","siblings"],r),u.find=function(t){return"body"===t?this.root:this.root.descendant(t)},u.delegate(["after","append","before","clone","contains","contents","empty","html","isChildOf","isDocument","isInDocument","isWindow","ownerDoc","prepend","remove","removeChild","replace","reverse","throb","traverse","wrapper","wrapperInner","unwrap"],n),t.attach("domx.velm",u)}),t("skylark-domx-velm/main",["./velm"],function(t){return t}),t("skylark-domx-velm",["skylark-domx-velm/main"],function(t){return t}),t("skylark-domx-data/main",["./data","skylark-domx-velm","skylark-domx-query"],function(t,e,n){return e.delegate(["attr","data","prop","removeAttr","removeData","text","val"],t),n.fn.text=n.wraps.wrapper_value(t.text,t,t.text),n.fn.attr=n.wraps.wrapper_name_value(t.attr,t,t.attr),n.fn.removeAttr=n.wraps.wrapper_every_act(t.removeAttr,t),n.fn.prop=n.wraps.wrapper_name_value(t.prop,t,t.prop),n.fn.removeProp=n.wraps.wrapper_every_act(t.removeProp,t),n.fn.data=n.wraps.wrapper_name_value(t.data,t),n.fn.removeData=n.wraps.wrapper_every_act(t.removeData),n.fn.val=n.wraps.wrapper_value(t.val,t,t.val),t}),t("skylark-domx-data",["skylark-domx-data/main"],function(t){return t}),t("skylark-domx-contents/contents",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-data"],function(t,e,n,r){"use strict";var i=function(){return i};return t.attach("domx.contents",i)}),t("skylark-domx-contents/Hotkeys",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r=t.Evented.inherit({});return r.count=0,r.keyNameMap={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",91:"Meta",93:"Meta",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"Multiply",107:"Add",109:"Subtract",110:"Decimal",111:"Divide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",59:";",61:"=",186:";",187:"=",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r.aliases={escape:"esc",delete:"del",return:"enter",ctrl:"control",space:"spacebar",ins:"insert",cmd:"meta",command:"meta",wins:"meta",windows:"meta"},r.normalize=function(t){var e,n,r,i,o,a;for(o=t.toLowerCase().replace(/\s+/gi,"").split("+"),e=n=0,a=o.length;n<a;e=++n)r=o[e],o[e]=this.aliases[r]||r;return i=o.pop(),o.sort().push(i),o.join("_")},r.prototype.opts={el:document},r.prototype.init=function(){var t;this.id=++this.constructor.count,this._map={},this._delegate="string"==typeof this.opts.el?document:this.opts.el,e(this._delegate).on("keydown.simple-hotkeys-"+this.id,this.opts.el,(t=this,function(e){var n;return null!=(n=t._getHander(e))?n.call(t,e):void 0}))},r.prototype._getHander=function(t){var e,n;if(e=this.constructor.keyNameMap[t.which])return n="",t.altKey&&(n+="alt_"),t.ctrlKey&&(n+="control_"),t.metaKey&&(n+="meta_"),t.shiftKey&&(n+="shift_"),n+=e.toLowerCase(),this._map[n]},r.prototype.respondTo=function(t){return"string"==typeof t?null!=this._map[this.constructor.normalize(t)]:null!=this._getHander(t)},r.prototype.add=function(t,e){return this._map[this.constructor.normalize(t)]=e,this},r.prototype.remove=function(t){return delete this._map[this.constructor.normalize(t)],this},r.prototype.destroy=function(){return e(this._delegate).off(".simple-hotkeys-"+this.id),this._map={},this},n.Hotkeys=r}),t("skylark-domx-contents/Util",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r,i,o,a,s,l,u,c,d,f,h,p,g=t.Evented.inherit({init:function(e,n){if(this.editor=e,this.opts=t.extend({},this.opts,n),this.browser.msie&&this.browser.version<11)return this.phBr=""}});return g.pluginName="Util",g.prototype.phBr="<br/>",g.prototype.os=(r={},/Mac/.test(navigator.appVersion)?r.mac=!0:/Linux/.test(navigator.appVersion)?r.linux=!0:/Win/.test(navigator.appVersion)?r.win=!0:/X11/.test(navigator.appVersion)&&(r.unix=!0),/Mobi/.test(navigator.appVersion)&&(r.mobile=!0),r),g.prototype.browser=(p=navigator.userAgent,s=/(msie|trident)/i.test(p),i=/chrome|crios/i.test(p),h=/safari/i.test(p)&&!i,a=/firefox/i.test(p),o=/edge/i.test(p),s?{msie:!0,version:1*(null!=(l=p.match(/(msie |rv:)(\d+(\.\d+)?)/i))?l[2]:void 0)}:o?{edge:!0,webkit:!0,version:1*(null!=(u=p.match(/edge\/(\d+(\.\d+)?)/i))?u[1]:void 0)}:i?{webkit:!0,chrome:!0,version:1*(null!=(c=p.match(/(?:chrome|crios)\/(\d+(\.\d+)?)/i))?c[1]:void 0)}:h?{webkit:!0,safari:!0,version:1*(null!=(d=p.match(/version\/(\d+(\.\d+)?)/i))?d[1]:void 0)}:a?{mozilla:!0,firefox:!0,version:1*(null!=(f=p.match(/firefox\/(\d+(\.\d+)?)/i))?f[1]:void 0)}:{}),g.prototype.support={onselectionchange:function(){var t;if(void 0!==(t=document.onselectionchange))try{return document.onselectionchange=0,null===document.onselectionchange}catch(t){}finally{document.onselectionchange=t}return!1}(),oninput:!/(msie|trident)/i.test(navigator.userAgent)},g.prototype.reflow=function(t){return null==t&&(t=document),e(t)[0].offsetHeight},g.prototype.metaKey=function(t){return/Mac/.test(navigator.userAgent)?t.metaKey:t.ctrlKey},g.prototype.isEmptyNode=function(t){var n;return(n=e(t)).is(":empty")||!n.text()&&!n.find(":not(br, span, div)").length},g.prototype.isDecoratedNode=function(t){return e(t).is('[class^="'+this.opts.classPrefix+'"]')},g.prototype.blockNodes=["div","p","ul","ol","li","blockquote","hr","pre","h1","h2","h3","h4","h5","table"],g.prototype.isBlockNode=function(t){return!(!(t=e(t)[0])||3===t.nodeType)&&new RegExp("^("+this.blockNodes.join("|")+")$").test(t.nodeName.toLowerCase())},g.prototype.getNodeLength=function(t){switch((t=e(t)[0]).nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}},g.prototype.dataURLtoBlob=function(t){var e,n,r,i,o,a,s,l,u,c,d;if(a=window.Blob&&function(){try{return Boolean(new Blob)}catch(t){return t,!1}}(),o=a&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return t,!1}}(),e=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,!((a||e)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return!1;for(i=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),n=new ArrayBuffer(i.length),l=new Uint8Array(n),s=u=0,d=i.length;0<=d?u<=d:u>=d;s=0<=d?++u:--u)l[s]=i.charCodeAt(s);return c=t.split(",")[0].split(":")[1].split(";")[0],a?new Blob([o?l:n],{type:c}):((r=new e).append(n),r.getBlob(c))},g.prototype.throttle=function(t,e){var n,r,i,o,a,s,l;return o=0,l=0,i=n=a=null,r=function(){return l=0,o=+new Date,a=t.apply(i,n),i=null,n=null},(s=function(){var t;return i=this,n=arguments,t=new Date-o,l||(t>=e?r():l=setTimeout(r,e-t)),a}).clear=function(){if(l)return clearTimeout(l),r()},s},g.prototype.formatHTML=function(e){var n,r,i,o,a,s,l,u;for(a=/<(\/?)(.+?)(\/?)>/g,l="",i=0,r=null,"  ",s=function(t,e){return new Array(e+1).join(t)};null!==(o=a.exec(e));)o.isBlockNode=t.inArray(o[2],this.blockNodes)>-1,o.isStartTag="/"!==o[1]&&"/"!==o[3],o.isEndTag="/"===o[1]||"/"===o[3],n=r?r.index+r[0].length:0,(u=e.substring(n,o.index)).length>0&&t.trim(u)&&(l+=u),o.isBlockNode&&o.isEndTag&&!o.isStartTag&&(i-=1),o.isBlockNode&&o.isStartTag&&(r&&r.isBlockNode&&r.isEndTag||(l+="\n"),l+=s("  ",i)),l+=o[0],o.isBlockNode&&o.isEndTag&&(l+="\n"),o.isBlockNode&&o.isStartTag&&(i+=1),r=o;return t.trim(l)},n.Util=g}),t("skylark-domx-contents/InputManager",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r=[].indexOf,i=t.Evented.inherit({init:function(n,r){var i,o,a;this.editable=n,this.opts=t.extend({},this.opts,r),this.throttledValueChanged=this.editable.util.throttle((a=this,function(t){return setTimeout(function(){return a.editable.trigger("valuechanged",t)},10)}),300),this.throttledSelectionChanged=this.editable.util.throttle(function(t){return function(){return t.editable.trigger("selectionchanged")}}(this),50),e(document).on("selectionchange.simditor"+this.editable.id,function(t){return function(e){var n;if(t.focused&&!t.editable.clipboard.pasting)return(n=function(){return t._selectionTimer&&(clearTimeout(t._selectionTimer),t._selectionTimer=null),t.editable.selection._selection.rangeCount>0?t.throttledSelectionChanged():t._selectionTimer=setTimeout(function(){if(t._selectionTimer=null,t.focused)return n()},10)})()}}(this)),this.editable.on("valuechanged",function(t){return function(){var n;if(t.lastCaretPosition=null,n=t.editable.body.children().filter(function(e,n){return t.editable.util.isBlockNode(n)}),t.focused&&0===n.length&&(t.editable.selection.save(),t.editable.formatter.format(),t.editable.selection.restore()),t.editable.body.find("hr, pre, ."+t.opts.classPrefix+"table").each(function(n,r){var i,o;if(((i=e(r)).parent().is("blockquote")||i.parent()[0]===t.editable.body[0])&&(o=!1,0===i.next().length&&(e("<p/>").append(t.editable.util.phBr).insertAfter(i),o=!0),0===i.prev().length&&(e("<p/>").append(t.editable.util.phBr).insertBefore(i),o=!0),o))return t.throttledValueChanged()}),t.editable.body.find("pre:empty").append(t.editable.util.phBr),!t.editable.util.support.onselectionchange&&t.focused)return t.throttledSelectionChanged()}}(this)),this.editable.body.on("keydown",t.proxy(this._onKeyDown,this)).on("keypress",t.proxy(this._onKeyPress,this)).on("keyup",t.proxy(this._onKeyUp,this)).on("mouseup",t.proxy(this._onMouseUp,this)).on("focus",t.proxy(this._onFocus,this)).on("blur",t.proxy(this._onBlur,this)).on("drop",t.proxy(this._onDrop,this)).on("input",t.proxy(this._onInput,this)),this.editable.util.browser.firefox&&(this.editable.hotkeys.add("cmd+left",function(t){return function(e){return e.preventDefault(),t.editable.selection._selection.modify("move","backward","lineboundary"),!1}}(this)),this.editable.hotkeys.add("cmd+right",function(t){return function(e){return e.preventDefault(),t.editable.selection._selection.modify("move","forward","lineboundary"),!1}}(this)),i=this.editable.util.os.mac?"cmd+a":"ctrl+a",this.editable.hotkeys.add(i,function(t){return function(e){var n,r,i,o;if((n=t.editable.body.children()).length>0)return r=n.first().get(0),i=n.last().get(0),(o=document.createRange()).setStart(r,0),o.setEnd(i,t.editable.util.getNodeLength(i)),t.editable.selection.range(o),!1}}(this))),o=this.editable.util.os.mac?"cmd+enter":"ctrl+enter",this.editable.hotkeys.add(o,function(t){return function(e){return t.editable.$el.closest("form").find("button:submit").click(),!1}}(this))}});return i.pluginName="InputManager",i.prototype._modifierKeys=[16,17,18,91,93,224],i.prototype._arrowKeys=[37,38,39,40],i.prototype._onFocus=function(t){var e;if(!this.editable.clipboard.pasting)return this.editable.$el.addClass("focus").removeClass("error"),this.focused=!0,setTimeout((e=this,function(){var t,n;if((n=e.editable.selection._selection.getRangeAt(0)).startContainer===e.editable.body[0]&&(e.lastCaretPosition?e.editable.undoManager.caretPosition(e.lastCaretPosition):(t=e.editable.body.children().first(),n=document.createRange(),e.editable.selection.setRangeAtStartOf(t,n),console.log("aaaaaa"))),e.lastCaretPosition=null,e.editable.trigger("focus"),!e.editable.util.support.onselectionchange)return e.throttledSelectionChanged()}),0)},i.prototype._onBlur=function(t){var e;if(!this.editable.clipboard.pasting)return this.editable.$el.removeClass("focus"),this.editable.sync(),this.focused=!1,this.lastCaretPosition=null!=(e=this.editable.undoManager.currentState())?e.caret:void 0,this.editable.trigger("blur")},i.prototype._onMouseUp=function(t){if(!this.editable.util.support.onselectionchange)return this.throttledSelectionChanged()},i.prototype._onKeyDown=function(t){var e,n;if(!1===this.editable.trigger(t))return!1;if(!this.editable.hotkeys.respondTo(t)){if(this.editable.keystroke.respondTo(t))return this.throttledValueChanged(),!1;if(!(e=t.which,r.call(this._modifierKeys,e)>=0||(n=t.which,r.call(this._arrowKeys,n)>=0)||this.editable.util.metaKey(t)&&86===t.which))return this.editable.util.support.oninput||this.throttledValueChanged(["typing"]),null}},i.prototype._onKeyPress=function(t){if(!1===this.editable.trigger(t))return!1},i.prototype._onKeyUp=function(t){var n,i;if(!1===this.editable.trigger(t))return!1;!this.editable.util.support.onselectionchange&&(i=t.which,r.call(this._arrowKeys,i)>=0)?this.throttledValueChanged():8!==t.which&&46!==t.which||!this.editable.util.isEmptyNode(this.editable.body)||(this.editable.body.empty(),n=e("<p/>").append(this.editable.util.phBr).appendTo(this.editable.body),this.editable.selection.setRangeAtStartOf(n))},i.prototype._onDrop=function(t){return!1!==this.editable.trigger(t)&&this.throttledValueChanged()},i.prototype._onInput=function(t){return this.throttledValueChanged(["oninput"])},n.InputManager=i}),t("skylark-domx-contents/Selection",["skylark-langx/langx","skylark-domx-noder","skylark-domx-query","./contents"],function(t,e,n,r){var i=t.Evented.inherit({_range:null,_startNodes:null,_endNodes:null,_containerNode:null,_nodes:null,_blockNodes:null,_rootNodes:null,init:function(e,n){var r=this;this.editable=e,this.opts=t.extend({},this.opts,n),this._selection=document.getSelection(),this.editable.on("selectionchanged",function(t){return console.log("selectionchanged"),r.reset(),r._range=r._selection.getRangeAt(0)}),this.editable.on("blur",function(t){return r.reset()}),this.editable.on("focus",function(t){return r.reset(),r._range=r._selection.getRangeAt(0)})},reset:function(){return this._range=null,this._startNodes=null,this._endNodes=null,this._containerNode=null,this._nodes=null,this._blockNodes=null,this._rootNodes=null},clear:function(){try{this._selection.removeAllRanges(),console.log("clear")}catch(t){t}return this.reset()},range:function(e){var n;return e?(this.clear(),this._selection.addRange(e),this._range=e,n=t.hoster.browser.mozilla||t.hoster.browser.msie,!this.editable.inputManager.focused&&n&&this.editable.body.focus()):!this._range&&this.editable.inputManager.focused&&this._selection.rangeCount&&(this._range=this._selection.getRangeAt(0)),this._range},startNodes:function(){var t;return this._range&&(this._startNodes||(this._startNodes=(t=this,function(){var e;return(e=n(t._range.startContainer).parentsUntil(t.editable.body).get()).unshift(t._range.startContainer),n(e)})())),this._startNodes},endNodes:function(){var t;return this._range&&(this._endNodes||(this._endNodes=this._range.collapsed?this.startNodes():((t=n(this._range.endContainer).parentsUntil(this.editable.body).get()).unshift(this._range.endContainer),n(t)))),this._endNodes},containerNode:function(){return this._range&&(this._containerNode||(this._containerNode=n(this._range.commonAncestorContainer))),this._containerNode},nodes:function(){var e;return this._range&&(this._nodes||(this._nodes=(e=this,function(){var r;return r=[],e.startNodes().first().is(e.endNodes().first())?r=e.startNodes().get():(e.startNodes().each(function(i,o){var a,s,l,u,c,d,f;return s=n(o),e.endNodes().index(s)>-1?r.push(o):s.parent().is(e.editable.body)||(d=e.endNodes().index(s.parent()))>-1?(a=d&&d>-1?e.endNodes().eq(d-1):e.endNodes().last(),l=s.parent().contents(),f=l.index(s),u=l.index(a),t.merge(r,l.slice(f,u).get())):(l=s.parent().contents(),c=l.index(s),t.merge(r,l.slice(c).get()))}),e.endNodes().each(function(i,o){var a,s,l;return(a=n(o)).parent().is(e.editable.body)||e.startNodes().index(a.parent())>-1?(r.push(o),!1):(s=a.parent().contents(),l=s.index(a),t.merge(r,s.slice(0,l+1)))})),n(t.uniq(r))})())),this._nodes},blockNodes:function(){var t;if(this._range)return this._blockNodes||(this._blockNodes=(t=this,function(){return t.nodes().filter(function(e,n){return t.editable.util.isBlockNode(n)})})()),this._blockNodes},rootNodes:function(){var t;if(this._range)return this._rootNodes||(this._rootNodes=(t=this,function(){return t.nodes().filter(function(e,r){var i;return(i=n(r).parent()).is(t.editable.body)||i.is("blockquote")})})()),this._rootNodes},rangeAtEndOf:function(t,r){var i,o,a,s,l,u;if(null==r&&(r=this.range()),r&&r.collapsed)return t=n(t)[0],a=r.endContainer,s=this.editable.util.getNodeLength(a),o=r.endOffset===s-1,l=n(a).contents().last().is("br"),i=r.endOffset===s,!!(o&&l||i)&&(t===a||!!e.contains(t,a)&&(u=!0,n(a).parentsUntil(t).addBack().each(function(t,e){var r,i,o,a;if(a=n(e).parent().contents().filter(function(){return!(this!==e&&3===this.nodeType&&!this.nodeValue)}),r=a.last(),o=r.get(0)===e,i=r.is("br")&&r.prev().get(0)===e,!o&&!i)return u=!1,!1}),u))},rangeAtStartOf:function(t,r){var i,o;if(null==r&&(r=this.range()),r&&r.collapsed)return t=n(t)[0],o=r.startContainer,0===r.startOffset&&(t===o||!!e.contains(t,o)&&(i=!0,n(o).parentsUntil(t).addBack().each(function(t,e){if(n(e).parent().contents().filter(function(){return!(this!==e&&3===this.nodeType&&!this.nodeValue)}).first().get(0)!==e)return i=!1}),i))},insertNode:function(t,e){if(null==e&&(e=this.range()),e)return t=n(t)[0],e.insertNode(t),this.setRangeAfter(t,e)},setRangeAfter:function(t,e){if(null==e&&(e=this.range()),null!=e)return t=n(t)[0],e.setEndAfter(t),e.collapse(!1),this.range(e)},setRangeBefore:function(t,e){if(null==e&&(e=this.range()),null!=e)return t=n(t)[0],e.setEndBefore(t),e.collapse(!1),this.range(e)},setRangeAtStartOf:function(t,e){return null==e&&(e=this.range()),t=n(t).get(0),e.setEnd(t,0),e.collapse(!1),this.range(e)},setRangeAtEndOf:function(t,e){var r,i,o,a,s,l,u;if(null==e&&(e=this.range()),i=n(t),t=i[0])return i.is("pre")?(o=i.contents()).length>0?(a=o.last(),l=a.text(),s=this.editable.util.getNodeLength(a[0]),"\n"===l.charAt(l.length-1)?e.setEnd(a[0],s-1):e.setEnd(a[0],s)):e.setEnd(t,0):(u=this.editable.util.getNodeLength(t),3!==t.nodeType&&u>0&&((r=n(t).contents().last()).is("br")?u-=1:3!==r[0].nodeType&&this.editable.util.isEmptyNode(r)&&(r.append(this.editable.util.phBr),t=r[0],u=0)),e.setEnd(t,u)),e.collapse(!1),this.range(e)},deleteRangeContents:function(t){var e,n,r,i;return null==t&&(t=this.range()),i=t.cloneRange(),r=t.cloneRange(),i.collapse(!0),r.collapse(!1),n=this.rangeAtStartOf(this.editable.body,i),e=this.rangeAtEndOf(this.editable.body,r),!t.collapsed&&n&&e?(this.editable.body.empty(),t.setStart(this.editable.body[0],0),t.collapse(!0),this.range(t)):t.deleteContents(),t},breakBlockEl:function(t,e){var r;return null==e&&(e=this.range()),r=n(t),e.collapsed?(e.setStartBefore(r.get(0)),e.collapsed?r:r.before(e.extractContents())):r},save:function(t){var e,r,i;if(null==t&&(t=this.range()),!this._selectionSaved)return(r=t.cloneRange()).collapse(!1),i=n("<span/>").addClass(this.opts.classPrefix+"caret-start"),e=n("<span/>").addClass(this.opts.classPrefix+"caret-end"),r.insertNode(e[0]),t.insertNode(i[0]),this.clear(),this._selectionSaved=!0},restore:function(){var t,e,n,r,i,o,a;return!!this._selectionSaved&&(i=this.editable.body.find("."+this.opts.classPrefix+"caret-start"),t=this.editable.body.find("."+this.opts.classPrefix+"caret-end"),i.length&&t.length?(o=i.parent(),a=o.contents().index(i),e=t.parent(),n=e.contents().index(t),o[0]===e[0]&&(n-=1),(r=document.createRange()).setStart(o.get(0),a),r.setEnd(e.get(0),n),i.remove(),t.remove(),this.range(r)):(i.remove(),t.remove()),this._selectionSaved=!1,r)}});return i.pluginName="Selection",r.Selection=i}),t("skylark-domx-contents/UndoManager",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r=t.Evented.inherit({init:function(e,n){var r,i,o;this.editable=e,this.opts=t.extend({},this.opts,n),this._stack=[],this.editable.util.os.mac?(i="cmd+z",r="shift+cmd+z"):this.editable.util.os.win?(i="ctrl+z",r="ctrl+y"):(i="ctrl+z",r="shift+ctrl+z"),this.editable.hotkeys.add(i,(o=this,function(t){return t.preventDefault(),o.undo(),!1})),this.editable.hotkeys.add(r,function(t){return function(e){return e.preventDefault(),t.redo(),!1}}(this)),this.throttledPushState=this.editable.util.throttle(function(t){return function(){return t._pushUndoState()}}(this),2e3),this.editable.on("valuechanged",function(t){return function(e,n){if("undo"!==n&&"redo"!==n)return t.throttledPushState()}}(this)),this.editable.on("selectionchanged",function(t){return function(e){return t.resetCaretPosition(),t.update()}}(this)),this.editable.on("focus",function(t){return function(e){if(0===t._stack.length)return t._pushUndoState()}}(this)),this.editable.on("blur",function(t){return function(e){return t.resetCaretPosition()}}(this))}});return r.pluginName="UndoManager",r.prototype._index=-1,r.prototype._capacity=20,r.prototype._startPosition=null,r.prototype._endPosition=null,r.prototype.resetCaretPosition=function(){return this._startPosition=null,this._endPosition=null},r.prototype.startPosition=function(){return this.editable.selection._range&&(this._startPosition||(this._startPosition=this._getPosition("start"))),this._startPosition},r.prototype.endPosition=function(){var t;return this.editable.selection._range&&(this._endPosition||(this._endPosition=(t=this,function(){return t.editable.selection.range().collapsed?t._startPosition:t._getPosition("end")})())),this._endPosition},r.prototype._pushUndoState=function(){if(!1!==this.editable.trigger("pushundostate")&&this.caretPosition().start)return this._index+=1,this._stack.length=this._index,this._stack.push({html:this.editable.body.html(),caret:this.caretPosition()}),this._stack.length>this._capacity?(this._stack.shift(),this._index-=1):void 0},r.prototype.currentState=function(){return this._stack.length&&this._index>-1?this._stack[this._index]:null},r.prototype.undo=function(){var t;if(!(this._index<1||this._stack.length<2))return this._index-=1,t=this._stack[this._index],this.editable.body.get(0).innerHTML=t.html,this.caretPosition(t.caret),this.editable.body.find(".selected").removeClass("selected"),this.editable.sync(),this.editable.trigger("valuechanged",["undo"])},r.prototype.redo=function(){var t;if(!(this._index<0||this._stack.length<this._index+2))return this._index+=1,t=this._stack[this._index],this.editable.body.get(0).innerHTML=t.html,this.caretPosition(t.caret),this.editable.body.find(".selected").removeClass("selected"),this.editable.sync(),this.editable.trigger("valuechanged",["redo"])},r.prototype.update=function(){var t;if(t=this.currentState())return t.html=this.editable.body.html(),t.caret=this.caretPosition()},r.prototype._getNodeOffset=function(n,r){var i,o,a;return i=t.isNumber(r)?e(n):e(n).parent(),a=0,o=!1,i.contents().each(function(t,e){return n!==e&&(r!==t||0!==t)&&(e.nodeType===Node.TEXT_NODE?!o&&e.nodeValue.length>0&&(a+=1,o=!0):(a+=1,o=!1),r-1!==t&&null)}),a},r.prototype._getPosition=function(t){var n,r,i,o,a,s,l,u;if(null==t&&(t="start"),l=this.editable.selection.range(),o=l[t+"Offset"],n=this.editable.selection[t+"Nodes"](),(r=n.first()[0]).nodeType===Node.TEXT_NODE){for(s=r.previousSibling;s&&s.nodeType===Node.TEXT_NODE;)r=s,o+=this.editable.util.getNodeLength(s),s=s.previousSibling;(i=n.get())[0]=r,n=e(i)}else o=this._getNodeOffset(r,o);return a=[o],n.each((u=this,function(t,e){return a.unshift(u._getNodeOffset(e))})),a},r.prototype._getNodeByPosition=function(t){var n,r,i,o,a,s,l,u;for(s=this.editable.body[0],u=t.slice(0,t.length-1),i=o=0,a=u.length;o<a;i=++o){if(l=u[i],r=s.childNodes,l>r.length-1){if(i!==t.length-2||!e(s).is(":empty")){s=null;break}n=document.createTextNode(""),s.appendChild(n),r=s.childNodes}s=r[l]}return s},r.prototype.caretPosition=function(t){var e,n,r,i,o;if(t){if(!t.start)return;return i=this._getNodeByPosition(t.start),o=t.start[t.start.length-1],t.collapsed?(e=i,n=o):(e=this._getNodeByPosition(t.end),n=t.start[t.start.length-1]),i&&e?((r=document.createRange()).setStart(i,o),r.setEnd(e,n),this.editable.selection.range(r)):void("undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("simditor: invalid caret state"))}return r=this.editable.selection.range(),t=this.editable.inputManager.focused&&null!=r?{start:this.startPosition(),end:this.endPosition(),collapsed:r.collapsed}:{}},n.UndoManager=r}),t("skylark-domx-contents/Keystroke",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r=t.Evented.inherit({init:function(e,n){this.editable=e,this.opts=t.extend({},this.opts,n),this._keystrokeHandlers={},this._initKeystrokeHandlers()}});return r.pluginName="Keystroke",r.prototype.add=function(t,e,n){return t=t.toLowerCase(),t=this.editable.hotkeys.constructor.aliases[t]||t,this._keystrokeHandlers[t]||(this._keystrokeHandlers[t]={}),this._keystrokeHandlers[t][e]=n},r.prototype.respondTo=function(t){var n,r,i,o,a;if(r=null!=(i=this.editable.hotkeys.constructor.keyNameMap[t.which])?i.toLowerCase():void 0)return!!(r in this._keystrokeHandlers&&((o="function"==typeof(n=this._keystrokeHandlers[r])["*"]?n["*"](t):void 0)||this.editable.selection.startNodes().each((a=this,function(n,i){var s,l;if(i.nodeType===Node.ELEMENT_NODE)return s=null!=(l=a._keystrokeHandlers[r])?l[i.tagName.toLowerCase()]:void 0,!0!==(o="function"==typeof s?s(t,e(i)):void 0)&&!1!==o&&void 0})),o))||void 0},r.prototype._initKeystrokeHandlers=function(){var t,n;return this.editable.util.browser.safari&&this.add("enter","*",(n=this,function(t){var r,i;if(t.shiftKey&&!(r=n.editable.selection.blockNodes().last()).is("pre"))return i=e("<br/>"),n.editable.selection.rangeAtEndOf(r)?(n.editable.selection.insertNode(i),n.editable.selection.insertNode(e("<br/>")),n.editable.selection.setRangeBefore(i)):n.editable.selection.insertNode(i),!0})),(this.editable.util.browser.webkit||this.editable.util.browser.msie)&&(t=function(t){return function(n,r){var i;if(t.editable.selection.rangeAtEndOf(r))return i=e("<p/>").append(t.editable.util.phBr).insertAfter(r),t.editable.selection.setRangeAtStartOf(i),!0}}(this),this.add("enter","h1",t),this.add("enter","h2",t),this.add("enter","h3",t),this.add("enter","h4",t),this.add("enter","h5",t),this.add("enter","h6",t)),this.add("backspace","*",function(t){return function(e){var n,r,i;return i=t.editable.selection.rootNodes().first(),(r=i.prev()).is("hr")&&t.editable.selection.rangeAtStartOf(i)?(t.editable.selection.save(),r.remove(),t.editable.selection.restore(),!0):((n=t.editable.selection.blockNodes().last()).is("."+t.opts.classPrefix+"resize-handle")&&i.is("."+t.opts.classPrefix+"table")&&(e.preventDefault(),i.remove(),t.editable.selection.setRangeAtEndOf(r)),r.is("."+t.opts.classPrefix+"table")&&!n.is("table")&&t.editable.util.isEmptyNode(n)&&(e.preventDefault(),n.remove(),t.editable.selection.setRangeAtEndOf(r)),t.editable.util.browser.webkit&&t.editable.selection.rangeAtStartOf(n)?(t.editable.selection.save(),t.editable.formatter.cleanNode(n,!0),t.editable.selection.restore(),null):void 0)}}(this)),this.add("enter","div",function(t){return function(n,r){var i;if(r.is("."+t.opts.classPrefix+"table")&&t.editable.selection.blockNodes().last().is("."+t.opts.classPrefix+"resize-handle"))return n.preventDefault(),i=e("<p/>").append(t.editable.util.phBr).insertAfter(r),t.editable.selection.setRangeAtStartOf(i)}}(this)),this.add("enter","li",function(t){return function(n,r){var i,o,a,s;if((i=r.clone()).find("ul, ol").remove(),t.editable.util.isEmptyNode(i)&&r.is(t.editable.selection.blockNodes().last())){if(o=r.parent(),r.next("li").length>0){if(!t.editable.util.isEmptyNode(r))return;o.parent("li").length>0?(a=e("<li/>").append(t.editable.util.phBr).insertAfter(o.parent("li")),s=e("<"+o[0].tagName+"/>").append(r.nextAll("li")),a.append(s)):(a=e("<p/>").append(t.editable.util.phBr).insertAfter(o),s=e("<"+o[0].tagName+"/>").append(r.nextAll("li")),a.after(s))}else o.parent("li").length>0?(a=e("<li/>").insertAfter(o.parent("li")),r.contents().length>0?a.append(r.contents()):a.append(t.editable.util.phBr)):(a=e("<p/>").append(t.editable.util.phBr).insertAfter(o),r.children("ul, ol").length>0&&a.after(r.children("ul, ol")));return r.prev("li").length?r.remove():r.prev("ul").length||r.prev("ol").length?r.remove():o.remove(),t.editable.selection.setRangeAtStartOf(a),!0}}}(this)),this.add("enter","pre",function(t){return function(n,r){var i,o,a;return n.preventDefault(),n.shiftKey?(i=e("<p/>").append(t.editable.util.phBr).insertAfter(r),t.editable.selection.setRangeAtStartOf(i),!0):(a=t.editable.selection.range(),o=null,a.deleteContents(),o=!t.editable.util.browser.msie&&t.editable.selection.rangeAtEndOf(r)?document.createTextNode("\n\n"):document.createTextNode("\n"),a.insertNode(o),a.setEnd(o,1),a.collapse(!1),t.editable.selection.range(a),!0)}}(this)),this.add("enter","blockquote",function(t){return function(e,n){var r,i;if((r=t.editable.selection.blockNodes().last()).is("p")&&!r.next().length&&t.editable.util.isEmptyNode(r))return n.after(r),i=document.createRange(),t.editable.selection.setRangeAtStartOf(r,i),!0}}(this)),this.add("backspace","li",function(t){return function(n,r){var i,o,a,s,l,u,c,d,f;return o=r.children("ul, ol"),l=r.prev("li"),o.length>0&&l.length>0&&(f="",u=null,r.contents().each(function(t,n){return(1!==n.nodeType||!/UL|OL/.test(n.nodeName))&&(1===n.nodeType&&/BR/.test(n.nodeName)?void 0:(3===n.nodeType&&n.nodeValue?f+=n.nodeValue:1===n.nodeType&&(f+=e(n).text()),u=e(n)))}),c=t.editable.util.browser.firefox&&!u.next("br").length,u&&1===f.length&&c?(i=e(t.editable.util.phBr).insertAfter(u),u.remove(),t.editable.selection.setRangeBefore(i),!0):!(f.length>0)&&(d=document.createRange(),(s=l.children("ul, ol")).length>0?(a=e("<li/>").append(t.editable.util.phBr).appendTo(s),s.append(o.children("li")),r.remove(),t.editable.selection.setRangeAtEndOf(a,d)):(t.editable.selection.setRangeAtEndOf(l,d),l.append(o),r.remove(),t.editable.selection.range(d)),!0))}}(this)),this.add("backspace","pre",function(t){return function(n,r){var i,o,a;if(t.editable.selection.rangeAtStartOf(r))return o=r.html().replace("\n","<br/>")||t.editable.util.phBr,i=e("<p/>").append(o).insertAfter(r),r.remove(),a=document.createRange(),t.editable.selection.setRangeAtStartOf(i,a),!0}}(this)),this.add("backspace","blockquote",function(t){return function(e,n){var r,i;if(t.editable.selection.rangeAtStartOf(n))return r=n.children().first().unwrap(),i=document.createRange(),t.editable.selection.setRangeAtStartOf(r,i),!0}}(this))},n.Keystroke=r}),t("skylark-domx-contents/Formatter",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r=[].indexOf,i=t.Evented.inherit({opts:{allowedTags:[],allowedAttributes:{},allowedStyles:{}},init:function(e,n){this.editable=e,this.opts=t.extend({},this.opts,n),this._allowedTags=t.merge(["br","span","a","img","b","strong","i","strike","u","font","p","ul","ol","li","blockquote","pre","code","h1","h2","h3","h4","hr"],this.opts.allowedTags),this._allowedAttributes=t.extend({img:["src","alt","width","height","data-non-image"],a:["href","target","download"],font:["color"],code:["class"]},this.opts.allowedAttributes),this._allowedStyles=t.extend({span:["color","font-size","background-color","background"],b:["color","font-size","background-color","background"],i:["color","font-size","background-color","background"],strong:["color","font-size","background-color","background"],strike:["color","font-size","background-color","background"],u:["color","font-size","background-color","background"],p:["margin-left","text-align","background-color","background"],h1:["margin-left","text-align"],h2:["margin-left","text-align"],h3:["margin-left","text-align"],h4:["margin-left","text-align"]},this.opts.allowedStyles),this.editable.body.on("click","a",function(t){return!1})},decorate:function(t){return null==t&&(t=this.editable.body),this.editable.trigger("decorate",[t]),t},undecorate:function(t){return null==t&&(t=this.editable.body.clone()),this.editable.trigger("undecorate",[t]),t},autolink:function(t){var n,r,i,o,a,s,l,u,c,d,f,h,p;for(null==t&&(t=this.editable.body),l=[],(i=function(n){return n.contents().each(function(n,r){var o,a;if(!(o=e(r)).is("a")&&!o.closest("a, pre",t).length)return!o.is("iframe")&&o.contents().length?i(o):(a=o.text())&&/https?:\/\/|www\./gi.test(a)?l.push(o):void 0})})(t),c=/(https?:\/\/|www\.)[\w\-\.\?&=\/#%:,@\!\+]+/gi,o=0,s=l.length;o<s;o++){for(r=l[o],h=r.text(),d=[],u=null,a=0;null!==(u=c.exec(h));)f=h.substring(a,u.index),d.push(document.createTextNode(f)),a=c.lastIndex,p=/^(http(s)?:\/\/|\/)/.test(u[0])?u[0]:"http://"+u[0],n=e('<a href="'+p+'" rel="nofollow"></a>').text(u[0]),d.push(n[0]);d.push(document.createTextNode(h.substring(a))),r.replaceWith(e(d))}return t},format:function(t){var n,r,i,o,a,s,l,u,c,d;if(null==t&&(t=this.editable.body),t.is(":empty"))return t.append("<p>"+this.editable.util.phBr+"</p>"),t;for(c=t.contents(),i=0,a=c.length;i<a;i++)l=c[i],this.cleanNode(l,!0);for(d=t.contents(),o=0,s=d.length;o<s;o++)u=d[o],(n=e(u)).is("br")?(void 0!==r&&null!==r&&(r=null),n.remove()):this.editable.util.isBlockNode(u)?n.is("li")?r&&r.is("ul, ol")?r.append(u):(r=e("<ul/>").insertBefore(u)).append(u):r=null:(r&&!r.is("ul, ol")||(r=e("<p/>").insertBefore(u)),r.append(u),this.editable.util.isEmptyNode(r)&&r.append(this.editable.util.phBr));return t},cleanNode:function(n,i){var o,a,s,l,u,c,d,f,h,p,g,y,m,b,v,k,x,_;if((s=e(n)).length>0){if(3!==s[0].nodeType){if(f=s.is("iframe")?null:s.contents(),h=this.editable.util.isDecoratedNode(s),s.is(this._allowedTags.join(","))||h){if(s.is("a")&&(a=s.find("img")).length>0&&(s.replaceWith(a),s=a,f=null),s.is("td")&&(o=s.find(this.editable.util.blockNodes.join(","))).length>0&&(o.each(function(t,n){return e(n).contents().unwrap()}),f=s.contents()),s.is("img")&&s.hasClass("uploading")&&s.remove(),!h){for(c=this._allowedAttributes[s[0].tagName.toLowerCase()],v=t.makeArray(s[0].attributes),p=0,y=v.length;p<y;p++)"style"!==(d=v[p]).name&&(null!=c&&(k=d.name,r.call(c,k)>=0)||s.removeAttr(d.name));this._cleanNodeStyles(s),s.is("span")&&(0===s[0].attributes.length&&s.contents().first().unwrap(),2===s[0].style.length&&"rgb(51, 51, 51)"===s[0].style.color&&"16px"===s[0].style.fontSize&&s.contents().unwrap())}}else 1!==s[0].nodeType||s.is(":empty")?(s.remove(),f=null):s.is("div, article, dl, header, footer, tr")?(s.append("<br/>"),f.first().unwrap()):s.is("table")?(l=e("<p/>"),s.find("tr").each(function(t,n){return l.append(e(n).text()+"<br/>")}),s.replaceWith(l),f=null):s.is("thead, tfoot")?(s.remove(),f=null):s.is("th")?(u=e("<td/>").append(s.contents()),s.replaceWith(u)):f.first().unwrap();if(i&&null!=f&&!s.is("pre"))for(g=0,m=f.length;g<m;g++)b=f[g],this.cleanNode(b,!0);return null}(x=s.text().replace(/(\r\n|\n|\r)/gm,""))?(_=document.createTextNode(x),s.replaceWith(_)):s.remove()}},_cleanNodeStyles:function(e){var n,i,o,a,s,l,u,c,d;if(c=e.attr("style")){if(e.removeAttr("style"),!((n=this._allowedStyles[e[0].tagName.toLowerCase()])&&n.length>0))return e;for(d={},s=c.split(";"),i=0,o=s.length;i<o;i++)u=s[i],u=t.trim(u),2===(a=u.split(":")).length&&("font-size"===a[0]&&a[1].indexOf("px")>0&&parseInt(a[1],10)<12||(l=a[0],r.call(n,l)>=0&&(d[t.trim(a[0])]=t.trim(a[1]))));return Object.keys(d).length>0&&e.css(d),e}},clearHtml:function(t,n){var r,i,o,a;return null==n&&(n=!0),r=e("<div/>").append(t),i=r.contents(),o="",i.each((a=this,function(t,r){var s,l;return 3===r.nodeType?o+=r.nodeValue:1===r.nodeType&&(s=e(r),(l=s.is("iframe")?null:s.contents())&&l.length>0&&(o+=a.clearHtml(l)),n&&t<i.length-1&&s.is("br, p, div, li,tr, pre, address, artticle, aside, dl, figcaption, footer, h1, h2,h3, h4, header"))?o+="\n":void 0})),o},beautify:function(t){var n,r=this;return n=function(t){return!!(t.is("p")&&!t.text()&&t.children(":not(br)").length<1)},t.each(function(t,i){var o;return o=e(i),(o.is(':not(img, br, col, td, hr, [class^="'+r.opts.classPrefix+'"]):empty')||n(o))&&o.remove(),o.find(':not(img, br, col, td, hr, [class^="'+r.opts.classPrefix+'"]):empty').remove()})}});return i.pluginName="Formatter",n.Formatter=i}),t("skylark-domx-contents/Indentation",["skylark-langx/langx","skylark-domx-noder","skylark-domx-query","./contents"],function(t,e,n,r){var i=t.Evented.inherit({});return i.pluginName="Indentation",i.prototype.opts={tabIndent:!0,indentWidth:40},i.prototype.init=function(e,n){var r;this.editable=e,this.opts=t.extend({},this.opts,n),this.editable.keystroke.add("tab","*",(r=this,function(t){var e;if(e=r.editable.toolbar.findButton("code"),r.opts.tabIndent||e&&e.active)return r.indent(t.shiftKey)}))},i.prototype.indent=function(t){var r,i,o,a;return this.editable.selection.startNodes(),this.editable.selection.endNodes(),r=this.editable.selection.blockNodes(),i=[],r=r.each(function(t,n){var r,o,a,s,l;for(r=!0,o=a=0,s=i.length;a<s;o=++a){if(l=i[o],e.contains(n,l)){r=!1;break}if(e.contains(l,n)){i.splice(o,1,n),r=!1;break}}if(r)return i.push(n)}),r=n(i),o=!1,r.each((a=this,function(e,n){var r;if(r=t?a.outdentBlock(n):a.indentBlock(n))return o=r})),o},i.prototype.indentBlock=function(t){var e,r,i,o,a,s,l,u,c,d;if((e=n(t)).length){if(e.is("pre")){if(!(s=this.editable.selection.containerNode()).is(e)&&!s.closest("pre").is(e))return;this.indentText(this.editable.selection.range())}else if(e.is("li")){if((a=e.prev("li")).length<1)return;this.editable.selection.save(),d=e.parent()[0].tagName,(r=a.children("ul, ol")).length>0?r.append(e):n("<"+d+"/>").append(e).appendTo(a),this.editable.selection.restore()}else if(e.is("p, h1, h2, h3, h4"))c=parseInt(e.css("margin-left"))||0,c=(Math.round(c/this.opts.indentWidth)+1)*this.opts.indentWidth,e.css("margin-left",c);else{if(!e.is("table")&&!e.is("."+this.opts.classPrefix+"table"))return!1;if(l=this.editable.selection.containerNode().closest("td, th"),(i=l.next("td, th")).length>0||(u=l.parent("tr"),(o=u.next("tr")).length<1&&u.parent().is("thead")&&(o=u.parent("thead").next("tbody").find("tr:first")),i=o.find("td:first, th:first")),!(l.length>0&&i.length>0))return;this.editable.selection.setRangeAtEndOf(i)}return!0}},i.prototype.indentText=function(t){var e,n;return e=t.toString().replace(/^(?=.+)/gm,"  "),n=document.createTextNode(e||"  "),t.deleteContents(),t.insertNode(n),e?(t.selectNode(n),this.editable.selection.range(t)):this.editable.selection.setRangeAfter(n)},i.prototype.outdentBlock=function(t){var e,r,i,o,a,s,l,u,c,d;if((e=n(t))&&e.length>0){if(e.is("pre")){if(!(o=this.editable.selection.containerNode()).is(e)&&!o.closest("pre").is(e))return;this.outdentText(d)}else if(e.is("li"))r=e.parent(),i=r.parent("li"),this.editable.selection.save(),i.length<1?((d=document.createRange()).setStartBefore(r[0]),d.setEndBefore(e[0]),r.before(d.extractContents()),n("<p/>").insertBefore(r).after(e.children("ul, ol")).append(e.contents()),e.remove()):(e.next("li").length>0&&n("<"+r[0].tagName+"/>").append(e.nextAll("li")).appendTo(e),e.insertAfter(i),r.children("li").length<1&&r.remove()),this.editable.selection.restore();else if(e.is("p, h1, h2, h3, h4"))c=parseInt(e.css("margin-left"))||0,c=Math.max(Math.round(c/this.opts.indentWidth)-1,0)*this.opts.indentWidth,e.css("margin-left",0===c?"":c);else{if(!e.is("table")&&!e.is("."+this.opts.classPrefix+"table"))return!1;if(l=this.editable.selection.containerNode().closest("td, th"),(a=l.prev("td, th")).length>0||(u=l.parent("tr"),(s=u.prev("tr")).length<1&&u.parent().is("tbody")&&(s=u.parent("tbody").prev("thead").find("tr:first")),a=s.find("td:last, th:last")),!(l.length>0&&a.length>0))return;this.editable.selection.setRangeAtEndOf(a)}return!0}},i.prototype.outdentText=function(t){},r.Indentation=i}),t("skylark-domx-contents/Clipboard",["skylark-langx/langx","skylark-domx-query","./contents"],function(t,e,n){var r=t.Evented.inherit({});return r.pluginName="Clipboard",r.prototype.opts={pasteImage:!1,cleanPaste:!1},r.prototype.init=function(e,n){var r;this.editable=e,this.opts=t.extend({},this.opts,n),this.opts.pasteImage&&"string"!=typeof this.opts.pasteImage&&(this.opts.pasteImage="inline"),this.editable.body.on("paste",(r=this,function(t){var e;if(!r.pasting&&!r._pasteBin)return!1!==r.editable.trigger(t)&&(e=r.editable.selection.deleteRangeContents(),r.editable.body.html()?e.collapsed||e.collapse(!0):(r.editable.formatter.format(),r.editable.selection.setRangeAtStartOf(r.editable.body.find("p:first"))),!r._processPasteByClipboardApi(t)&&(r.editable.inputManager.throttledValueChanged.clear(),r.editable.inputManager.throttledSelectionChanged.clear(),r.editable.undoManager.throttledPushState.clear(),r.editable.selection.reset(),r.editable.undoManager.resetCaretPosition(),r.pasting=!0,r._getPasteContent(function(t){return r._processPasteContent(t),r._pasteInBlockEl=null,r._pastePlainText=null,r.pasting=!1})))}))},r.prototype._processPasteByClipboardApi=function(t){var e,n,r,i;if(!this.editable.util.browser.edge&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items&&t.originalEvent.clipboardData.items.length>0&&(n=t.originalEvent.clipboardData.items[0],/^image\//.test(n.type))){if(null==(e=n.getAsFile())||!this.opts.pasteImage)return;if(e.name||(e.name="Clipboard Image.png"),!1===this.editable.triggerHandler("pasting",[e]))return;return(i={})[this.opts.pasteImage]=!0,null!=(r=this.editable.uploader)&&r.upload(e,i),!0}},r.prototype._getPasteContent=function(t){var n,r;return this._pasteBin=e('<div contenteditable="true" />').addClass("paste-bin").attr("tabIndex","-1").appendTo(this.editable.$el),n={html:this.editable.body.html(),caret:this.editable.undoManager.caretPosition()},this._pasteBin.focus(),setTimeout((r=this,function(){var i;return r.editable.body.get(0).innerHTML=n.html,r.editable.undoManager.caretPosition(n.caret),r.editable.body.focus(),r.editable.selection.reset(),r.editable.selection.range(),r._pasteInBlockEl=r.editable.selection.blockNodes().last(),r._pastePlainText=r.opts.cleanPaste||r._pasteInBlockEl.is("pre, table"),r._pastePlainText?i=r.editable.formatter.clearHtml(r._pasteBin.html(),!0):((i=e("<div/>").append(r._pasteBin.contents())).find("style").remove(),i.find("table colgroup").remove(),r._cleanPasteFontSize(i),r.editable.formatter.format(i),r.editable.formatter.decorate(i),r.editable.formatter.beautify(i.children()),i=i.contents()),r._pasteBin.remove(),r._pasteBin=null,t(i)}),0)},r.prototype._processPasteContent=function(t){var n,r,i,o,a,s,l,u,c,d,f,h,p,g,y,m,b,v,k,x,_,w,N,A,S,E;if(!1!==this.editable.trigger("pasting",[t])&&(n=this._pasteInBlockEl,t)){if(this._pastePlainText)if(n.is("table")){for(b=t.split("\n"),d=b.pop(),u=0,f=b.length;u<f;u++)m=b[u],this.editable.selection.insertNode(document.createTextNode(m)),this.editable.selection.insertNode(e("<br/>"));this.editable.selection.insertNode(document.createTextNode(d))}else for(t=e("<div/>").text(t),w=t.contents(),c=0,h=w.length;c<h;c++)k=w[c],this.editable.selection.insertNode(e(k)[0]);else if(n.is(this.editable.body))for(v=0,p=t.length;v<p;v++)k=t[v],this.editable.selection.insertNode(k);else{if(t.length<1)return;if(1===t.length)if(t.is("p")){if(o=t.contents(),n.is("h1, h2, h3, h4, h5")&&o.length&&o.css("font-size",""),1===o.length&&o.is("img")){if(/^data:image/.test((r=o).attr("src"))){if(!this.opts.pasteImage)return;return(i=this.editable.util.dataURLtoBlob(r.attr("src"))).name="Clipboard Image.png",(S={})[this.opts.pasteImage]=!0,void(null!=(N=this.editable.uploader)&&N.upload(i,S))}if(new RegExp("^blob:"+location.origin+"/").test(r.attr("src"))){if(!this.opts.pasteImage)return;return(S={})[this.opts.pasteImage]=!0,a=this.editable.util.dataURLtoBlob,E=this.editable.uploader,(s=new Image).onload=function(){var t;(t=document.createElement("canvas")).width=s.naturalWidth,t.height=s.naturalHeight,t.getContext("2d").drawImage(s,0,0),(i=a(t.toDataURL("image/png"))).name="Clipboard Image.png",null!==E&&E.upload(i,S)},void(s.src=r.attr("src"))}if(r.is('img[src^="webkit-fake-url://"]'))return}for(x=0,g=o.length;x<g;x++)k=o[x],this.editable.selection.insertNode(k)}else if(n.is("p")&&this.editable.util.isEmptyNode(n))n.replaceWith(t),this.editable.selection.setRangeAtEndOf(t);else if(t.is("ul, ol"))if(1===t.find("li").length)for(t=e("<div/>").text(t.text()),A=t.contents(),_=0,y=A.length;_<y;_++)k=A[_],this.editable.selection.insertNode(e(k)[0]);else n.is("li")?(n.parent().after(t),this.editable.selection.setRangeAtEndOf(t)):(n.after(t),this.editable.selection.setRangeAtEndOf(t));else n.after(t),this.editable.selection.setRangeAtEndOf(t);else n.is("li")&&(n=n.parent()),this.editable.selection.rangeAtStartOf(n)?l="before":this.editable.selection.rangeAtEndOf(n)?l="after":(this.editable.selection.breakBlockEl(n),l="before"),n[l](t),this.editable.selection.setRangeAtEndOf(t.last())}return this.editable.inputManager.throttledValueChanged()}},r.prototype._cleanPasteFontSize=function(n){var r,i;if((r=e(n)).length>0)return i=["1.5em","1.25em","0.75em","0.5em"],r.find('[style*="font-size"]').map(function(n,r){var o;if(o=e(r),t.inArray(o.css("font-size"),i)<0)return o.css("font-size","")})},n.Clipboard=r}),t("skylark-domx-contents/Editable",["skylark-langx/langx","skylark-domx-noder","skylark-domx-query","./contents","./Hotkeys","./Util","./InputManager","./Selection","./UndoManager","./Keystroke","./Formatter","./Indentation","./Clipboard"],function(t,n,r,i,o,a,s,l,u,c,d,f,h){var p=t.Evented.inherit({init:function(t,n){this.$el=r(t),this.textarea=r(n.textarea),this.body=r(n.body);var i={classPrefix:n.classPrefix};if(this.util=new a(this,i),this.hotkeys=new o({el:this.body}),this.inputManager=new s(this,i),this.selection=new l(this,i),this.undoManager=new u(this,i),this.keystroke=new c(this,i),this.formatter=new d(this,i),this.indentation=new f(this,i),this.clipboard=new h(this,i),this.util.os.mac?this.$el.addClass(n.classPrefix+"mac"):this.util.os.linux&&this.$el.addClass(n.classPrefix+"linux"),this.util.os.mobile&&this.$el.addClass(n.classPrefix+"mobile"),this.util.browser.mozilla){this.util.reflow();try{return document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(t){e=t}}},setValue:function(t){this.textarea.val(t),this.body.get(0).innerHTML=t,this.formatter.format(),this.formatter.decorate(),this.util.reflow(this.body),this.inputManager.lastCaretPosition=null},getValue:function(){return this.sync()},sync:function(){var e,n,r,i,o,a;for(n=this.body.clone(),this.formatter.undecorate(n),this.formatter.format(n),this.formatter.autolink(n),e=n.children(),o=e.last("p"),i=e.first("p");o.is("p")&&this.util.isEmptyNode(o);)r=o,o=o.prev("p"),r.remove();for(;i.is("p")&&this.util.isEmptyNode(i);)r=i,i=o.next("p"),r.remove();return n.find("img.uploading").remove(),a=t.trim(n.html()),this.textarea.val(a),a},focus:function(){var t,e;if(this.body.is(":visible")&&this.body.is("[contenteditable]"))return this.inputManager.lastCaretPosition?(this.undoManager.caretPosition(this.inputManager.lastCaretPosition),this.inputManager.lastCaretPosition=null):((t=this.body.children().last()).is("p")||(t=r("<p/>").append(this.util.phBr).appendTo(this.body)),e=document.createRange(),this.selection.setRangeAtEndOf(t,e));this.$el.find("textarea:visible").focus()},blur:function(){return this.body.is(":visible")&&this.body.is("[contenteditable]")?this.body.blur():this.body.find("textarea:visible").blur()},isActive:function(t){return!0===document.queryCommandState(t)},status:function(t,e){if("alignment"===t){var n=this.selection.nodes().filter(e);return n.length<1?null:n.first().css("text-align")}},alignment:function(t,e){if("left"!==t&&"center"!==t&&"right"!==t)throw new Error("simditor alignment button: invalid align "+t);var n=this.selection.nodes().filter(e);return n.css({"text-align":"left"===t?"":t}),this.trigger("valuechanged"),this.inputManager.throttledSelectionChanged()},blockquote:function(t){var e,n,i,o;return e=(e=this.selection.rootNodes()).filter(function(t,e){return!r(e).parent().is("blockquote")}),this.selection.save(),i=[],n=function(){if(i.length>0)return r("<blockquote/>").insertBefore(i[0]).append(i),i.length=0},e.each((o=this,function(e,a){var s;if((s=r(a)).parent().is(o.body))return s.is("blockquote")?(n(),s.children().unwrap()):s.is(t)||o.util.isDecoratedNode(s)?n():i.push(a)})),n(),this.selection.restore(),this.trigger("valuechanged")},blockCode:function(t,e){var n,i,o,a,s;return n=this.selection.rootNodes(),o=[],a=[],s=this,i=function(){var e;if(o.length>0)return e=r("<"+t+"/>").insertBefore(o[0]).text(s.formatter.clearHtml(o)),a.push(e[0]),o.length=0},n.each(function(n){return function(s,l){var u,c;return(u=r(l)).is(t)?(i(),c=r("<p/>").append(u.html().replace("\n","<br/>")).replaceAll(u),a.push(c[0])):u.is(e)||n.util.isDecoratedNode(u)||u.is("blockquote")?i():o.push(l)}}(this)),i(),this.selection.setRangeAtEndOf(r(a).last()),this.trigger("valuechanged")},fontColor:function(t,e,n){var r=this.selection.range();if(!e&&r.collapsed&&(textNode=document.createTextNode(n),r.insertNode(textNode),r.selectNodeContents(textNode)),this.selection.range(r),document.execCommand("styleWithCSS",!1,!0),document.execCommand("foreColor",!1,t),document.execCommand("styleWithCSS",!1,!1),!this.util.support.oninput)return this.trigger("valuechanged")},fontScale:function(t,e){var n,i;if(e||(e={"x-large":"1.5em",large:"1.25em",small:".75em","x-small":".5em"}),!(i=this.selection.range()).collapsed)return this.selection.range(i),document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,t),document.execCommand("styleWithCSS",!1,!1),this.selection.reset(),this.selection.range(),n=this.selection.containerNode(),(n[0].nodeType===Node.TEXT_NODE?n.closest('span[style*="font-size"]'):n.find('span[style*="font-size"]')).each(function(t,n){var i,o;return i=r(n),o=n.style.fontSize,/large|x-large|small|x-small/.test(o)?i.css("fontSize",e[o]):"medium"===o?i[0].style.length>1?i.css("fontSize",""):i.replaceWith(i.contents()):void 0}),this.trigger("valuechanged")},hr:function(){var t,e,n;return n=this.selection.rootNodes().first(),n.next().length>0?this.selection.save():e=r("<p/>").append(this.util.phBr),t=r("<hr/>").insertAfter(n),e?(e.insertAfter(t),this.selection.setRangeAtStartOf(e)):this.selection.restore(),this.trigger("valuechanged")},inlineCode:function(t){var e,n,i;return i=this.selection.range(),this.active?(i.selectNodeContents(this.node[0]),this.selection.save(i),this.node.contents().unwrap(),this.selection.restore()):(n=r(i.extractContents()),e=r("<"+this.htmlTag+"/>").append(n.contents()),i.insertNode(e[0]),i.selectNodeContents(e[0]),this.selection.range(i)),this.trigger("valuechanged")},indent:function(){return this.indentation.indent()},link:function(t,e){var n,i,o,a,s,l;if(s=this.selection.range(),t){var u=this.selection.startNodes();l=document.createTextNode(u.text()),u.replaceWith(l),s.selectNode(l)}else n=r(s.extractContents()),a=this.formatter.clearHtml(n.contents(),!1),i=r("<a/>",{href:"",target:"_blank",text:a||e}),this.selection.blockNodes().length>0?s.insertNode(i[0]):(o=r("<p/>").append(i),s.insertNode(o[0])),s.selectNodeContents(i[0]);return this.selection.range(s),this.trigger("valuechanged")},list:function(t,e,i){var o,a,s,l;return a=this.selection.blockNodes(),s="ul"===t?"ol":"ul",this.selection.save(),o=null,a.each((l=this,function(e,a){var u;if(!((u=r(a)).is("blockquote, li")||u.is(i)||l.util.isDecoratedNode(u))&&n.contains(document,a))return u.is(t)?(u.children("li").each(function(t,e){return r(e).children("ul, ol").insertAfter(u),r("<p/>").append(r(e).html()||l.util.phBr).insertBefore(u)}),u.remove()):u.is(s)?r("<"+t+"/>").append(u.contents()).replaceAll(u):o&&u.prev().is(o)?(r("<li/>").append(u.html()||l.util.phBr).appendTo(o),u.remove()):((o=r("<"+t+"><li></li></"+t+">")).find("li").append(u.html()||l.util.phBr),o.replaceAll(u))})),this.selection.restore(),this.trigger("valuechanged")},outdent:function(){return this.indentation.indent(!0)},title:function(t,e){return document.execCommand("formatBlock",!1,t),this.trigger("valuechanged")}});return["bold","insertImage","insertorderedlist","insertunorderedlist","italic","justifyLeft","justifyCenter","justifyFull","justifyRight","strikethrough","underline","undo"].forEach(function(t){p.prototype[t]=function(){return document.execCommand(t,!1,null),this.util.support.oninput||this.trigger("valuechanged"),r(document).trigger("selectionchange")}}),i.Editable=p}),t("skylark-domx-contents/main",["./contents","./Editable"],function(t){return t}),t("skylark-domx-contents",["skylark-domx-contents/main"],function(t){return t})}(r,require),!o){var l=require("skylark-langx-ns");a?module.exports=l:n.skylarkjs=l}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-contents-all.js.map
